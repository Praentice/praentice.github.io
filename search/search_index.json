{"config":{"indexing":"full","lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"Welcome to DF Recipes ! Having troubles with digital forensic ? We've got you covered ! The aim of this website is to give tricks regarding digital forensic and investigation in general. Please keep in mind that this website is currently in WIP state. As a consquence of it, some pages aren't completed. Acknowledgment The informations on this website come from a lot of different authors through articles, room on TryHackMe, github repository... I have decided to compile all of these valuable informations on this very same website. You will find link to the original ressources used to create the pages of my website in the Resources section. A lot of persons helped me in one way or another to create, promote this website and gain skills in DFIR topics and ethical hacking. Please check their work . Without them, this website would not be at its current state. Who am I ? Hello ! My name is Prantice, I'm a student in cybersecurity, I am also a DFIR [^1] enjoyer and the co-founder of the CTF team brain tea'sers . [^1]: D igital F orensic I ncident R esponse My social networks Here's my social networks, don't hesitate to send an email at contact@dfrecipes.fr if you want to give suggestions regarding the website. Website Link Root-me Root-me Blue Team Labs Online Blue Team Labs Online Cyberdefenders Cyberdefenders Github Github Gitlab Gitlab My CTF Team No link for now ! Send me an email !","title":"Welcome to DF Recipes !"},{"location":"#welcome-to-df-recipes","text":"Having troubles with digital forensic ? We've got you covered ! The aim of this website is to give tricks regarding digital forensic and investigation in general. Please keep in mind that this website is currently in WIP state. As a consquence of it, some pages aren't completed.","title":"Welcome to DF Recipes !"},{"location":"#acknowledgment","text":"The informations on this website come from a lot of different authors through articles, room on TryHackMe, github repository... I have decided to compile all of these valuable informations on this very same website. You will find link to the original ressources used to create the pages of my website in the Resources section. A lot of persons helped me in one way or another to create, promote this website and gain skills in DFIR topics and ethical hacking. Please check their work . Without them, this website would not be at its current state.","title":"Acknowledgment"},{"location":"#who-am-i","text":"Hello ! My name is Prantice, I'm a student in cybersecurity, I am also a DFIR [^1] enjoyer and the co-founder of the CTF team brain tea'sers . [^1]: D igital F orensic I ncident R esponse","title":"Who am I ?"},{"location":"#my-social-networks","text":"Here's my social networks, don't hesitate to send an email at contact@dfrecipes.fr if you want to give suggestions regarding the website. Website Link Root-me Root-me Blue Team Labs Online Blue Team Labs Online Cyberdefenders Cyberdefenders Github Github Gitlab Gitlab My CTF Team No link for now ! Send me an email !","title":"My social networks"},{"location":"Acknowledgment/","text":"Acknowledgment I would like to thanks here the persons which contribute in one way or another to the creation of this website. And also to the associations, persons who helped me to gain skills regarding digital forensic and ethical hacking in general. If you want to support them, please check their website listed below. Even though your name isn't mentionned on this page (I am deeply sorry about this), you are not forgotten. Persons Sykursen About him Website Sykursen is a cybersecurity student but also the co-founder and founder of amazing projects in the cybersecurity world. He helped me to setup this website by giving me advices regarding its configuration. Check his website emarie About him Website N\u00b0 1 Website N\u00b0 2 emarie is a cybersecurity student but also the founder of the website azumi.fr. He motivated me to create this website and to purchase a premium subscription on TryHackMe which helped me to gain a lot of skills. His websites is more about pentesting but you should have a look on his website if you are interested by these topics. Check his website His websites is more about pentesting but you should have a look on his website if you are interested by these topics. Check his website tomtombinary About him Website tomtombinary is a member of the CTF team \"Aperi'Kube\". He is specialized in reverse engineering and helped me with another person to gain valuable knowledge and skills in reverse engineering You should check his work if you are interested in reverse-engineering Check his website Associations Hack2G2 About it Website Hack2G2 is a student association based in France which organize talks and workshops regarding cybersecurity topics. This association is doing a great work and helped me to gain a lot of skills. Check their website Website HackTricks About it Website HackTricks is the holy bible of ethical hacking in general. This website helped me a lot of time during CTF events. Check their website","title":"Acknowledgment"},{"location":"Acknowledgment/#acknowledgment","text":"I would like to thanks here the persons which contribute in one way or another to the creation of this website. And also to the associations, persons who helped me to gain skills regarding digital forensic and ethical hacking in general. If you want to support them, please check their website listed below. Even though your name isn't mentionned on this page (I am deeply sorry about this), you are not forgotten.","title":"Acknowledgment"},{"location":"Acknowledgment/#persons","text":"Sykursen About him Website Sykursen is a cybersecurity student but also the co-founder and founder of amazing projects in the cybersecurity world. He helped me to setup this website by giving me advices regarding its configuration. Check his website emarie About him Website N\u00b0 1 Website N\u00b0 2 emarie is a cybersecurity student but also the founder of the website azumi.fr. He motivated me to create this website and to purchase a premium subscription on TryHackMe which helped me to gain a lot of skills. His websites is more about pentesting but you should have a look on his website if you are interested by these topics. Check his website His websites is more about pentesting but you should have a look on his website if you are interested by these topics. Check his website tomtombinary About him Website tomtombinary is a member of the CTF team \"Aperi'Kube\". He is specialized in reverse engineering and helped me with another person to gain valuable knowledge and skills in reverse engineering You should check his work if you are interested in reverse-engineering Check his website","title":"Persons"},{"location":"Acknowledgment/#associations","text":"Hack2G2 About it Website Hack2G2 is a student association based in France which organize talks and workshops regarding cybersecurity topics. This association is doing a great work and helped me to gain a lot of skills. Check their website","title":"Associations"},{"location":"Acknowledgment/#website","text":"HackTricks About it Website HackTricks is the holy bible of ethical hacking in general. This website helped me a lot of time during CTF events. Check their website","title":"Website"},{"location":"Cryptography/Cheatsheet/RSA/","text":"RSA This page aims to give commands regarding certificate, public key, privates key and more.... What is RSA ? RSA is an assymetrical encryption created in 1??? by . It is widely used on the internet to secure connections between clients and server. It is used for example by HTTPS, FTPS, SSH.... RSA Components Certificates Certificates in RSA are used to authenticate a server during the connection. Extract public keys from CER/DER certificates Use one of the following commands to extract public keys from certificates. From CRT From CER From DER From PEM Bash openssl x509 -pubkey -noout -in your_cert.crt > pubkey.pem Bash openssl x509 -inform der -in your_cert.cer -pubkey -noout > your_cert_pub_key.pem Bash openssl x509 -inform der -in your_cert.der -pubkey -noout > your_cert_pub_key.pem Bash openssl x509 -pubkey -noout -in your_cert.pem > your_cert_pub_key.pem Convert a certificate between formats Use one of the following commands to convert a certificate between different formats. CRT -> PEM CER -> PEM DER -> PEM PEM -> DER PEM -> CER PEM -> CRT Bash openssl x509 -in your_cert.crt -out your_cert.pem -outform PEM Bash openssl x509 -in your_cert.cer -out your_cert.pem Bash openssl x509 -in your_cert.der -out your_cert.pem Bash openssl x509 -in your_cert.pem -out your_cert.der -outform DER Bash openssl x509 -inform PEM -in your_cert.pem -outform DER -out your_cert.cer Bash openssl x509 -outform der -in your_cert.pem -out your_cert.crt Public key Public key in the RSA encryption are used to encrypt data before sending them to the server. It can be also used by the client to authenticate the server by checking the certificate signature Extract public key from certificate Bash openssl rsa -pubin -inform PEM -text -noout < certificate_publickey.pem #For PEM format Read public exponent and modulus Bash openssl rsa -pubin -inform PEM -text -noout < your_certificate_public_key.pem Private key Private key are used to decrypt data which are received by the server. It is also used by the server to sign a certificate to ensure its authenticity Breaking RSA Even though this encryption algorithm is impossible to break without a quantum computer. However, if you're facing a case in which this algorithm wasn't properly implemented, you may try to check the following points to see if you can compute the private and public key used for the connection. Check if the key pair has been leaked Sometimes, even though the key pair is impossible to break quickly, you can google the first lines of the public key or certificate (in PEM format) and see if the key pair was leaked somewhere. Look out for the length of the generated key For now, It is recommended to use a length of at least 2048 bits for the generation of a new key pair. Every key pair generated with a length inferior to 2048 bits are considered to be insecure. If you're facing a key pair considered insecure to this standard, you should proceed to the following actions : 1) Retrieve the modulus and exponent of your public key and see if the resulting number (modulus) have known factors. If it is the case, then you should be able to regenerate from there the private key. 2) If the factors of the modulus are unknown but the modulus is a very short number compared to the standard length used, you can try to compute the factors of the modulus by using the following script : Error to do Bruteforce encrypted private key Sometimes, you may encouter an encrypted private key. That means that a passphrase or key file is required to decrypt it before being able to use it. However, you should try the following steps if you want to decrypt the key. 1) Search in the filesystem or the memory dump of the evidence to see if there is no trace of a password which could be linked to the encrypted private key file. 2) Try to use a bruteforce script like this one with a dictionnary such as rockyou.txt (Available in the directory /usr/share/wordlists for Kali Linux and Parrot OS). Look out for bad implementations Even though it is almost impossible to break a good encryption algorithm such as RSA, nothing beats a bad implementation of a cryptographic algorith. That means that you should try to have a look on the client or the server and see if the private key is readable or available somewhere. Resources https://cheapsslsecurity.com/p/convert-a-certificate-to-pem-crt-to-pem-cer-to-pem-der-to-pem/","title":"RSA"},{"location":"Cryptography/Cheatsheet/RSA/#rsa","text":"This page aims to give commands regarding certificate, public key, privates key and more....","title":"RSA"},{"location":"Cryptography/Cheatsheet/RSA/#what-is-rsa","text":"RSA is an assymetrical encryption created in 1??? by . It is widely used on the internet to secure connections between clients and server. It is used for example by HTTPS, FTPS, SSH....","title":"What is RSA ?"},{"location":"Cryptography/Cheatsheet/RSA/#rsa-components","text":"","title":"RSA Components"},{"location":"Cryptography/Cheatsheet/RSA/#certificates","text":"Certificates in RSA are used to authenticate a server during the connection.","title":"Certificates"},{"location":"Cryptography/Cheatsheet/RSA/#extract-public-keys-from-cerder-certificates","text":"Use one of the following commands to extract public keys from certificates. From CRT From CER From DER From PEM Bash openssl x509 -pubkey -noout -in your_cert.crt > pubkey.pem Bash openssl x509 -inform der -in your_cert.cer -pubkey -noout > your_cert_pub_key.pem Bash openssl x509 -inform der -in your_cert.der -pubkey -noout > your_cert_pub_key.pem Bash openssl x509 -pubkey -noout -in your_cert.pem > your_cert_pub_key.pem","title":"Extract public keys from CER/DER certificates"},{"location":"Cryptography/Cheatsheet/RSA/#convert-a-certificate-between-formats","text":"Use one of the following commands to convert a certificate between different formats. CRT -> PEM CER -> PEM DER -> PEM PEM -> DER PEM -> CER PEM -> CRT Bash openssl x509 -in your_cert.crt -out your_cert.pem -outform PEM Bash openssl x509 -in your_cert.cer -out your_cert.pem Bash openssl x509 -in your_cert.der -out your_cert.pem Bash openssl x509 -in your_cert.pem -out your_cert.der -outform DER Bash openssl x509 -inform PEM -in your_cert.pem -outform DER -out your_cert.cer Bash openssl x509 -outform der -in your_cert.pem -out your_cert.crt","title":"Convert a certificate between formats"},{"location":"Cryptography/Cheatsheet/RSA/#public-key","text":"Public key in the RSA encryption are used to encrypt data before sending them to the server. It can be also used by the client to authenticate the server by checking the certificate signature","title":"Public key"},{"location":"Cryptography/Cheatsheet/RSA/#extract-public-key-from-certificate","text":"Bash openssl rsa -pubin -inform PEM -text -noout < certificate_publickey.pem #For PEM format","title":"Extract public key from certificate"},{"location":"Cryptography/Cheatsheet/RSA/#read-public-exponent-and-modulus","text":"Bash openssl rsa -pubin -inform PEM -text -noout < your_certificate_public_key.pem","title":"Read public exponent and modulus"},{"location":"Cryptography/Cheatsheet/RSA/#private-key","text":"Private key are used to decrypt data which are received by the server. It is also used by the server to sign a certificate to ensure its authenticity","title":"Private key"},{"location":"Cryptography/Cheatsheet/RSA/#breaking-rsa","text":"Even though this encryption algorithm is impossible to break without a quantum computer. However, if you're facing a case in which this algorithm wasn't properly implemented, you may try to check the following points to see if you can compute the private and public key used for the connection.","title":"Breaking RSA"},{"location":"Cryptography/Cheatsheet/RSA/#check-if-the-key-pair-has-been-leaked","text":"Sometimes, even though the key pair is impossible to break quickly, you can google the first lines of the public key or certificate (in PEM format) and see if the key pair was leaked somewhere.","title":"Check if the key pair has been leaked"},{"location":"Cryptography/Cheatsheet/RSA/#look-out-for-the-length-of-the-generated-key","text":"For now, It is recommended to use a length of at least 2048 bits for the generation of a new key pair. Every key pair generated with a length inferior to 2048 bits are considered to be insecure. If you're facing a key pair considered insecure to this standard, you should proceed to the following actions : 1) Retrieve the modulus and exponent of your public key and see if the resulting number (modulus) have known factors. If it is the case, then you should be able to regenerate from there the private key. 2) If the factors of the modulus are unknown but the modulus is a very short number compared to the standard length used, you can try to compute the factors of the modulus by using the following script : Error to do","title":"Look out for the length of the generated key"},{"location":"Cryptography/Cheatsheet/RSA/#bruteforce-encrypted-private-key","text":"Sometimes, you may encouter an encrypted private key. That means that a passphrase or key file is required to decrypt it before being able to use it. However, you should try the following steps if you want to decrypt the key. 1) Search in the filesystem or the memory dump of the evidence to see if there is no trace of a password which could be linked to the encrypted private key file. 2) Try to use a bruteforce script like this one with a dictionnary such as rockyou.txt (Available in the directory /usr/share/wordlists for Kali Linux and Parrot OS).","title":"Bruteforce encrypted private key"},{"location":"Cryptography/Cheatsheet/RSA/#look-out-for-bad-implementations","text":"Even though it is almost impossible to break a good encryption algorithm such as RSA, nothing beats a bad implementation of a cryptographic algorith. That means that you should try to have a look on the client or the server and see if the private key is readable or available somewhere.","title":"Look out for bad implementations"},{"location":"Cryptography/Cheatsheet/RSA/#resources","text":"https://cheapsslsecurity.com/p/convert-a-certificate-to-pem-crt-to-pem-cer-to-pem-der-to-pem/","title":"Resources"},{"location":"Digital%20forensic/Cheatsheet/Regex/","text":"Regex The aim of this page is to give tips and tricks regarding regex and how you can write your own regular expressions for forensic purposes. Skip to the \"Ready-to-use regex\" if you're looking for useful regex. Charsets Here's some examples to understand charsets : Basic [abc] : Match every occurences of a, b and c. [a-c] : The same as above [a-cx-z] : Match every occurences of a, b, c, x, y and z. [a-zA-Z] : Match any single lowercase or uppercase letter [^k] : Match any single letter except the letter k which is excluded from the charset Advanced Once you understood complety the Basic part of charset, we can now go through advanced examples of using charset : - [cfh]at : Match the words cat, fat, hat but not bat for example - [Ff]ile[1-9] : Match the words File1, File2, file3, file4, file5, File7, file9 - [Ff]ile[^7] : Same as above except that it doesn't match the word File7 I hope these examples helped you to understand how the charset capabilities can be combined to create regex rules. Wildcards and optional characters a.c : Match for example aac, abc, a0c, a$c and so on. Please note here that the . dot is a wildcard which allows us to match any single characters except the line break. abc? : Match for example ab, abc. When using the ? question mark, any single character which precede it will be marked as optionnal. \\ : This special character can be used to escape any specials characters such as . , ? ... For example, the regex cat\\.xyz will only match the string cat.xyz and not cataxyz, catbxyz and so on. Metacharacters and repetitions Even though charset are useful when it comes to creating regex/ Metacharacters \\d matches a digit, like 9 \\D matches a non-digit, like A or @ \\w matches an alphanumeric character, like a or 3 \\W matches a non-alphanumeric character, like ! or # \\s matches a whitespace character (spaces, tabs, and line breaks) \\S matches everything else (alphanumeric characters and symbols) Repetitions {12} - exactly 12 times. {1,5} - 1 to 5 times. {2,} - 2 or more times. * - 0 or more times. + - 1 or more times. For example, look at these regex : cats{4} : Match the string catssss [Cc]ats* : Match the words Cat, cats, catsss regex go br+ : Match the sentences regex go br, regex go brrrrrr and so on Starts with/ ends with, groups, and either/ or Sometimes it's very useful to specify that we want to search by a certain pattern in the beginning or the end of a line . We do that with these characters: ^ - starts with $ - ends with So for example, if you want to search for a line that starts with abc , you can use ^abc . If you want to search for a line that ends with xyz , you can use xyz$ . Note: The ^ hat symbol is used to exclude a charset when enclosed in [ square brackets ] , but when it is not, it is used to specify the beginning of a word. You can also define groups by enclosing a pattern in ( parentheses ) . This function can be used for many ways that are not in the scope of this tutorial. We will use it to define an either/ or pattern, and also to repeat patterns. To say \"or\" in Regex, we use the | pipe. For an \"either/or\" pattern example, the pattern during the (day|night) will match both of these sentences: during the day and during the night . For a repetition example, the pattern (no){5} will match the sentence nonononono . Ready-to-use regex You can find here a list of regex you can use to search valuable informations within any files How to use them ? GUI text editor When searching for text, select the mode \"Regular expression\" and copy paste the regex of your choice in the field \"Search\" CLI Linux grep command Bash grep \"your_regex\" filename grep -a \"your_regex\" binaryfilename sed command Bash sed -n '/your_regex/p' filename Programming language Cryptographic data These regex allow you to find data regarding any cryptographic data such as public, private key and certificate in differents format Public key This section regroups all regex which allow you to find public key anywhere Public key Classic public key RSA public key Text Only (-{3,}BEGIN PUBLIC KEY)-{3,}\\n([\\s\\S]*?)\\n-{3,}(END PUBLIC KEY-{3,}) Text Only (-{3,}BEGIN RSA PUBLIC KEY)-{3,}\\n([\\s\\S]*?)\\n-{3,}(END RSA PUBLIC KEY-{3,}) Private key Private key Openssh private key Classic private key RSA private key Text Only (-{3,}BEGIN OPENSSH PRIVATE KEY)-{3,}\\n([\\s\\S]*?)\\n-{3,}(END OPENSSH PRIVATE KEY-{3,}) Text Only (-{3,}BEGIN PRIVATE KEY)-{3,}\\n([\\s\\S]*?)\\n-{3,}(END PRIVATE KEY-{3,}) Text Only (-{3,}BEGIN RSA PRIVATE KEY)-{3,}\\n([\\s\\S]*?)\\n-{3,}(END RSA PRIVATE KEY-{3,}) Certificate Certificate Certificate with line break Certificate without line break Text Only (-{1,}BEGIN CERTIFICATE)-{1,}\\n([\\s\\S]*?)\\n-{1,}(END CERTIFICATE-{1,}) Text Only (-{1,}BEGIN CERTIFICATE)-{1,}\\n?([\\s\\S]*?)\\n?-{1,}(END CERTIFICATE-{1,}) Hash method Hash method MD5 SHA1 SHA256 Text Only ^[0-9a-fA-F]{32}$ Text Only /\\b([a-f0-9]{40})\\b/ Text Only ^[0-9a-fA-F]{64}$ Cryptocurrency Bitcoin Cryptocurrency wallet Bitcoin Wallet Text Only /^(bc1|[13])[a-zA-HJ-NP-Z0-9]{25,39}$ Encoding methods Encoding methods Base64 Text Only (?:[A-Za-z0-9+\\/]{4})*(?:[A-Za-z0-9+\\/]{4}|[A-Za-z0-9+\\/]{3}=|[A-Za-z0-9+\\/]{2}={2}) Network information L2 info MAC address Text Only /^((([a-f0-9]{2}:){5})|(([a-f0-9]{2}-){5}))[a-f0-9]{2}$/i L3 info IPv4 address IPv6 address Text Only (\\d{1,3}\\.){3}\\d{1,3} Text Only ^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$ L7 info URL Domain name Text Only ((https?|ftp|file):\\/\\/)?([\\da-z\\.-]+)\\.([a-z\\.]{2,6})([\\/\\w \\.-]*)*\\/? Text Only ([\\da-z\\.-]+)\\.([a-z\\.]{2,6})([\\/\\w \\.-]*)*\\/? General informations Email address Email address Text Only (\\w+)@(\\w+)\\.([a-zA-Z]{1,10}) Phone number Phone number regex Text Only /^(?:(?:\\+|00)33[\\s.-]{0,3}(?:\\(0\\)[\\s.-]{0,3})?|0)[1-9](?:(?:[\\s.-]?\\d{2}){4}|\\d{2}(?:[\\s.-]?\\d{3}){2})$/ Text Only /^(((\\+44\\s?\\d{4}|\\(?0\\d{4}\\)?)\\s?\\d{3}\\s?\\d{3})|((\\+44\\s?\\d{3}|\\(?0\\d{3}\\)?)\\s?\\d{3}\\s?\\d{4})|((\\+44\\s?\\d{2}|\\(?0\\d{2}\\)?)\\s?\\d{4}\\s?\\d{4}))(\\s?\\#(\\d{4}|\\d{3}))?$/ Text Only /(\\(?([\\d \\-\\)\\\u2013\\+\\/\\(]+){6,}\\)?([ .\\-\u2013\\/]?)([\\d]+))/ Text Only /^\\\\(?([0-9]{3})\\\\)?[-.\\\\s]?([0-9]{3})[-.\\\\s]?([0-9]{4})$/ Text Only /^(?:(?:\\d{3}-)?\\d{8}|^(?:\\d{4}-)?\\d{7,8})(?:-\\d+)?$/ Text Only /^(?:(?:\\+|00)86)?1(?:(?:3[\\d])|(?:4[5-79])|(?:5[0-35-9])|(?:6[5-7])|(?:7[0-8])|(?:8[\\d])|(?:9[189]))\\d{8}$/ Text Only /((\\+*)((0[ -]*)*|((91 )*))((\\d{12})+|(\\d{10})+))|\\d{5}([- ]*)\\d{6}/ Text Only /\\(([0-9]{2}|0{1}((x|[0-9]){2}[0-9]{2}))\\)\\s*[0-9]{3,4}[- ]*[0-9]{4}/ Text Only /(^1300\\d{6}$)|(^1800|1900|1902\\d{6}$)|(^0[2|3|7|8]{1}[0-9]{8}$)|(^13\\d{4}$)|(^04\\d{2,3}\\d{6}$)/ Text Only /(^\\+[0-9]{2}|^\\+[0-9]{2}\\(0\\)|^\\(\\+[0-9]{2}\\)\\(0\\)|^00[0-9]{2}|^0)([0-9]{9}$|[0-9\\-\\s]{10}$)/ Text Only /^(([+]\\d{2}[ ][1-9]\\d{0,2}[ ])|([0]\\d{1,3}[-]))((\\d{2}([ ]\\d{2}){2})|(\\d{3}([ ]\\d{3})*([ ]\\d{2})+))$/ Resources Practice regex If you want to learn more about regex, please check this tryhackme room : This is a very nice room , All the information regarding the regular expressions come from this very same room. You can also test your regex here and here also Regex collections https://github.com/dubniczky/Regex-Collection https://github.com/aloisdg/awesome-regex https://regexpattern.com","title":"Regex"},{"location":"Digital%20forensic/Cheatsheet/Regex/#regex","text":"The aim of this page is to give tips and tricks regarding regex and how you can write your own regular expressions for forensic purposes. Skip to the \"Ready-to-use regex\" if you're looking for useful regex.","title":"Regex"},{"location":"Digital%20forensic/Cheatsheet/Regex/#charsets","text":"Here's some examples to understand charsets :","title":"Charsets"},{"location":"Digital%20forensic/Cheatsheet/Regex/#basic","text":"[abc] : Match every occurences of a, b and c. [a-c] : The same as above [a-cx-z] : Match every occurences of a, b, c, x, y and z. [a-zA-Z] : Match any single lowercase or uppercase letter [^k] : Match any single letter except the letter k which is excluded from the charset","title":"Basic"},{"location":"Digital%20forensic/Cheatsheet/Regex/#advanced","text":"Once you understood complety the Basic part of charset, we can now go through advanced examples of using charset : - [cfh]at : Match the words cat, fat, hat but not bat for example - [Ff]ile[1-9] : Match the words File1, File2, file3, file4, file5, File7, file9 - [Ff]ile[^7] : Same as above except that it doesn't match the word File7 I hope these examples helped you to understand how the charset capabilities can be combined to create regex rules.","title":"Advanced"},{"location":"Digital%20forensic/Cheatsheet/Regex/#wildcards-and-optional-characters","text":"a.c : Match for example aac, abc, a0c, a$c and so on. Please note here that the . dot is a wildcard which allows us to match any single characters except the line break. abc? : Match for example ab, abc. When using the ? question mark, any single character which precede it will be marked as optionnal. \\ : This special character can be used to escape any specials characters such as . , ? ... For example, the regex cat\\.xyz will only match the string cat.xyz and not cataxyz, catbxyz and so on.","title":"Wildcards and optional characters"},{"location":"Digital%20forensic/Cheatsheet/Regex/#metacharacters-and-repetitions","text":"Even though charset are useful when it comes to creating regex/","title":"Metacharacters and repetitions"},{"location":"Digital%20forensic/Cheatsheet/Regex/#metacharacters","text":"\\d matches a digit, like 9 \\D matches a non-digit, like A or @ \\w matches an alphanumeric character, like a or 3 \\W matches a non-alphanumeric character, like ! or # \\s matches a whitespace character (spaces, tabs, and line breaks) \\S matches everything else (alphanumeric characters and symbols)","title":"Metacharacters"},{"location":"Digital%20forensic/Cheatsheet/Regex/#repetitions","text":"{12} - exactly 12 times. {1,5} - 1 to 5 times. {2,} - 2 or more times. * - 0 or more times. + - 1 or more times. For example, look at these regex : cats{4} : Match the string catssss [Cc]ats* : Match the words Cat, cats, catsss regex go br+ : Match the sentences regex go br, regex go brrrrrr and so on","title":"Repetitions"},{"location":"Digital%20forensic/Cheatsheet/Regex/#starts-with-ends-with-groups-and-either-or","text":"Sometimes it's very useful to specify that we want to search by a certain pattern in the beginning or the end of a line . We do that with these characters: ^ - starts with $ - ends with So for example, if you want to search for a line that starts with abc , you can use ^abc . If you want to search for a line that ends with xyz , you can use xyz$ . Note: The ^ hat symbol is used to exclude a charset when enclosed in [ square brackets ] , but when it is not, it is used to specify the beginning of a word. You can also define groups by enclosing a pattern in ( parentheses ) . This function can be used for many ways that are not in the scope of this tutorial. We will use it to define an either/ or pattern, and also to repeat patterns. To say \"or\" in Regex, we use the | pipe. For an \"either/or\" pattern example, the pattern during the (day|night) will match both of these sentences: during the day and during the night . For a repetition example, the pattern (no){5} will match the sentence nonononono .","title":"Starts with/ ends with, groups, and either/ or"},{"location":"Digital%20forensic/Cheatsheet/Regex/#ready-to-use-regex","text":"You can find here a list of regex you can use to search valuable informations within any files","title":"Ready-to-use regex"},{"location":"Digital%20forensic/Cheatsheet/Regex/#how-to-use-them","text":"","title":"How to use them ?"},{"location":"Digital%20forensic/Cheatsheet/Regex/#gui-text-editor","text":"When searching for text, select the mode \"Regular expression\" and copy paste the regex of your choice in the field \"Search\"","title":"GUI text editor"},{"location":"Digital%20forensic/Cheatsheet/Regex/#cli","text":"","title":"CLI"},{"location":"Digital%20forensic/Cheatsheet/Regex/#linux","text":"","title":"Linux"},{"location":"Digital%20forensic/Cheatsheet/Regex/#grep-command","text":"Bash grep \"your_regex\" filename grep -a \"your_regex\" binaryfilename","title":"grep command"},{"location":"Digital%20forensic/Cheatsheet/Regex/#sed-command","text":"Bash sed -n '/your_regex/p' filename","title":"sed command"},{"location":"Digital%20forensic/Cheatsheet/Regex/#programming-language","text":"","title":"Programming language"},{"location":"Digital%20forensic/Cheatsheet/Regex/#cryptographic-data","text":"These regex allow you to find data regarding any cryptographic data such as public, private key and certificate in differents format","title":"Cryptographic data"},{"location":"Digital%20forensic/Cheatsheet/Regex/#public-key","text":"This section regroups all regex which allow you to find public key anywhere Public key Classic public key RSA public key Text Only (-{3,}BEGIN PUBLIC KEY)-{3,}\\n([\\s\\S]*?)\\n-{3,}(END PUBLIC KEY-{3,}) Text Only (-{3,}BEGIN RSA PUBLIC KEY)-{3,}\\n([\\s\\S]*?)\\n-{3,}(END RSA PUBLIC KEY-{3,})","title":"Public key"},{"location":"Digital%20forensic/Cheatsheet/Regex/#private-key","text":"Private key Openssh private key Classic private key RSA private key Text Only (-{3,}BEGIN OPENSSH PRIVATE KEY)-{3,}\\n([\\s\\S]*?)\\n-{3,}(END OPENSSH PRIVATE KEY-{3,}) Text Only (-{3,}BEGIN PRIVATE KEY)-{3,}\\n([\\s\\S]*?)\\n-{3,}(END PRIVATE KEY-{3,}) Text Only (-{3,}BEGIN RSA PRIVATE KEY)-{3,}\\n([\\s\\S]*?)\\n-{3,}(END RSA PRIVATE KEY-{3,})","title":"Private key"},{"location":"Digital%20forensic/Cheatsheet/Regex/#certificate","text":"Certificate Certificate with line break Certificate without line break Text Only (-{1,}BEGIN CERTIFICATE)-{1,}\\n([\\s\\S]*?)\\n-{1,}(END CERTIFICATE-{1,}) Text Only (-{1,}BEGIN CERTIFICATE)-{1,}\\n?([\\s\\S]*?)\\n?-{1,}(END CERTIFICATE-{1,})","title":"Certificate"},{"location":"Digital%20forensic/Cheatsheet/Regex/#hash-method","text":"Hash method MD5 SHA1 SHA256 Text Only ^[0-9a-fA-F]{32}$ Text Only /\\b([a-f0-9]{40})\\b/ Text Only ^[0-9a-fA-F]{64}$","title":"Hash method"},{"location":"Digital%20forensic/Cheatsheet/Regex/#cryptocurrency","text":"","title":"Cryptocurrency"},{"location":"Digital%20forensic/Cheatsheet/Regex/#bitcoin","text":"Cryptocurrency wallet Bitcoin Wallet Text Only /^(bc1|[13])[a-zA-HJ-NP-Z0-9]{25,39}$","title":"Bitcoin"},{"location":"Digital%20forensic/Cheatsheet/Regex/#encoding-methods","text":"Encoding methods Base64 Text Only (?:[A-Za-z0-9+\\/]{4})*(?:[A-Za-z0-9+\\/]{4}|[A-Za-z0-9+\\/]{3}=|[A-Za-z0-9+\\/]{2}={2})","title":"Encoding methods"},{"location":"Digital%20forensic/Cheatsheet/Regex/#network-information","text":"L2 info MAC address Text Only /^((([a-f0-9]{2}:){5})|(([a-f0-9]{2}-){5}))[a-f0-9]{2}$/i L3 info IPv4 address IPv6 address Text Only (\\d{1,3}\\.){3}\\d{1,3} Text Only ^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$ L7 info URL Domain name Text Only ((https?|ftp|file):\\/\\/)?([\\da-z\\.-]+)\\.([a-z\\.]{2,6})([\\/\\w \\.-]*)*\\/? Text Only ([\\da-z\\.-]+)\\.([a-z\\.]{2,6})([\\/\\w \\.-]*)*\\/?","title":"Network information"},{"location":"Digital%20forensic/Cheatsheet/Regex/#general-informations","text":"","title":"General informations"},{"location":"Digital%20forensic/Cheatsheet/Regex/#email-address","text":"Email address Text Only (\\w+)@(\\w+)\\.([a-zA-Z]{1,10})","title":"Email address"},{"location":"Digital%20forensic/Cheatsheet/Regex/#phone-number","text":"Phone number regex Text Only /^(?:(?:\\+|00)33[\\s.-]{0,3}(?:\\(0\\)[\\s.-]{0,3})?|0)[1-9](?:(?:[\\s.-]?\\d{2}){4}|\\d{2}(?:[\\s.-]?\\d{3}){2})$/ Text Only /^(((\\+44\\s?\\d{4}|\\(?0\\d{4}\\)?)\\s?\\d{3}\\s?\\d{3})|((\\+44\\s?\\d{3}|\\(?0\\d{3}\\)?)\\s?\\d{3}\\s?\\d{4})|((\\+44\\s?\\d{2}|\\(?0\\d{2}\\)?)\\s?\\d{4}\\s?\\d{4}))(\\s?\\#(\\d{4}|\\d{3}))?$/ Text Only /(\\(?([\\d \\-\\)\\\u2013\\+\\/\\(]+){6,}\\)?([ .\\-\u2013\\/]?)([\\d]+))/ Text Only /^\\\\(?([0-9]{3})\\\\)?[-.\\\\s]?([0-9]{3})[-.\\\\s]?([0-9]{4})$/ Text Only /^(?:(?:\\d{3}-)?\\d{8}|^(?:\\d{4}-)?\\d{7,8})(?:-\\d+)?$/ Text Only /^(?:(?:\\+|00)86)?1(?:(?:3[\\d])|(?:4[5-79])|(?:5[0-35-9])|(?:6[5-7])|(?:7[0-8])|(?:8[\\d])|(?:9[189]))\\d{8}$/ Text Only /((\\+*)((0[ -]*)*|((91 )*))((\\d{12})+|(\\d{10})+))|\\d{5}([- ]*)\\d{6}/ Text Only /\\(([0-9]{2}|0{1}((x|[0-9]){2}[0-9]{2}))\\)\\s*[0-9]{3,4}[- ]*[0-9]{4}/ Text Only /(^1300\\d{6}$)|(^1800|1900|1902\\d{6}$)|(^0[2|3|7|8]{1}[0-9]{8}$)|(^13\\d{4}$)|(^04\\d{2,3}\\d{6}$)/ Text Only /(^\\+[0-9]{2}|^\\+[0-9]{2}\\(0\\)|^\\(\\+[0-9]{2}\\)\\(0\\)|^00[0-9]{2}|^0)([0-9]{9}$|[0-9\\-\\s]{10}$)/ Text Only /^(([+]\\d{2}[ ][1-9]\\d{0,2}[ ])|([0]\\d{1,3}[-]))((\\d{2}([ ]\\d{2}){2})|(\\d{3}([ ]\\d{3})*([ ]\\d{2})+))$/","title":"Phone number"},{"location":"Digital%20forensic/Cheatsheet/Regex/#resources","text":"","title":"Resources"},{"location":"Digital%20forensic/Cheatsheet/Regex/#practice-regex","text":"If you want to learn more about regex, please check this tryhackme room : This is a very nice room , All the information regarding the regular expressions come from this very same room. You can also test your regex here and here also","title":"Practice regex"},{"location":"Digital%20forensic/Cheatsheet/Regex/#regex-collections","text":"https://github.com/dubniczky/Regex-Collection https://github.com/aloisdg/awesome-regex https://regexpattern.com","title":"Regex collections"},{"location":"Digital%20forensic/Cheatsheet/Splunk/","text":"Splunk The aim of this page is to give tips and tricks regarding the usage of Splunk for forensic purposes WARNING ! Before you send any query to Splunk, make sure that you specify all of the timeline or else, you will not be able to apply your query on the entire splunk database. Get the entire database Text Only index=\"your_index\" Syntax Basic operators Splunk use the following operators to allow its users to perform various requests on its database. Advanced operators Network Logs Sort by MAC address Sort by MAC address source Sort by MAC address destination Text Only index=\"tp_ecole\" layers.ip_src=\"172.16.32.24\" Text Only index=\"tp_ecole\" layers.ip_dest=\"172.16.32.24\" Sort by IP address Sort by IP source Sort by IP destination Text Only index=\"tp_ecole\" layers.ip_src=\"172.16.32.24\" Text Only index=\"tp_ecole\" layers.ip_dest=\"172.16.32.24\" Sort by transport protocol Protocol name Sort by UDP transport protocol Sort by TCP transport protocol Text Only index=\"tp_ecole\" layers._ws_col_Protocol=\"UDP\" Text Only index=\"tp_ecole\" layers._ws_col_Protocol=\"TCP\" Protocol flags Text Only index=\"tp_ecole\" \"layers._ws_col_Info\"=\"[SYN, ACK]\" Here's a list of flags you can use to create your own request : TCP Flags Flags Usage [SYN] Only detect connections attempt to a server (First packet of a TCP handshake) [SYN, ACK] Only detect server responses to connections attempt from clients (Second packet of a TCP handshake) Sort by network port Sort by source port Sort by destination port Text Only index=\"tp_ecole\" layers.tcp_srcport=\"22\" Text Only index=\"tp_ecole\" layers.tcp_dstport=\"22\" Sort by L7 protocol HTTP Basic queries Only display HTTP packets Filter by HTTP code Text Only index=\"tp_ecole\" layers._ws_col_Protocol=\"HTTP\" Text Only index=\"tp_ecole\" \"layers.http_response_code\"=200 Resources HTTP Code HTTP Code Description 200 (OK) Request successful. 301 (Moved permanently) Resource is moved to a new URL/path (permanently) 302 (Moved Temporarily) Resource is moved to a new URL/path (temporarily). 400 (Bad Request) Server didn't understand the request. 401 (Unauthorised) URL needs authorisation (login, etc.). 403 (Forbidden) No access to the requested URL. 404 (Not Found) Server can't find the requested URL. 405 (Method Not Allowed) Used method is not suitable or blocked. 408 (Request Timeout) Request look longer than server wait time. 500 (Internal Server Error) Request not completed, unexpected error. 503 (Service Unavailable) Request not completed server or service is down. FTP This section contains query and commands you can use on Splunk to query its database for the search of FTP packets. Basic queries Only display FTP packets Filter by FTP code Filter by FTP command Text Only index=\"tp_ecole\" layers._ws_col_Protocol=\"FTP\" Text Only index=\"tp_ecole\" \"layers.ftp_response_code\"=200 Text Only index=\"tp_ecole\" Advanced queries Resources FTP Code FTP Code Description 211 System status. 212 Directory status. 213 File status (Can be used to know the size of file requested by user) 220 Service ready. 226 Transfer complete. 227 Entering passive mode. 228 Long passive mode. 229 Extended passive mode. 230 User login. 231 User logout. 331 Valid username. 430 Invalid username or password 530 No login, invalid password. FTP Command FTP Command Description USER Send username to use for connection PASS Send password to use for connection CWD Get the current user working directory LIST List the files and directory contained within a path (parsed as an argument of this command) STOR Send file to the server Resources","title":"Splunk"},{"location":"Digital%20forensic/Cheatsheet/Splunk/#splunk","text":"The aim of this page is to give tips and tricks regarding the usage of Splunk for forensic purposes WARNING ! Before you send any query to Splunk, make sure that you specify all of the timeline or else, you will not be able to apply your query on the entire splunk database.","title":"Splunk"},{"location":"Digital%20forensic/Cheatsheet/Splunk/#get-the-entire-database","text":"Text Only index=\"your_index\"","title":"Get the entire database"},{"location":"Digital%20forensic/Cheatsheet/Splunk/#syntax","text":"","title":"Syntax"},{"location":"Digital%20forensic/Cheatsheet/Splunk/#basic-operators","text":"Splunk use the following operators to allow its users to perform various requests on its database.","title":"Basic operators"},{"location":"Digital%20forensic/Cheatsheet/Splunk/#advanced-operators","text":"","title":"Advanced operators"},{"location":"Digital%20forensic/Cheatsheet/Splunk/#network-logs","text":"","title":"Network Logs"},{"location":"Digital%20forensic/Cheatsheet/Splunk/#sort-by-mac-address","text":"Sort by MAC address source Sort by MAC address destination Text Only index=\"tp_ecole\" layers.ip_src=\"172.16.32.24\" Text Only index=\"tp_ecole\" layers.ip_dest=\"172.16.32.24\"","title":"Sort by MAC address"},{"location":"Digital%20forensic/Cheatsheet/Splunk/#sort-by-ip-address","text":"Sort by IP source Sort by IP destination Text Only index=\"tp_ecole\" layers.ip_src=\"172.16.32.24\" Text Only index=\"tp_ecole\" layers.ip_dest=\"172.16.32.24\"","title":"Sort by IP address"},{"location":"Digital%20forensic/Cheatsheet/Splunk/#sort-by-transport-protocol","text":"","title":"Sort by transport protocol"},{"location":"Digital%20forensic/Cheatsheet/Splunk/#protocol-name","text":"Sort by UDP transport protocol Sort by TCP transport protocol Text Only index=\"tp_ecole\" layers._ws_col_Protocol=\"UDP\" Text Only index=\"tp_ecole\" layers._ws_col_Protocol=\"TCP\"","title":"Protocol name"},{"location":"Digital%20forensic/Cheatsheet/Splunk/#protocol-flags","text":"Text Only index=\"tp_ecole\" \"layers._ws_col_Info\"=\"[SYN, ACK]\" Here's a list of flags you can use to create your own request : TCP Flags Flags Usage [SYN] Only detect connections attempt to a server (First packet of a TCP handshake) [SYN, ACK] Only detect server responses to connections attempt from clients (Second packet of a TCP handshake)","title":"Protocol flags"},{"location":"Digital%20forensic/Cheatsheet/Splunk/#sort-by-network-port","text":"Sort by source port Sort by destination port Text Only index=\"tp_ecole\" layers.tcp_srcport=\"22\" Text Only index=\"tp_ecole\" layers.tcp_dstport=\"22\"","title":"Sort by network port"},{"location":"Digital%20forensic/Cheatsheet/Splunk/#sort-by-l7-protocol","text":"","title":"Sort by L7 protocol"},{"location":"Digital%20forensic/Cheatsheet/Splunk/#http","text":"","title":"HTTP"},{"location":"Digital%20forensic/Cheatsheet/Splunk/#basic-queries","text":"Only display HTTP packets Filter by HTTP code Text Only index=\"tp_ecole\" layers._ws_col_Protocol=\"HTTP\" Text Only index=\"tp_ecole\" \"layers.http_response_code\"=200","title":"Basic queries"},{"location":"Digital%20forensic/Cheatsheet/Splunk/#resources","text":"HTTP Code HTTP Code Description 200 (OK) Request successful. 301 (Moved permanently) Resource is moved to a new URL/path (permanently) 302 (Moved Temporarily) Resource is moved to a new URL/path (temporarily). 400 (Bad Request) Server didn't understand the request. 401 (Unauthorised) URL needs authorisation (login, etc.). 403 (Forbidden) No access to the requested URL. 404 (Not Found) Server can't find the requested URL. 405 (Method Not Allowed) Used method is not suitable or blocked. 408 (Request Timeout) Request look longer than server wait time. 500 (Internal Server Error) Request not completed, unexpected error. 503 (Service Unavailable) Request not completed server or service is down.","title":"Resources"},{"location":"Digital%20forensic/Cheatsheet/Splunk/#ftp","text":"This section contains query and commands you can use on Splunk to query its database for the search of FTP packets.","title":"FTP"},{"location":"Digital%20forensic/Cheatsheet/Splunk/#basic-queries_1","text":"Only display FTP packets Filter by FTP code Filter by FTP command Text Only index=\"tp_ecole\" layers._ws_col_Protocol=\"FTP\" Text Only index=\"tp_ecole\" \"layers.ftp_response_code\"=200 Text Only index=\"tp_ecole\"","title":"Basic queries"},{"location":"Digital%20forensic/Cheatsheet/Splunk/#advanced-queries","text":"","title":"Advanced queries"},{"location":"Digital%20forensic/Cheatsheet/Splunk/#resources_1","text":"FTP Code FTP Code Description 211 System status. 212 Directory status. 213 File status (Can be used to know the size of file requested by user) 220 Service ready. 226 Transfer complete. 227 Entering passive mode. 228 Long passive mode. 229 Extended passive mode. 230 User login. 231 User logout. 331 Valid username. 430 Invalid username or password 530 No login, invalid password. FTP Command FTP Command Description USER Send username to use for connection PASS Send password to use for connection CWD Get the current user working directory LIST List the files and directory contained within a path (parsed as an argument of this command) STOR Send file to the server","title":"Resources"},{"location":"Digital%20forensic/Cheatsheet/Splunk/#resources_2","text":"","title":"Resources"},{"location":"Digital%20forensic/Cheatsheet/Wireshark/","text":"Wireshark The aim of this page is to give tips and tricks regarding the analysis of pcap file with Wireshark. Operands Wireshark operators Word operator Symbol operator Description and && Boolean operator \"and\". Needs the two conditions to be true or || Boolean operator \"or\" . Needs one of the two conditions to be true eq == Needs the two conditions to be equal ne != Needs the two conditions to not be equal gt > Needs the conditions at the left to be greater than the condition at the right lt < Needs the conditions at the left to be lesser than the condition at the right Decrypt a secure protocol with the key file/data To decrypt any secure protocol, you will need the key used during the ciphering operation and configure Wireshark to use them by following these steps : Decrypt a secure protocol without the key file/data In case you have captured network traffic but you don't have access to used key to cipher the network stream, you can try the following tricks to attempt the deciphering of the network capture. Recognize the security protocol in usage Recognizing the security protocol used during the exchange will allow you to apply specific techniques which might help you in your quest, you should do the following steps : Retrieve the network protocol used during the exchange. Is this Kerberos ? HTTPS ? RDP ? Once you know the protocol, try to find the packets in which, the client and server might exchange cryptographic data to establish the connection. It could be a \"Client Hello\" packet for example. This will allow you to get the version of the security protocol used for the exchange. Once you know the security protocol version, research online the version to see if it is not affected by any security flaws. It could be a CVE or even a security flaw in its implementation. Don't hesitate to specify with the version number of the security protocol, the network protocol which was using it during the exchange to get more results. Focus on any network stream In case you have a lot of network exchanges, you can follow these steps if you want to review only one network exchange : 1) Right-click on a one of the network packet. Then select the option \"Follow \" Cheatsheet Wireshark filters The aim of this section is to give ready-to-use filters to help you investigate any network capture. Layer 2 protocol ARP Protocol Basic filters Common filter for ARP traffic Only display ARP traffic Get only ARP requests Get only ARP response Text Only arp Text Only arp.opcode==1 Text Only arp.opcode==2 Advanced filters Detect abnormal ARP traffic Detect ARP flooding Detect ARP spoofing / poisoning Text Only ((arp) && (arp.opcode == 1)) && (arp.src.hw_mac == target-mac-address) Text Only (arp.opcode == 1) && (arp.src.hw_mac == target-mac-address) Text Only arp.duplicate-address-detected or arp.duplicate-address-frame MAC address Basic filters Common filter for MAC address Filter MAC address by vendor blabla2 blabla3 Replace 00:00:00 by the vendor mac address Text Only eth.src[0:3]=00:00:00 Lorem Ipsum Lorem Ipsum Advanced filters To do To do Text Only To do Layer 3 protocol IP address Basic filters Common filter for IP address Display only IP packets Filter by TTL Text Only ip Replace 00:00:00 by the vendor mac address Text Only ip.ttl < value Advanced filters To do To do Text Only To do ICMP Protocol Basic filters Common filter for ICMP traffic Only display ICMP traffic Text Only icmp Advanced filters Detect abnormal ICMP traffic Detect ICMP tunnel Text Only icmp and data.len > 64 Layer 4 protocol UDP Basic filters Common filter for UDP traffic Only display UDP traffic Filter by UDP port Text Only udp Text Only udp.port==????? Advanced filters To do To do Text Only To do TCP Basic filters Three way handshake Only display TCP SYN Only display TCP SYN/ACK Text Only tcp.flags.syn==1 && tcp.flags.ack==0 Text Only tcp.flags.syn==1 && tcp.flags.ack==1 Common filter for TCP traffic Filter by TCP port Only display bad checksum TCP packets Text Only tcp.port==????? Text Only tcp.checksum.status==\"bad\" Advanced filters To do To do Text Only To do Layer 5 -> 7 protocol DHCP Basic filters Common filter for DHCP traffic Search DHCP traffic based on specific hostname Search a specific IP address which was requested Text Only dhcp.options.hostname contains \"hostname\" Text Only dhcp.option.type == 50 and dhcp.option.requested_ip_address == ip_address Advanced filters To do To do Text Only To do DNS Basic filters Common filter for DNS traffic Only get DNS query of certain type Search a specific IP address which was requested Text Only dns.qry.type==1 && dns.flags.response==1 Text Only dhcp.option.type == 50 and dhcp.option.requested_ip_address == ip_address Advanced filters Detect abnormal DNS traffic Detect DNS tunnel Detect dnscat tool usage in capture Text Only dns contains \"dnscat\" Detect very long DNS query / response Text Only dns.qry.name > 15 and !mdns Resources DNS query types DNS query type Decimal value Description A 1 System status. FTP Basic filters Common filters for FTP traffic Only display FTP traffic Text Only ftp Search filters Search FTP traffic by code Text Only ftp.response.code==??? === \"Search packets by request command Get request where username is sent Text Only ftp.request.command==USER Get request where password is sent Text Only ftp.request.command==PASS Search packets by filename Text Only ftp.request.arg == \"your.file\" Advanced filters Detect abnormal FTP traffic Detect bruteforce Detect bruteforce with failed login attemps. Text Only (ftp.response.code == 530) and (ftp.response.arg contains \"username\") Detect bruteforce with static password Text Only (ftp.request.command == \"PASS\" ) and (ftp.request.arg == \"password\") Resources Use the following informations to modify the given filters for your own needs. FTP Code FTP Code Description 211 System status. 212 Directory status. 213 File status (Can be used to know the size of file requested by user) 220 Service ready. 226 Transfer complete. 227 Entering passive mode. 228 Long passive mode. 229 Extended passive mode. 230 User login. 231 User logout. 331 Valid username. 430 Invalid username or password 530 No login, invalid password. FTP Command FTP Command Description USER Username PASS Password CWD Current work directory LIST List the file on the server STOR Store file on the server HTTP / HTTPS Basic filters Common filters for HTTP traffic Only display HTTP traffic Text Only http Search filters Filter by requested domain name Filter by request method Text Only http.host=example.com Replace ?????? by the chosen HTTP method name Text Only http.request.method==?????? Get request where password is sent Text Only ftp.request.command==PASS Advanced filters Detect abnormal HTTP traffic Detect MITM attack after ARP flooding / poisoning / spoofing Detect POST request being redirected to a suspect MAC address Text Only http.request.method==POST and http.request.full_uri=\"target-url/login.php\" and eth.addr==target-mac-address Grab valuable informations from HTTP traffic Get credentials Get comments Text Only http.request.method==POST and http.request.full_uri=\"target url/login.php\" Text Only http.request.method==POST and http.request.full_uri=\"target-url/comment.php\" Resources HTTP Code HTTP Code Description 200 (OK) Request successful. 301 (Moved permanently) Resource is moved to a new URL/path (permanently) 302 (Moved Temporarily) Resource is moved to a new URL/path (temporarily). 400 (Bad Request) Server didn't understand the request. 401 (Unauthorised) URL needs authorisation (login, etc.). 403 (Forbidden) No access to the requested URL. 404 (Not Found) Server can't find the requested URL. 405 (Method Not Allowed) Used method is not suitable or blocked. 408 (Request Timeout) Request look longer than server wait time. 500 (Internal Server Error) Request not completed, unexpected error. 503 (Service Unavailable) Request not completed server or service is down. HTTP Parameters User agent: Browser and operating system identification to a web server application. Request URI: Points the requested resource from the server. Full *URI: Complete URI information. Server: Server service name. Host: Hostname of the server Connection: Connection status. Line-based text data: Cleartext data provided by the server. HTML Form URL Encoded: Web form information. SMTP Basic filters Common filter for SMTP traffic Only display SMTP traffic Text Only smtp Search filter Search SMTP traffic based on status code Text Only smtp.response.code=??? Advanced filters To do To do Text Only To do Resources Netbios Basic filters Only display Netbios traffic Only display Netbios traffic Search netbios packets related to an host Text Only nbns In case you have trouble finding the computer you want, try to find a pattern within the netbios packets (NetBIOS Name Service > Queries > Name) which could help you to filter the packets until you find the right one. Text Only nbns.name contains \"hostname\" Advanced filters To do To do Text Only To do Resources https://www.wireshark.org/docs/dfref/f/ftp.html https://www.wireshark.org/docs/wsug_html_chunked/ChWorkBuildDisplayFilterSection.html https://www.wireshark.org/docs/dfref/","title":"Wireshark"},{"location":"Digital%20forensic/Cheatsheet/Wireshark/#wireshark","text":"The aim of this page is to give tips and tricks regarding the analysis of pcap file with Wireshark.","title":"Wireshark"},{"location":"Digital%20forensic/Cheatsheet/Wireshark/#operands","text":"Wireshark operators Word operator Symbol operator Description and && Boolean operator \"and\". Needs the two conditions to be true or || Boolean operator \"or\" . Needs one of the two conditions to be true eq == Needs the two conditions to be equal ne != Needs the two conditions to not be equal gt > Needs the conditions at the left to be greater than the condition at the right lt < Needs the conditions at the left to be lesser than the condition at the right","title":"Operands"},{"location":"Digital%20forensic/Cheatsheet/Wireshark/#decrypt-a-secure-protocol-with-the-key-filedata","text":"To decrypt any secure protocol, you will need the key used during the ciphering operation and configure Wireshark to use them by following these steps :","title":"Decrypt a secure protocol with the key file/data"},{"location":"Digital%20forensic/Cheatsheet/Wireshark/#decrypt-a-secure-protocol-without-the-key-filedata","text":"In case you have captured network traffic but you don't have access to used key to cipher the network stream, you can try the following tricks to attempt the deciphering of the network capture.","title":"Decrypt a secure protocol without the key file/data"},{"location":"Digital%20forensic/Cheatsheet/Wireshark/#recognize-the-security-protocol-in-usage","text":"Recognizing the security protocol used during the exchange will allow you to apply specific techniques which might help you in your quest, you should do the following steps : Retrieve the network protocol used during the exchange. Is this Kerberos ? HTTPS ? RDP ? Once you know the protocol, try to find the packets in which, the client and server might exchange cryptographic data to establish the connection. It could be a \"Client Hello\" packet for example. This will allow you to get the version of the security protocol used for the exchange. Once you know the security protocol version, research online the version to see if it is not affected by any security flaws. It could be a CVE or even a security flaw in its implementation. Don't hesitate to specify with the version number of the security protocol, the network protocol which was using it during the exchange to get more results.","title":"Recognize the security protocol in usage"},{"location":"Digital%20forensic/Cheatsheet/Wireshark/#focus-on-any-network-stream","text":"In case you have a lot of network exchanges, you can follow these steps if you want to review only one network exchange : 1) Right-click on a one of the network packet. Then select the option \"Follow \"","title":"Focus on any network stream"},{"location":"Digital%20forensic/Cheatsheet/Wireshark/#cheatsheet-wireshark-filters","text":"The aim of this section is to give ready-to-use filters to help you investigate any network capture.","title":"Cheatsheet Wireshark filters"},{"location":"Digital%20forensic/Cheatsheet/Wireshark/#layer-2-protocol","text":"","title":"Layer 2 protocol"},{"location":"Digital%20forensic/Cheatsheet/Wireshark/#arp-protocol","text":"","title":"ARP Protocol"},{"location":"Digital%20forensic/Cheatsheet/Wireshark/#basic-filters","text":"Common filter for ARP traffic Only display ARP traffic Get only ARP requests Get only ARP response Text Only arp Text Only arp.opcode==1 Text Only arp.opcode==2","title":"Basic filters"},{"location":"Digital%20forensic/Cheatsheet/Wireshark/#advanced-filters","text":"Detect abnormal ARP traffic Detect ARP flooding Detect ARP spoofing / poisoning Text Only ((arp) && (arp.opcode == 1)) && (arp.src.hw_mac == target-mac-address) Text Only (arp.opcode == 1) && (arp.src.hw_mac == target-mac-address) Text Only arp.duplicate-address-detected or arp.duplicate-address-frame","title":"Advanced filters"},{"location":"Digital%20forensic/Cheatsheet/Wireshark/#mac-address","text":"","title":"MAC address"},{"location":"Digital%20forensic/Cheatsheet/Wireshark/#basic-filters_1","text":"Common filter for MAC address Filter MAC address by vendor blabla2 blabla3 Replace 00:00:00 by the vendor mac address Text Only eth.src[0:3]=00:00:00 Lorem Ipsum Lorem Ipsum","title":"Basic filters"},{"location":"Digital%20forensic/Cheatsheet/Wireshark/#advanced-filters_1","text":"To do To do Text Only To do","title":"Advanced filters"},{"location":"Digital%20forensic/Cheatsheet/Wireshark/#layer-3-protocol","text":"","title":"Layer 3 protocol"},{"location":"Digital%20forensic/Cheatsheet/Wireshark/#ip-address","text":"","title":"IP address"},{"location":"Digital%20forensic/Cheatsheet/Wireshark/#basic-filters_2","text":"Common filter for IP address Display only IP packets Filter by TTL Text Only ip Replace 00:00:00 by the vendor mac address Text Only ip.ttl < value","title":"Basic filters"},{"location":"Digital%20forensic/Cheatsheet/Wireshark/#advanced-filters_2","text":"To do To do Text Only To do","title":"Advanced filters"},{"location":"Digital%20forensic/Cheatsheet/Wireshark/#icmp-protocol","text":"","title":"ICMP Protocol"},{"location":"Digital%20forensic/Cheatsheet/Wireshark/#basic-filters_3","text":"Common filter for ICMP traffic Only display ICMP traffic Text Only icmp","title":"Basic filters"},{"location":"Digital%20forensic/Cheatsheet/Wireshark/#advanced-filters_3","text":"Detect abnormal ICMP traffic Detect ICMP tunnel Text Only icmp and data.len > 64","title":"Advanced filters"},{"location":"Digital%20forensic/Cheatsheet/Wireshark/#layer-4-protocol","text":"","title":"Layer 4 protocol"},{"location":"Digital%20forensic/Cheatsheet/Wireshark/#udp","text":"","title":"UDP"},{"location":"Digital%20forensic/Cheatsheet/Wireshark/#basic-filters_4","text":"Common filter for UDP traffic Only display UDP traffic Filter by UDP port Text Only udp Text Only udp.port==?????","title":"Basic filters"},{"location":"Digital%20forensic/Cheatsheet/Wireshark/#advanced-filters_4","text":"To do To do Text Only To do","title":"Advanced filters"},{"location":"Digital%20forensic/Cheatsheet/Wireshark/#tcp","text":"","title":"TCP"},{"location":"Digital%20forensic/Cheatsheet/Wireshark/#basic-filters_5","text":"Three way handshake Only display TCP SYN Only display TCP SYN/ACK Text Only tcp.flags.syn==1 && tcp.flags.ack==0 Text Only tcp.flags.syn==1 && tcp.flags.ack==1 Common filter for TCP traffic Filter by TCP port Only display bad checksum TCP packets Text Only tcp.port==????? Text Only tcp.checksum.status==\"bad\"","title":"Basic filters"},{"location":"Digital%20forensic/Cheatsheet/Wireshark/#advanced-filters_5","text":"To do To do Text Only To do","title":"Advanced filters"},{"location":"Digital%20forensic/Cheatsheet/Wireshark/#layer-5-7-protocol","text":"","title":"Layer 5 -&gt; 7 protocol"},{"location":"Digital%20forensic/Cheatsheet/Wireshark/#dhcp","text":"","title":"DHCP"},{"location":"Digital%20forensic/Cheatsheet/Wireshark/#basic-filters_6","text":"Common filter for DHCP traffic Search DHCP traffic based on specific hostname Search a specific IP address which was requested Text Only dhcp.options.hostname contains \"hostname\" Text Only dhcp.option.type == 50 and dhcp.option.requested_ip_address == ip_address","title":"Basic filters"},{"location":"Digital%20forensic/Cheatsheet/Wireshark/#advanced-filters_6","text":"To do To do Text Only To do","title":"Advanced filters"},{"location":"Digital%20forensic/Cheatsheet/Wireshark/#dns","text":"","title":"DNS"},{"location":"Digital%20forensic/Cheatsheet/Wireshark/#basic-filters_7","text":"Common filter for DNS traffic Only get DNS query of certain type Search a specific IP address which was requested Text Only dns.qry.type==1 && dns.flags.response==1 Text Only dhcp.option.type == 50 and dhcp.option.requested_ip_address == ip_address","title":"Basic filters"},{"location":"Digital%20forensic/Cheatsheet/Wireshark/#advanced-filters_7","text":"Detect abnormal DNS traffic Detect DNS tunnel Detect dnscat tool usage in capture Text Only dns contains \"dnscat\" Detect very long DNS query / response Text Only dns.qry.name > 15 and !mdns","title":"Advanced filters"},{"location":"Digital%20forensic/Cheatsheet/Wireshark/#resources","text":"DNS query types DNS query type Decimal value Description A 1 System status.","title":"Resources"},{"location":"Digital%20forensic/Cheatsheet/Wireshark/#ftp","text":"","title":"FTP"},{"location":"Digital%20forensic/Cheatsheet/Wireshark/#basic-filters_8","text":"Common filters for FTP traffic Only display FTP traffic Text Only ftp Search filters Search FTP traffic by code Text Only ftp.response.code==??? === \"Search packets by request command Get request where username is sent Text Only ftp.request.command==USER Get request where password is sent Text Only ftp.request.command==PASS Search packets by filename Text Only ftp.request.arg == \"your.file\"","title":"Basic filters"},{"location":"Digital%20forensic/Cheatsheet/Wireshark/#advanced-filters_8","text":"Detect abnormal FTP traffic Detect bruteforce Detect bruteforce with failed login attemps. Text Only (ftp.response.code == 530) and (ftp.response.arg contains \"username\") Detect bruteforce with static password Text Only (ftp.request.command == \"PASS\" ) and (ftp.request.arg == \"password\")","title":"Advanced filters"},{"location":"Digital%20forensic/Cheatsheet/Wireshark/#resources_1","text":"Use the following informations to modify the given filters for your own needs. FTP Code FTP Code Description 211 System status. 212 Directory status. 213 File status (Can be used to know the size of file requested by user) 220 Service ready. 226 Transfer complete. 227 Entering passive mode. 228 Long passive mode. 229 Extended passive mode. 230 User login. 231 User logout. 331 Valid username. 430 Invalid username or password 530 No login, invalid password. FTP Command FTP Command Description USER Username PASS Password CWD Current work directory LIST List the file on the server STOR Store file on the server","title":"Resources"},{"location":"Digital%20forensic/Cheatsheet/Wireshark/#http-https","text":"","title":"HTTP / HTTPS"},{"location":"Digital%20forensic/Cheatsheet/Wireshark/#basic-filters_9","text":"Common filters for HTTP traffic Only display HTTP traffic Text Only http Search filters Filter by requested domain name Filter by request method Text Only http.host=example.com Replace ?????? by the chosen HTTP method name Text Only http.request.method==?????? Get request where password is sent Text Only ftp.request.command==PASS","title":"Basic filters"},{"location":"Digital%20forensic/Cheatsheet/Wireshark/#advanced-filters_9","text":"Detect abnormal HTTP traffic Detect MITM attack after ARP flooding / poisoning / spoofing Detect POST request being redirected to a suspect MAC address Text Only http.request.method==POST and http.request.full_uri=\"target-url/login.php\" and eth.addr==target-mac-address Grab valuable informations from HTTP traffic Get credentials Get comments Text Only http.request.method==POST and http.request.full_uri=\"target url/login.php\" Text Only http.request.method==POST and http.request.full_uri=\"target-url/comment.php\"","title":"Advanced filters"},{"location":"Digital%20forensic/Cheatsheet/Wireshark/#resources_2","text":"HTTP Code HTTP Code Description 200 (OK) Request successful. 301 (Moved permanently) Resource is moved to a new URL/path (permanently) 302 (Moved Temporarily) Resource is moved to a new URL/path (temporarily). 400 (Bad Request) Server didn't understand the request. 401 (Unauthorised) URL needs authorisation (login, etc.). 403 (Forbidden) No access to the requested URL. 404 (Not Found) Server can't find the requested URL. 405 (Method Not Allowed) Used method is not suitable or blocked. 408 (Request Timeout) Request look longer than server wait time. 500 (Internal Server Error) Request not completed, unexpected error. 503 (Service Unavailable) Request not completed server or service is down. HTTP Parameters User agent: Browser and operating system identification to a web server application. Request URI: Points the requested resource from the server. Full *URI: Complete URI information. Server: Server service name. Host: Hostname of the server Connection: Connection status. Line-based text data: Cleartext data provided by the server. HTML Form URL Encoded: Web form information.","title":"Resources"},{"location":"Digital%20forensic/Cheatsheet/Wireshark/#smtp","text":"","title":"SMTP"},{"location":"Digital%20forensic/Cheatsheet/Wireshark/#basic-filters_10","text":"Common filter for SMTP traffic Only display SMTP traffic Text Only smtp Search filter Search SMTP traffic based on status code Text Only smtp.response.code=???","title":"Basic filters"},{"location":"Digital%20forensic/Cheatsheet/Wireshark/#advanced-filters_10","text":"To do To do Text Only To do","title":"Advanced filters"},{"location":"Digital%20forensic/Cheatsheet/Wireshark/#resources_3","text":"","title":"Resources"},{"location":"Digital%20forensic/Cheatsheet/Wireshark/#netbios","text":"","title":"Netbios"},{"location":"Digital%20forensic/Cheatsheet/Wireshark/#basic-filters_11","text":"Only display Netbios traffic Only display Netbios traffic Search netbios packets related to an host Text Only nbns In case you have trouble finding the computer you want, try to find a pattern within the netbios packets (NetBIOS Name Service > Queries > Name) which could help you to filter the packets until you find the right one. Text Only nbns.name contains \"hostname\"","title":"Basic filters"},{"location":"Digital%20forensic/Cheatsheet/Wireshark/#advanced-filters_11","text":"To do To do Text Only To do","title":"Advanced filters"},{"location":"Digital%20forensic/Cheatsheet/Wireshark/#resources_4","text":"https://www.wireshark.org/docs/dfref/f/ftp.html https://www.wireshark.org/docs/wsug_html_chunked/ChWorkBuildDisplayFilterSection.html https://www.wireshark.org/docs/dfref/","title":"Resources"},{"location":"Digital%20forensic/File%20Forensic/File%20Analysis%20Checklist/","text":"The aim of this page is to provide tips and tricks regarding the analysis of unknown files. Checklist for file identification Here's a list of actions you can do to attempt the identification of an unknown file : 1) Check the file extension and search it on the internet or here 2) Launch the command file on the unknown file and check the output 3) Launch the command strings (UTF-8) and strings -el (UTF-16) on the unknown file and check the output 4) Check the first bytes of the unknown file using a hexadecimal editor 5) Check if the unknown file is ciphered or not 6) Is the unknown file a capture of a binary data transfer ? Try to read the file as a dump of something and not as a file.","title":"File Analysis Checklist"},{"location":"Digital%20forensic/File%20Forensic/File%20Analysis%20Checklist/#checklist-for-file-identification","text":"Here's a list of actions you can do to attempt the identification of an unknown file : 1) Check the file extension and search it on the internet or here 2) Launch the command file on the unknown file and check the output 3) Launch the command strings (UTF-8) and strings -el (UTF-16) on the unknown file and check the output 4) Check the first bytes of the unknown file using a hexadecimal editor 5) Check if the unknown file is ciphered or not 6) Is the unknown file a capture of a binary data transfer ? Try to read the file as a dump of something and not as a file.","title":"Checklist for file identification"},{"location":"Digital%20forensic/File%20Forensic/File%20Format/","text":"File Format This page aims to give trick regarding the viewing, extraction and even repairing of specific files. The most interesting files format In the case that you retrieved deleted files but don't have access to their original names, you should in a first time, sort the file by their extension. Once you done that, consult the files which have the following extensions if you want to grab valuables informations Interesting files format Please note here that the extensions mentionned are specific to some OS. Universally speaking, you should try to locate any images, documents... Windows Mac OS X Linux Android iOS Name of the format Explanation doc Microsoft word document db Database file evt Event file edb Microsoft Exchange Server files wab Contact Address format Name of the format Explanation keychain Keychain file which contains all the login used by the user pslist ? Name of the format Explanation ? ? Name of the format Explanation ? ? Name of the format Explanation ? ? File format list This sections aims to give explanation regarding the existings differents files formats and tricks on how you can read them to extract information. ANI .bmp format is a proprietary format developed by Microsoft for Windows. the main use is to create icons. Viewing .ani file These file can be viewed by any image viewer. ASP .asp (active server page) format is a format developped by Microsoft for its service called Microsoft IIS. It generates the content to display in HTML to the browser on the fly. Viewing .asp file These file can be viewed by any text editor AVI .bmp format is a format which is used to contains videos. Viewing .avi file These file can be viewed by any video viewer. BAT .bat format is a proprietary type of file developed by Microsoft for Windows. the main use is to create scripts launchable from a windows terminal. Viewing .bat file The content of these file can be viewed by using any text editor. BMP .bmp format is a proprietary format developed by Microsoft for Windows. the main use is to create images. Viewing .bmp file These file can be viewed by any image viewer. BUP .bup format is proprietary format used by the McAfee antivirus to quarantine dangerous files on the system Viewing . file These file are XOR by the software. to revert the files back to its original state, you need to perform a XOR operation on the file by using the hexadecimal key 0x2A. You can perform this operation by using this (Python script)[] or (Cyberchef)[] C .c format is a format which contains source code written in C. Viewing .c file These file can be viewed by any text editor. CAB .cab (Windows Cabinet Files or Diamond files) format is a compression format developed by Microsoft. Viewing .cab file These files can opened by using the software 7-Zip for example. CHM .chm format is a format developed by Microsoft to contains informations saved in a compressed HTML format. It is generally used for Windows program manual. Viewing .chm file These files can be viewed by using any PDF viewer such as Okular. CLASS .class file are Java Bytecode file or compiled java source code. Viewing .class file These files may be decompiled by using the following softwares : (TO BE COMPLETED) CP_ To be completed Viewing .cp_ file CSV .csv files are comma-separated values files. Viewing .csv file They can be open by using any text editor or excel-like software for better visualisation. DAT .dat files are generic data files which can contains anything... They can be used as configuration, storage files for softwares or even videos... You can find them anywhere. Viewing .dat file There is no universal method to view these type of files since they can contains anything, the best way to analyze them is to find in which software they are used in. Else, you can try to view with a text, hexadecimal editor software... DB .db files are, in general, database files which containes informations in a structured database format. Please keep in mind that files with a .db extension aren't always databases such as Thumbs.db which contains the icons of pictures files for example. Viewing .db file Try softwares such as \"DB browser for SQLite\", \"Microsoft access\" or even a simple text editor to view the content of these files. DBX .dbx files are files which contains outlook emails messages. Viewing .dbx file Even though they aren't the most suited tool, you can use a text editor to view the content of these file\" DLL .dll files are libraries for exe files. Viewing .dll file These files can be decompiled by using tools such as IDA free, Ghidra... DOC, DOCX, ODT .doc and .docx files are files used by the software Microsoft Word whereas .odt files are used by the softwares LibreOffice Text and OpenOffice Text. Viewing these types of file These files can be open by using any Word-like software such as OpenOffice, Libreoffice. Extracting data from theses files without executing them In case you don't want or can't open the file for some reason (Corrupted, malicious file...) you can still extract data from it. Since these files are archive, you can change the current extension to .zip and then proceed to extract its content like you would do with a ZIP file. DXF .dxf (Drawing Exchange Format) files was developed by Autodesk as a type of universal format for storing CAD models. Viewing .dxf file These files can be opened by using (TO BE COMPLETED) EDB .edb files are structured database format file used by Microsoft Exchange Server software to store mailbox data from process and non-SMTP messages. Viewing .edb file These files can be viewed with any text, hexadecimal editor. EVT .evt files are files created by Windows Event Viewer to logs system event for debug purposes. Their structure depends on the .dll files of the program that generated these same logs. Viewing .evt file These files can be viewed by using any text, hexadecimal editor software. You can also use the following tools available on Github to parse and properly view these types of files. EXE .exe are Windows Executable files. Viewing .exe file These files can be decompiled by using tools such as Ghidra, IDA Free... F No information has been found regarding this extension. Viewing .f file You may need to analyze the file before attempting to execute it for security purposes. GIF .gif files are a popular format for animated images. Viewing .gif file These files can be viewed by any image viewer software GZ .gz files are compressed files in gz format. Viewing .gz file These files can be uncompressed by using software like 7-zip... H .h files are header files for the C,C++,C# programming languages. Viewing .h file These files can be viewed with any text editor. HDR .hdr (High Dynamic Range) files are images files. Viewing .hdr file These files can be opened by using softwares like Adobe Photoshop for example. HTML .html (Hypertext markup language file) files are the standard web page format type on the format. Viewing .html file They can be opened by using web browser, text editor... The choice is yours here. ICC .icc files is a color profile format standardized by the International Color Consortium Viewing .icc file They can be opened by using (TO BE COMPLETED) ICO .ico files are image file format for computer icons in Microsoft Windows. Viewing .ico file These files can be viewed by using any image viewer software. IDF .idf files are used interoperate between electronic design automation (EDA) software and solid modeling mechanical computer-aided design (CAD) software. Viewing .idf file These files can be opened by using (TO BE COMPLETED) INF .inf files are configuration files for Windows programs, drivers... Viewing .inf file These files can be opened by using text editor softwares. INI .ini files are message configuration documents for Windows and MS-DOS programs. Viewing .ini file These files can be opened by using text editor softwares. JAVA .java files are source code files written in java (programming language). Viewing .java file These files can be opened by using text editor softwares. JPG .jpg files is format used to represent images. Viewing .jpg file These files can be viewed by using any image viewer softwares. JSP .jsp (Java Server Pages) files are, like .php files, files which returns HTML code once executed by the web server (Except here that instead of PHP, we use java to generate the output of the file). Viewing .jsp file These files can be opened by using any text editor softwares. LNK .lnk files are used to create a shortcut to the original files (Document, pictures...), folder... Viewing .lnk file These files can be viewed by using any text editor softwares. MAX .max format is used to represent data in a three-dimensional scene for video games, movies... Viewing .max file These files may be opened by using Autodesk 3ds Max. MDB .mdb files are database structured format files used by Microsoft Access software up to the 2003 version. This format is replaced by the ACCDB one. Viewing .mdb file These files can be opened by using Microsoft Access 2003 or \"DB Browser for SQLite database\" software MID .mid files are Musical Instrument Digital (MID) interface files, it doesn't include audio but notes, timing, duration and desired loudness for each note. Viewing .mid file These files can be opened by using (TO BE COMPLETED) MOV .mov files are Apple QuickTime Movie files which are basically videos. Viewing .mov file These files can be opened by using VLC software for example. MP3 .mp3 are audio files. Viewing .mp3 file These files can be opened by using VLC, Audacity softwares... MPG .mpg are videos files. Viewing .mpg file These files can be opened by using VLC software MSG .msg format is a proprietary type of file developped by Microsoft for Outlook, they can contains email sent from the local pc. Viewing .msg file You can use the script msg_extract from github to view .msg files PCT .pct files are Macintosh pict image. Viewing .pct file These files can be opened by using any image viewer software. PDF .pdf files are document files format created by Adobe Systems. Viewing .pdf file These files can be opened by using any PDF viewer like acrobat reader for example. PF .pf files are files used by Microsoft Windows for its prefetch trace files. Viewing .pf file These files can be opened by using any text editor PNG .png files are images files. Viewing .png file These files can be opened by using any image viewer, editor software. PPT .ppt files are files used by Microsoft power point software to create presentations. Viewing .ppt file These files can be opened by using any \"Microsoft power point\"-like softwares. PS .ps files are images saved in the Adobe PostScript language. Viewing .ps file These files can be opened by using (TO BE COMPLETED) REG .reg files are registration files used by the Windows registry. Viewing .reg file These files can be opened by using any text editor software RTF .rtf (Rich Text Format) file is text format which can includes extra informations regarding font style, formatting, images... Viewing .rtf file They can be opened by using any \"Word\"-like or simple text editor softwares SVG .svg files are vectors files used to display two-dimensional graphics, charts and illustrations on web site. Viewing .svg file These files can be opened by using any image viewer software SWC .swc files are package of precompiled Flash symbols for .swf files. Viewing .swc file These files can be opened by using (TO BE COMPLETED) SWF .swf files are Shockwave Flash Movie file created by Adobe. Viewing .swf file These files can be decompiled by using (TO BE COMPLETED) TIF .tif files are images created in the GeoTIFF format. Viewing .tif file These files can be opened by using any image viewer software. TTF .ttf files are font files for text. Viewing .pct file These files can be opened by using font files editor softwares TXT .txt files are text files. Viewing .txt file These files can be opened by using any text editor software URL .url are internet shortcut files. Viewing .url file These files can be opened by using any text editor software. WAB .wab files are used by Microsoft Outlook Express software to contains contact data. Viewing .wab file These files can be opened by using text editor softwares. WAV .wav (Waveform Audio file format) files are audio files. Viewing .wav file These files can be opened by using VLC, audacity softwares... WDB .wdb files are database files used by Microsoft Works software. Viewing .wdb file These files can be opened by using text editor softwares. WK4 .wk4 files are files used by the software Lotus1-2-3. Viewing .wk4 file They can be opened by using any text editor. WMA .wma (windows Media Audio) files are proprietary format developed by Microsoft. Viewing .wma file These files can be viewed by using VLC, audacity format... WMF .wmf (Windows Meta File) are proprietary image format developped by Microsoft. Viewing .wmf file These files can be opened by using (TO BE COMPLETED) WMV .wmv files are video files. Viewing .wmv file These files can be opened by using VLC software for example. WPS .wps files are files created by Microsoft Works. They are almost identical to .doc files except for one or two minor differences. Viewing .wps file You can try to convert them into doc files with the right tools. XLS .xls files are used by Microsoft Excel software. Viewing .xls file These files can be opened by using \"Excel\"-like software. XML .xml files are structured text files which can be used for a variety of purposes. Viewing .xml file These files can be viewed by using any text editor software. ZIP .zip files are compressed files. Viewing .zip file They can be opened by using appropriate software such as 7-zip, winrar... Resources Please note that the informations mentionned earlier were obtained by checking the following websites. https://en.wikipedia.org/wiki/List_of_file_formats https://fileinfo.com https://docs.fileformat.com https://www.lifewire.com https://file.org","title":"File Format"},{"location":"Digital%20forensic/File%20Forensic/File%20Format/#file-format","text":"This page aims to give trick regarding the viewing, extraction and even repairing of specific files.","title":"File Format"},{"location":"Digital%20forensic/File%20Forensic/File%20Format/#the-most-interesting-files-format","text":"In the case that you retrieved deleted files but don't have access to their original names, you should in a first time, sort the file by their extension. Once you done that, consult the files which have the following extensions if you want to grab valuables informations Interesting files format Please note here that the extensions mentionned are specific to some OS. Universally speaking, you should try to locate any images, documents... Windows Mac OS X Linux Android iOS Name of the format Explanation doc Microsoft word document db Database file evt Event file edb Microsoft Exchange Server files wab Contact Address format Name of the format Explanation keychain Keychain file which contains all the login used by the user pslist ? Name of the format Explanation ? ? Name of the format Explanation ? ? Name of the format Explanation ? ?","title":"The most interesting files format"},{"location":"Digital%20forensic/File%20Forensic/File%20Format/#file-format-list","text":"This sections aims to give explanation regarding the existings differents files formats and tricks on how you can read them to extract information.","title":"File format list"},{"location":"Digital%20forensic/File%20Forensic/File%20Format/#ani","text":".bmp format is a proprietary format developed by Microsoft for Windows. the main use is to create icons. Viewing .ani file These file can be viewed by any image viewer.","title":"ANI"},{"location":"Digital%20forensic/File%20Forensic/File%20Format/#asp","text":".asp (active server page) format is a format developped by Microsoft for its service called Microsoft IIS. It generates the content to display in HTML to the browser on the fly. Viewing .asp file These file can be viewed by any text editor","title":"ASP"},{"location":"Digital%20forensic/File%20Forensic/File%20Format/#avi","text":".bmp format is a format which is used to contains videos. Viewing .avi file These file can be viewed by any video viewer.","title":"AVI"},{"location":"Digital%20forensic/File%20Forensic/File%20Format/#bat","text":".bat format is a proprietary type of file developed by Microsoft for Windows. the main use is to create scripts launchable from a windows terminal. Viewing .bat file The content of these file can be viewed by using any text editor.","title":"BAT"},{"location":"Digital%20forensic/File%20Forensic/File%20Format/#bmp","text":".bmp format is a proprietary format developed by Microsoft for Windows. the main use is to create images. Viewing .bmp file These file can be viewed by any image viewer.","title":"BMP"},{"location":"Digital%20forensic/File%20Forensic/File%20Format/#bup","text":".bup format is proprietary format used by the McAfee antivirus to quarantine dangerous files on the system Viewing . file These file are XOR by the software. to revert the files back to its original state, you need to perform a XOR operation on the file by using the hexadecimal key 0x2A. You can perform this operation by using this (Python script)[] or (Cyberchef)[]","title":"BUP"},{"location":"Digital%20forensic/File%20Forensic/File%20Format/#c","text":".c format is a format which contains source code written in C. Viewing .c file These file can be viewed by any text editor.","title":"C"},{"location":"Digital%20forensic/File%20Forensic/File%20Format/#cab","text":".cab (Windows Cabinet Files or Diamond files) format is a compression format developed by Microsoft. Viewing .cab file These files can opened by using the software 7-Zip for example.","title":"CAB"},{"location":"Digital%20forensic/File%20Forensic/File%20Format/#chm","text":".chm format is a format developed by Microsoft to contains informations saved in a compressed HTML format. It is generally used for Windows program manual. Viewing .chm file These files can be viewed by using any PDF viewer such as Okular.","title":"CHM"},{"location":"Digital%20forensic/File%20Forensic/File%20Format/#class","text":".class file are Java Bytecode file or compiled java source code. Viewing .class file These files may be decompiled by using the following softwares : (TO BE COMPLETED)","title":"CLASS"},{"location":"Digital%20forensic/File%20Forensic/File%20Format/#cp_","text":"To be completed Viewing .cp_ file","title":"CP_"},{"location":"Digital%20forensic/File%20Forensic/File%20Format/#csv","text":".csv files are comma-separated values files. Viewing .csv file They can be open by using any text editor or excel-like software for better visualisation.","title":"CSV"},{"location":"Digital%20forensic/File%20Forensic/File%20Format/#dat","text":".dat files are generic data files which can contains anything... They can be used as configuration, storage files for softwares or even videos... You can find them anywhere. Viewing .dat file There is no universal method to view these type of files since they can contains anything, the best way to analyze them is to find in which software they are used in. Else, you can try to view with a text, hexadecimal editor software...","title":"DAT"},{"location":"Digital%20forensic/File%20Forensic/File%20Format/#db","text":".db files are, in general, database files which containes informations in a structured database format. Please keep in mind that files with a .db extension aren't always databases such as Thumbs.db which contains the icons of pictures files for example. Viewing .db file Try softwares such as \"DB browser for SQLite\", \"Microsoft access\" or even a simple text editor to view the content of these files.","title":"DB"},{"location":"Digital%20forensic/File%20Forensic/File%20Format/#dbx","text":".dbx files are files which contains outlook emails messages. Viewing .dbx file Even though they aren't the most suited tool, you can use a text editor to view the content of these file\"","title":"DBX"},{"location":"Digital%20forensic/File%20Forensic/File%20Format/#dll","text":".dll files are libraries for exe files. Viewing .dll file These files can be decompiled by using tools such as IDA free, Ghidra...","title":"DLL"},{"location":"Digital%20forensic/File%20Forensic/File%20Format/#doc-docx-odt","text":".doc and .docx files are files used by the software Microsoft Word whereas .odt files are used by the softwares LibreOffice Text and OpenOffice Text. Viewing these types of file These files can be open by using any Word-like software such as OpenOffice, Libreoffice. Extracting data from theses files without executing them In case you don't want or can't open the file for some reason (Corrupted, malicious file...) you can still extract data from it. Since these files are archive, you can change the current extension to .zip and then proceed to extract its content like you would do with a ZIP file.","title":"DOC, DOCX, ODT"},{"location":"Digital%20forensic/File%20Forensic/File%20Format/#dxf","text":".dxf (Drawing Exchange Format) files was developed by Autodesk as a type of universal format for storing CAD models. Viewing .dxf file These files can be opened by using (TO BE COMPLETED)","title":"DXF"},{"location":"Digital%20forensic/File%20Forensic/File%20Format/#edb","text":".edb files are structured database format file used by Microsoft Exchange Server software to store mailbox data from process and non-SMTP messages. Viewing .edb file These files can be viewed with any text, hexadecimal editor.","title":"EDB"},{"location":"Digital%20forensic/File%20Forensic/File%20Format/#evt","text":".evt files are files created by Windows Event Viewer to logs system event for debug purposes. Their structure depends on the .dll files of the program that generated these same logs. Viewing .evt file These files can be viewed by using any text, hexadecimal editor software. You can also use the following tools available on Github to parse and properly view these types of files.","title":"EVT"},{"location":"Digital%20forensic/File%20Forensic/File%20Format/#exe","text":".exe are Windows Executable files. Viewing .exe file These files can be decompiled by using tools such as Ghidra, IDA Free...","title":"EXE"},{"location":"Digital%20forensic/File%20Forensic/File%20Format/#f","text":"No information has been found regarding this extension. Viewing .f file You may need to analyze the file before attempting to execute it for security purposes.","title":"F"},{"location":"Digital%20forensic/File%20Forensic/File%20Format/#gif","text":".gif files are a popular format for animated images. Viewing .gif file These files can be viewed by any image viewer software","title":"GIF"},{"location":"Digital%20forensic/File%20Forensic/File%20Format/#gz","text":".gz files are compressed files in gz format. Viewing .gz file These files can be uncompressed by using software like 7-zip...","title":"GZ"},{"location":"Digital%20forensic/File%20Forensic/File%20Format/#h","text":".h files are header files for the C,C++,C# programming languages. Viewing .h file These files can be viewed with any text editor.","title":"H"},{"location":"Digital%20forensic/File%20Forensic/File%20Format/#hdr","text":".hdr (High Dynamic Range) files are images files. Viewing .hdr file These files can be opened by using softwares like Adobe Photoshop for example.","title":"HDR"},{"location":"Digital%20forensic/File%20Forensic/File%20Format/#html","text":".html (Hypertext markup language file) files are the standard web page format type on the format. Viewing .html file They can be opened by using web browser, text editor... The choice is yours here.","title":"HTML"},{"location":"Digital%20forensic/File%20Forensic/File%20Format/#icc","text":".icc files is a color profile format standardized by the International Color Consortium Viewing .icc file They can be opened by using (TO BE COMPLETED)","title":"ICC"},{"location":"Digital%20forensic/File%20Forensic/File%20Format/#ico","text":".ico files are image file format for computer icons in Microsoft Windows. Viewing .ico file These files can be viewed by using any image viewer software.","title":"ICO"},{"location":"Digital%20forensic/File%20Forensic/File%20Format/#idf","text":".idf files are used interoperate between electronic design automation (EDA) software and solid modeling mechanical computer-aided design (CAD) software. Viewing .idf file These files can be opened by using (TO BE COMPLETED)","title":"IDF"},{"location":"Digital%20forensic/File%20Forensic/File%20Format/#inf","text":".inf files are configuration files for Windows programs, drivers... Viewing .inf file These files can be opened by using text editor softwares.","title":"INF"},{"location":"Digital%20forensic/File%20Forensic/File%20Format/#ini","text":".ini files are message configuration documents for Windows and MS-DOS programs. Viewing .ini file These files can be opened by using text editor softwares.","title":"INI"},{"location":"Digital%20forensic/File%20Forensic/File%20Format/#java","text":".java files are source code files written in java (programming language). Viewing .java file These files can be opened by using text editor softwares.","title":"JAVA"},{"location":"Digital%20forensic/File%20Forensic/File%20Format/#jpg","text":".jpg files is format used to represent images. Viewing .jpg file These files can be viewed by using any image viewer softwares.","title":"JPG"},{"location":"Digital%20forensic/File%20Forensic/File%20Format/#jsp","text":".jsp (Java Server Pages) files are, like .php files, files which returns HTML code once executed by the web server (Except here that instead of PHP, we use java to generate the output of the file). Viewing .jsp file These files can be opened by using any text editor softwares.","title":"JSP"},{"location":"Digital%20forensic/File%20Forensic/File%20Format/#lnk","text":".lnk files are used to create a shortcut to the original files (Document, pictures...), folder... Viewing .lnk file These files can be viewed by using any text editor softwares.","title":"LNK"},{"location":"Digital%20forensic/File%20Forensic/File%20Format/#max","text":".max format is used to represent data in a three-dimensional scene for video games, movies... Viewing .max file These files may be opened by using Autodesk 3ds Max.","title":"MAX"},{"location":"Digital%20forensic/File%20Forensic/File%20Format/#mdb","text":".mdb files are database structured format files used by Microsoft Access software up to the 2003 version. This format is replaced by the ACCDB one. Viewing .mdb file These files can be opened by using Microsoft Access 2003 or \"DB Browser for SQLite database\" software","title":"MDB"},{"location":"Digital%20forensic/File%20Forensic/File%20Format/#mid","text":".mid files are Musical Instrument Digital (MID) interface files, it doesn't include audio but notes, timing, duration and desired loudness for each note. Viewing .mid file These files can be opened by using (TO BE COMPLETED)","title":"MID"},{"location":"Digital%20forensic/File%20Forensic/File%20Format/#mov","text":".mov files are Apple QuickTime Movie files which are basically videos. Viewing .mov file These files can be opened by using VLC software for example.","title":"MOV"},{"location":"Digital%20forensic/File%20Forensic/File%20Format/#mp3","text":".mp3 are audio files. Viewing .mp3 file These files can be opened by using VLC, Audacity softwares...","title":"MP3"},{"location":"Digital%20forensic/File%20Forensic/File%20Format/#mpg","text":".mpg are videos files. Viewing .mpg file These files can be opened by using VLC software","title":"MPG"},{"location":"Digital%20forensic/File%20Forensic/File%20Format/#msg","text":".msg format is a proprietary type of file developped by Microsoft for Outlook, they can contains email sent from the local pc. Viewing .msg file You can use the script msg_extract from github to view .msg files","title":"MSG"},{"location":"Digital%20forensic/File%20Forensic/File%20Format/#pct","text":".pct files are Macintosh pict image. Viewing .pct file These files can be opened by using any image viewer software.","title":"PCT"},{"location":"Digital%20forensic/File%20Forensic/File%20Format/#pdf","text":".pdf files are document files format created by Adobe Systems. Viewing .pdf file These files can be opened by using any PDF viewer like acrobat reader for example.","title":"PDF"},{"location":"Digital%20forensic/File%20Forensic/File%20Format/#pf","text":".pf files are files used by Microsoft Windows for its prefetch trace files. Viewing .pf file These files can be opened by using any text editor","title":"PF"},{"location":"Digital%20forensic/File%20Forensic/File%20Format/#png","text":".png files are images files. Viewing .png file These files can be opened by using any image viewer, editor software.","title":"PNG"},{"location":"Digital%20forensic/File%20Forensic/File%20Format/#ppt","text":".ppt files are files used by Microsoft power point software to create presentations. Viewing .ppt file These files can be opened by using any \"Microsoft power point\"-like softwares.","title":"PPT"},{"location":"Digital%20forensic/File%20Forensic/File%20Format/#ps","text":".ps files are images saved in the Adobe PostScript language. Viewing .ps file These files can be opened by using (TO BE COMPLETED)","title":"PS"},{"location":"Digital%20forensic/File%20Forensic/File%20Format/#reg","text":".reg files are registration files used by the Windows registry. Viewing .reg file These files can be opened by using any text editor software","title":"REG"},{"location":"Digital%20forensic/File%20Forensic/File%20Format/#rtf","text":".rtf (Rich Text Format) file is text format which can includes extra informations regarding font style, formatting, images... Viewing .rtf file They can be opened by using any \"Word\"-like or simple text editor softwares","title":"RTF"},{"location":"Digital%20forensic/File%20Forensic/File%20Format/#svg","text":".svg files are vectors files used to display two-dimensional graphics, charts and illustrations on web site. Viewing .svg file These files can be opened by using any image viewer software","title":"SVG"},{"location":"Digital%20forensic/File%20Forensic/File%20Format/#swc","text":".swc files are package of precompiled Flash symbols for .swf files. Viewing .swc file These files can be opened by using (TO BE COMPLETED)","title":"SWC"},{"location":"Digital%20forensic/File%20Forensic/File%20Format/#swf","text":".swf files are Shockwave Flash Movie file created by Adobe. Viewing .swf file These files can be decompiled by using (TO BE COMPLETED)","title":"SWF"},{"location":"Digital%20forensic/File%20Forensic/File%20Format/#tif","text":".tif files are images created in the GeoTIFF format. Viewing .tif file These files can be opened by using any image viewer software.","title":"TIF"},{"location":"Digital%20forensic/File%20Forensic/File%20Format/#ttf","text":".ttf files are font files for text. Viewing .pct file These files can be opened by using font files editor softwares","title":"TTF"},{"location":"Digital%20forensic/File%20Forensic/File%20Format/#txt","text":".txt files are text files. Viewing .txt file These files can be opened by using any text editor software","title":"TXT"},{"location":"Digital%20forensic/File%20Forensic/File%20Format/#url","text":".url are internet shortcut files. Viewing .url file These files can be opened by using any text editor software.","title":"URL"},{"location":"Digital%20forensic/File%20Forensic/File%20Format/#wab","text":".wab files are used by Microsoft Outlook Express software to contains contact data. Viewing .wab file These files can be opened by using text editor softwares.","title":"WAB"},{"location":"Digital%20forensic/File%20Forensic/File%20Format/#wav","text":".wav (Waveform Audio file format) files are audio files. Viewing .wav file These files can be opened by using VLC, audacity softwares...","title":"WAV"},{"location":"Digital%20forensic/File%20Forensic/File%20Format/#wdb","text":".wdb files are database files used by Microsoft Works software. Viewing .wdb file These files can be opened by using text editor softwares.","title":"WDB"},{"location":"Digital%20forensic/File%20Forensic/File%20Format/#wk4","text":".wk4 files are files used by the software Lotus1-2-3. Viewing .wk4 file They can be opened by using any text editor.","title":"WK4"},{"location":"Digital%20forensic/File%20Forensic/File%20Format/#wma","text":".wma (windows Media Audio) files are proprietary format developed by Microsoft. Viewing .wma file These files can be viewed by using VLC, audacity format...","title":"WMA"},{"location":"Digital%20forensic/File%20Forensic/File%20Format/#wmf","text":".wmf (Windows Meta File) are proprietary image format developped by Microsoft. Viewing .wmf file These files can be opened by using (TO BE COMPLETED)","title":"WMF"},{"location":"Digital%20forensic/File%20Forensic/File%20Format/#wmv","text":".wmv files are video files. Viewing .wmv file These files can be opened by using VLC software for example.","title":"WMV"},{"location":"Digital%20forensic/File%20Forensic/File%20Format/#wps","text":".wps files are files created by Microsoft Works. They are almost identical to .doc files except for one or two minor differences. Viewing .wps file You can try to convert them into doc files with the right tools.","title":"WPS"},{"location":"Digital%20forensic/File%20Forensic/File%20Format/#xls","text":".xls files are used by Microsoft Excel software. Viewing .xls file These files can be opened by using \"Excel\"-like software.","title":"XLS"},{"location":"Digital%20forensic/File%20Forensic/File%20Format/#xml","text":".xml files are structured text files which can be used for a variety of purposes. Viewing .xml file These files can be viewed by using any text editor software.","title":"XML"},{"location":"Digital%20forensic/File%20Forensic/File%20Format/#zip","text":".zip files are compressed files. Viewing .zip file They can be opened by using appropriate software such as 7-zip, winrar...","title":"ZIP"},{"location":"Digital%20forensic/File%20Forensic/File%20Format/#resources","text":"Please note that the informations mentionned earlier were obtained by checking the following websites. https://en.wikipedia.org/wiki/List_of_file_formats https://fileinfo.com https://docs.fileformat.com https://www.lifewire.com https://file.org","title":"Resources"},{"location":"Digital%20forensic/OS%20Forensic/Android/Filesystem%20analysis/Android%20filesystem/","text":"Android filesystem This page aims to give tricks regarding the Android filesystem such as the interesting files for example. WARNING ! Conducting investigation directly on the compromised machine will alter the forensic integrity of the evidences and the compromised machine, You must proceed with extreme caution ! Before going further, make sure that you have made a copy of the compromised machine. Automated analysis If you want to speed up investigation on an android device, you can use the following tools : Name of the tool Description Link ALEAPP Android log parser ALEAPP Autopsy General log parser Autopsy Manual analysis In case you need to search specific informations regarding the device, you can check the following path : General informations Path Notes Storage informations Path Notes Bluetooth informations Path Notes Clipboard informations Path Notes Credits SANS Institute for their amazingly made posters","title":"Android filesystem"},{"location":"Digital%20forensic/OS%20Forensic/Android/Filesystem%20analysis/Android%20filesystem/#android-filesystem","text":"This page aims to give tricks regarding the Android filesystem such as the interesting files for example. WARNING ! Conducting investigation directly on the compromised machine will alter the forensic integrity of the evidences and the compromised machine, You must proceed with extreme caution ! Before going further, make sure that you have made a copy of the compromised machine.","title":"Android filesystem"},{"location":"Digital%20forensic/OS%20Forensic/Android/Filesystem%20analysis/Android%20filesystem/#automated-analysis","text":"If you want to speed up investigation on an android device, you can use the following tools : Name of the tool Description Link ALEAPP Android log parser ALEAPP Autopsy General log parser Autopsy","title":"Automated analysis"},{"location":"Digital%20forensic/OS%20Forensic/Android/Filesystem%20analysis/Android%20filesystem/#manual-analysis","text":"In case you need to search specific informations regarding the device, you can check the following path :","title":"Manual analysis"},{"location":"Digital%20forensic/OS%20Forensic/Android/Filesystem%20analysis/Android%20filesystem/#general-informations","text":"Path Notes","title":"General informations"},{"location":"Digital%20forensic/OS%20Forensic/Android/Filesystem%20analysis/Android%20filesystem/#storage-informations","text":"Path Notes","title":"Storage informations"},{"location":"Digital%20forensic/OS%20Forensic/Android/Filesystem%20analysis/Android%20filesystem/#bluetooth-informations","text":"Path Notes","title":"Bluetooth informations"},{"location":"Digital%20forensic/OS%20Forensic/Android/Filesystem%20analysis/Android%20filesystem/#clipboard-informations","text":"Path Notes","title":"Clipboard informations"},{"location":"Digital%20forensic/OS%20Forensic/Android/Filesystem%20analysis/Android%20filesystem/#credits","text":"SANS Institute for their amazingly made posters","title":"Credits"},{"location":"Digital%20forensic/OS%20Forensic/Android/Memory%20analysis/Android%20memory%20analysis/","text":"Android memory analysis This page aims to give tricks regarding the analysis of Linux/Android memory dump by using Volatility. Get a memory dump Android","title":"Android memory analysis"},{"location":"Digital%20forensic/OS%20Forensic/Android/Memory%20analysis/Android%20memory%20analysis/#android-memory-analysis","text":"This page aims to give tricks regarding the analysis of Linux/Android memory dump by using Volatility.","title":"Android memory analysis"},{"location":"Digital%20forensic/OS%20Forensic/Android/Memory%20analysis/Android%20memory%20analysis/#get-a-memory-dump","text":"","title":"Get a memory dump"},{"location":"Digital%20forensic/OS%20Forensic/Android/Memory%20analysis/Android%20memory%20analysis/#android","text":"","title":"Android"},{"location":"Digital%20forensic/OS%20Forensic/Linux/Filesystem%20analysis/","text":"Filesystem analysis This page aims to give tricks regarding the Linux filesystem such as the interesting files for example. WARNING ! Conducting investigation directly on the compromised machine will alter the forensic integrity of the evidences and the compromised machine, You must proceed with extreme caution ! Before going further, make sure that you have made a copy of the compromised machine. Manual analysis In case you need to search specific informations regarding the computer, you can check the following path. System and OS informations The path mentionned in this section will help you to gather informations on the computer. OS release information OS release information Path N\u00b01 Text Only /etc/os-release User accounts information User accounts information Path N\u00b01 Text Only /etc/passwd User group information User group information Path N\u00b01 Text Only /etc/group Sudoers list Sudoers list Path N\u00b01 Text Only /etc/sudoers Login information Login information Path N\u00b01 Text Only /var/log/wtmp Authentication logs Authentication logs Path N\u00b01 Path N\u00b02 Path N\u00b03 Text Only /var/log/auth.log Text Only /var/log/auth.log.2 Text Only /var/log/auth.log.3 Persistence mechanism The path mentionned in this section will help you to to detect any backdoor that might have been installed on a machine. Cron jobs Cron jobs Path N\u00b01 Text Only /etc/crontab Services Services Path N\u00b01 Text Only /etc/init.d Bash shell startup Bash shell startup Path N\u00b01 Path N\u00b02 Path N\u00b02 Text Only /home/<user>/.bashrc Text Only /etc/bash.bashrc Text Only /etc/profile System configuration The path mentionned in this section will help you to gather informations on the system configuration of the computer Hostname Hostname Path N\u00b01 Text Only /etc/hostname Timezone information Timezone information Path N\u00b01 Text Only /etc/timezone Network interfaces Network interfaces Path N\u00b01 Text Only /etc/network/interfaces Running processes Running processes Path N\u00b01 Text Only ? DNS information DNS information Path N\u00b01 Path N\u00b02 Text Only /etc/hosts Text Only /etc/resolv.conf Evidence of execution The path mentionned in this path will help you to gather informations on the processes executed by the computer Authentication logs Authentication logs Path N\u00b01 Text Only /var/log/auth.log* Bash History Bash history Path N\u00b01 Text Only /home/<user>/.bash_history Text editor history Text editor history Vim - Path N\u00b01 Nano - Path N\u00b01 Text Only /home/<user>/.viminfo Text Only /home/<user>/.bash_history Log files The path mentionned in this section will help you to gather informations on what happened on a given computer Syslogs Syslogs logs Path N\u00b01 Text Only /var/log/syslog Authentication logs Authentication logs Path N\u00b01 Text Only /var/log/auth.log* Third-party logs Resources https://tryhackme.com/room/linuxforensics","title":"Filesystem analysis"},{"location":"Digital%20forensic/OS%20Forensic/Linux/Filesystem%20analysis/#filesystem-analysis","text":"This page aims to give tricks regarding the Linux filesystem such as the interesting files for example. WARNING ! Conducting investigation directly on the compromised machine will alter the forensic integrity of the evidences and the compromised machine, You must proceed with extreme caution ! Before going further, make sure that you have made a copy of the compromised machine.","title":"Filesystem analysis"},{"location":"Digital%20forensic/OS%20Forensic/Linux/Filesystem%20analysis/#manual-analysis","text":"In case you need to search specific informations regarding the computer, you can check the following path.","title":"Manual analysis"},{"location":"Digital%20forensic/OS%20Forensic/Linux/Filesystem%20analysis/#system-and-os-informations","text":"The path mentionned in this section will help you to gather informations on the computer.","title":"System and OS informations"},{"location":"Digital%20forensic/OS%20Forensic/Linux/Filesystem%20analysis/#os-release-information","text":"OS release information Path N\u00b01 Text Only /etc/os-release","title":"OS release information"},{"location":"Digital%20forensic/OS%20Forensic/Linux/Filesystem%20analysis/#user-accounts-information","text":"User accounts information Path N\u00b01 Text Only /etc/passwd","title":"User accounts information"},{"location":"Digital%20forensic/OS%20Forensic/Linux/Filesystem%20analysis/#user-group-information","text":"User group information Path N\u00b01 Text Only /etc/group","title":"User group information"},{"location":"Digital%20forensic/OS%20Forensic/Linux/Filesystem%20analysis/#sudoers-list","text":"Sudoers list Path N\u00b01 Text Only /etc/sudoers","title":"Sudoers list"},{"location":"Digital%20forensic/OS%20Forensic/Linux/Filesystem%20analysis/#login-information","text":"Login information Path N\u00b01 Text Only /var/log/wtmp","title":"Login information"},{"location":"Digital%20forensic/OS%20Forensic/Linux/Filesystem%20analysis/#authentication-logs","text":"Authentication logs Path N\u00b01 Path N\u00b02 Path N\u00b03 Text Only /var/log/auth.log Text Only /var/log/auth.log.2 Text Only /var/log/auth.log.3","title":"Authentication logs"},{"location":"Digital%20forensic/OS%20Forensic/Linux/Filesystem%20analysis/#persistence-mechanism","text":"The path mentionned in this section will help you to to detect any backdoor that might have been installed on a machine.","title":"Persistence mechanism"},{"location":"Digital%20forensic/OS%20Forensic/Linux/Filesystem%20analysis/#cron-jobs","text":"Cron jobs Path N\u00b01 Text Only /etc/crontab","title":"Cron jobs"},{"location":"Digital%20forensic/OS%20Forensic/Linux/Filesystem%20analysis/#services","text":"Services Path N\u00b01 Text Only /etc/init.d","title":"Services"},{"location":"Digital%20forensic/OS%20Forensic/Linux/Filesystem%20analysis/#bash-shell-startup","text":"Bash shell startup Path N\u00b01 Path N\u00b02 Path N\u00b02 Text Only /home/<user>/.bashrc Text Only /etc/bash.bashrc Text Only /etc/profile","title":"Bash shell startup"},{"location":"Digital%20forensic/OS%20Forensic/Linux/Filesystem%20analysis/#system-configuration","text":"The path mentionned in this section will help you to gather informations on the system configuration of the computer","title":"System configuration"},{"location":"Digital%20forensic/OS%20Forensic/Linux/Filesystem%20analysis/#hostname","text":"Hostname Path N\u00b01 Text Only /etc/hostname","title":"Hostname"},{"location":"Digital%20forensic/OS%20Forensic/Linux/Filesystem%20analysis/#timezone-information","text":"Timezone information Path N\u00b01 Text Only /etc/timezone","title":"Timezone information"},{"location":"Digital%20forensic/OS%20Forensic/Linux/Filesystem%20analysis/#network-interfaces","text":"Network interfaces Path N\u00b01 Text Only /etc/network/interfaces","title":"Network interfaces"},{"location":"Digital%20forensic/OS%20Forensic/Linux/Filesystem%20analysis/#running-processes","text":"Running processes Path N\u00b01 Text Only ?","title":"Running processes"},{"location":"Digital%20forensic/OS%20Forensic/Linux/Filesystem%20analysis/#dns-information","text":"DNS information Path N\u00b01 Path N\u00b02 Text Only /etc/hosts Text Only /etc/resolv.conf","title":"DNS information"},{"location":"Digital%20forensic/OS%20Forensic/Linux/Filesystem%20analysis/#evidence-of-execution","text":"The path mentionned in this path will help you to gather informations on the processes executed by the computer","title":"Evidence of execution"},{"location":"Digital%20forensic/OS%20Forensic/Linux/Filesystem%20analysis/#authentication-logs_1","text":"Authentication logs Path N\u00b01 Text Only /var/log/auth.log*","title":"Authentication logs"},{"location":"Digital%20forensic/OS%20Forensic/Linux/Filesystem%20analysis/#bash-history","text":"Bash history Path N\u00b01 Text Only /home/<user>/.bash_history","title":"Bash History"},{"location":"Digital%20forensic/OS%20Forensic/Linux/Filesystem%20analysis/#text-editor-history","text":"Text editor history Vim - Path N\u00b01 Nano - Path N\u00b01 Text Only /home/<user>/.viminfo Text Only /home/<user>/.bash_history","title":"Text editor history"},{"location":"Digital%20forensic/OS%20Forensic/Linux/Filesystem%20analysis/#log-files","text":"The path mentionned in this section will help you to gather informations on what happened on a given computer","title":"Log files"},{"location":"Digital%20forensic/OS%20Forensic/Linux/Filesystem%20analysis/#syslogs","text":"Syslogs logs Path N\u00b01 Text Only /var/log/syslog","title":"Syslogs"},{"location":"Digital%20forensic/OS%20Forensic/Linux/Filesystem%20analysis/#authentication-logs_2","text":"Authentication logs Path N\u00b01 Text Only /var/log/auth.log*","title":"Authentication logs"},{"location":"Digital%20forensic/OS%20Forensic/Linux/Filesystem%20analysis/#third-party-logs","text":"","title":"Third-party logs"},{"location":"Digital%20forensic/OS%20Forensic/Linux/Filesystem%20analysis/#resources","text":"https://tryhackme.com/room/linuxforensics","title":"Resources"},{"location":"Digital%20forensic/OS%20Forensic/Linux/Memory%20analysis/","text":"Linux memory analysis Volatility 2 and 3 This page aims to give tricks regarding the analysis of Linux/Android memory dump by using Volatility. Get a memory dump Get a memory profile This section will help you to get find the right memory profile to use for your investigations. Identify the OS and kernel versions used Before you start doing anything, I suggest you to identify the OS and kernel version used by the computer at the same moment when the memory was dumped. Use one of the following commands to determine the OS and kernel version of your memory dump. Identifying the OS and kernel version Using Linux commands Using Volatility 3 Text Only cat ... Text Only cat ... Based on the results, you have two possibilities : Consult the Resources section and check the link to see if the memory profile you're searching have been already created Create your own memory profile if the memory profile you're searching doesn't exist. If you found the right memory profile, you can directly skip to the section called \"Install the memory profile\" Create a virtual machine with the same specs Install the prerequisites Compile the kernel Generate the memory profile Volatility 2 Volatility 3 Install the memory profile Volatility 2 Volatility 3 Resources Precompiled volatility profile Volatility 2 Volatility 3 Here is a list of precompiled memory profile you can use to find the right memory profile for your investigation. Description Link Volatility2 symbols from Podalirius Link Volatlity2 Compilation of volatility2 profiles by volatility foundation Link Here is a list of precompiled symbols you can use to find the right symbol for your investigation Description Link Volatility3 symbols from Podalirius Link Isf server from techanarchy Link Volatility 3 symboles tables Link","title":"Linux memory analysis"},{"location":"Digital%20forensic/OS%20Forensic/Linux/Memory%20analysis/#linux-memory-analysis","text":"","title":"Linux memory analysis"},{"location":"Digital%20forensic/OS%20Forensic/Linux/Memory%20analysis/#volatility-2-and-3","text":"This page aims to give tricks regarding the analysis of Linux/Android memory dump by using Volatility.","title":"Volatility 2 and 3"},{"location":"Digital%20forensic/OS%20Forensic/Linux/Memory%20analysis/#get-a-memory-dump","text":"","title":"Get a memory dump"},{"location":"Digital%20forensic/OS%20Forensic/Linux/Memory%20analysis/#get-a-memory-profile","text":"This section will help you to get find the right memory profile to use for your investigations.","title":"Get a memory profile"},{"location":"Digital%20forensic/OS%20Forensic/Linux/Memory%20analysis/#identify-the-os-and-kernel-versions-used","text":"Before you start doing anything, I suggest you to identify the OS and kernel version used by the computer at the same moment when the memory was dumped. Use one of the following commands to determine the OS and kernel version of your memory dump. Identifying the OS and kernel version Using Linux commands Using Volatility 3 Text Only cat ... Text Only cat ... Based on the results, you have two possibilities : Consult the Resources section and check the link to see if the memory profile you're searching have been already created Create your own memory profile if the memory profile you're searching doesn't exist. If you found the right memory profile, you can directly skip to the section called \"Install the memory profile\"","title":"Identify the OS and kernel versions used"},{"location":"Digital%20forensic/OS%20Forensic/Linux/Memory%20analysis/#create-a-virtual-machine-with-the-same-specs","text":"","title":"Create a virtual machine with the same specs"},{"location":"Digital%20forensic/OS%20Forensic/Linux/Memory%20analysis/#install-the-prerequisites","text":"","title":"Install the prerequisites"},{"location":"Digital%20forensic/OS%20Forensic/Linux/Memory%20analysis/#compile-the-kernel","text":"","title":"Compile the kernel"},{"location":"Digital%20forensic/OS%20Forensic/Linux/Memory%20analysis/#generate-the-memory-profile","text":"","title":"Generate the memory profile"},{"location":"Digital%20forensic/OS%20Forensic/Linux/Memory%20analysis/#volatility-2","text":"","title":"Volatility 2"},{"location":"Digital%20forensic/OS%20Forensic/Linux/Memory%20analysis/#volatility-3","text":"","title":"Volatility 3"},{"location":"Digital%20forensic/OS%20Forensic/Linux/Memory%20analysis/#install-the-memory-profile","text":"","title":"Install the memory profile"},{"location":"Digital%20forensic/OS%20Forensic/Linux/Memory%20analysis/#volatility-2_1","text":"","title":"Volatility 2"},{"location":"Digital%20forensic/OS%20Forensic/Linux/Memory%20analysis/#volatility-3_1","text":"","title":"Volatility 3"},{"location":"Digital%20forensic/OS%20Forensic/Linux/Memory%20analysis/#resources","text":"Precompiled volatility profile Volatility 2 Volatility 3 Here is a list of precompiled memory profile you can use to find the right memory profile for your investigation. Description Link Volatility2 symbols from Podalirius Link Volatlity2 Compilation of volatility2 profiles by volatility foundation Link Here is a list of precompiled symbols you can use to find the right symbol for your investigation Description Link Volatility3 symbols from Podalirius Link Isf server from techanarchy Link Volatility 3 symboles tables Link","title":"Resources"},{"location":"Digital%20forensic/OS%20Forensic/Mac%20OS%20X/Memory%20analysis/Mac%20OS%20X%20analysis/","text":"Mac OS X memory analysis This page aims to give tricks regarding the analysis of Mac OS X memory by using Volatility. Retrieve filevault encryption key Text Only mac_filevault","title":"Mac OS X memory analysis"},{"location":"Digital%20forensic/OS%20Forensic/Mac%20OS%20X/Memory%20analysis/Mac%20OS%20X%20analysis/#mac-os-x-memory-analysis","text":"This page aims to give tricks regarding the analysis of Mac OS X memory by using Volatility.","title":"Mac OS X memory analysis"},{"location":"Digital%20forensic/OS%20Forensic/Mac%20OS%20X/Memory%20analysis/Mac%20OS%20X%20analysis/#retrieve-filevault-encryption-key","text":"Text Only mac_filevault","title":"Retrieve filevault encryption key"},{"location":"Digital%20forensic/OS%20Forensic/Others/Process%20memory%20dump%20analysis/","text":"Process forensic is page aims to give tricks regarding the analysis of process dump memory for forensic purposes. Get a process memory dump Windows You can easily get the memory dump of a process by using these tools from Sysinternals : procdump and process hacker. Linux Android You can easily get the memory dump of a process by using the frida tool For all process Get notable strings Bash strings mem.raw > destination_file.txt Dump AES keys Text Only findaeskey mem.raw > aes_keys.txt Web navigator process This sections aims to give tricks regarding the analysis of process dump from web navigator. Get visited URL Text Only Get form for authentication Text Only Get TSL/SSL informations Private key Public key Certificate","title":"Process forensic"},{"location":"Digital%20forensic/OS%20Forensic/Others/Process%20memory%20dump%20analysis/#process-forensic","text":"is page aims to give tricks regarding the analysis of process dump memory for forensic purposes.","title":"Process forensic"},{"location":"Digital%20forensic/OS%20Forensic/Others/Process%20memory%20dump%20analysis/#get-a-process-memory-dump","text":"","title":"Get a process memory dump"},{"location":"Digital%20forensic/OS%20Forensic/Others/Process%20memory%20dump%20analysis/#windows","text":"You can easily get the memory dump of a process by using these tools from Sysinternals : procdump and process hacker.","title":"Windows"},{"location":"Digital%20forensic/OS%20Forensic/Others/Process%20memory%20dump%20analysis/#linux","text":"","title":"Linux"},{"location":"Digital%20forensic/OS%20Forensic/Others/Process%20memory%20dump%20analysis/#android","text":"You can easily get the memory dump of a process by using the frida tool","title":"Android"},{"location":"Digital%20forensic/OS%20Forensic/Others/Process%20memory%20dump%20analysis/#for-all-process","text":"","title":"For all process"},{"location":"Digital%20forensic/OS%20Forensic/Others/Process%20memory%20dump%20analysis/#get-notable-strings","text":"Bash strings mem.raw > destination_file.txt","title":"Get notable strings"},{"location":"Digital%20forensic/OS%20Forensic/Others/Process%20memory%20dump%20analysis/#dump-aes-keys","text":"Text Only findaeskey mem.raw > aes_keys.txt","title":"Dump AES keys"},{"location":"Digital%20forensic/OS%20Forensic/Others/Process%20memory%20dump%20analysis/#web-navigator-process","text":"This sections aims to give tricks regarding the analysis of process dump from web navigator.","title":"Web navigator process"},{"location":"Digital%20forensic/OS%20Forensic/Others/Process%20memory%20dump%20analysis/#get-visited-url","text":"Text Only","title":"Get visited URL"},{"location":"Digital%20forensic/OS%20Forensic/Others/Process%20memory%20dump%20analysis/#get-form-for-authentication","text":"Text Only","title":"Get form for authentication"},{"location":"Digital%20forensic/OS%20Forensic/Others/Process%20memory%20dump%20analysis/#get-tslssl-informations","text":"","title":"Get TSL/SSL informations"},{"location":"Digital%20forensic/OS%20Forensic/Others/Process%20memory%20dump%20analysis/#private-key","text":"","title":"Private key"},{"location":"Digital%20forensic/OS%20Forensic/Others/Process%20memory%20dump%20analysis/#public-key","text":"","title":"Public key"},{"location":"Digital%20forensic/OS%20Forensic/Others/Process%20memory%20dump%20analysis/#certificate","text":"","title":"Certificate"},{"location":"Digital%20forensic/OS%20Forensic/Windows/GUI/","text":"Investigation using the GUI compromised machine The aims of this page is to give tips and tricks regarding the investigation of a compromised machine by using its GUI. Windows explorer The windows explorer is the file explorer GUI used by Windows to allow the user to navigate within the computer folder without having to use the terminal. Get Windows Version 1) Open the windows explorer 2) Left-click on \"This PC\" 3) Right-click on the opened windows, then choose \"Properties\" 4) You have now access to the windows version used on the machine Event Viewer","title":"Investigation using the GUI compromised machine"},{"location":"Digital%20forensic/OS%20Forensic/Windows/GUI/#investigation-using-the-gui-compromised-machine","text":"The aims of this page is to give tips and tricks regarding the investigation of a compromised machine by using its GUI.","title":"Investigation using the GUI compromised machine"},{"location":"Digital%20forensic/OS%20Forensic/Windows/GUI/#windows-explorer","text":"The windows explorer is the file explorer GUI used by Windows to allow the user to navigate within the computer folder without having to use the terminal.","title":"Windows explorer"},{"location":"Digital%20forensic/OS%20Forensic/Windows/GUI/#get-windows-version","text":"1) Open the windows explorer 2) Left-click on \"This PC\" 3) Right-click on the opened windows, then choose \"Properties\" 4) You have now access to the windows version used on the machine","title":"Get Windows Version"},{"location":"Digital%20forensic/OS%20Forensic/Windows/GUI/#event-viewer","text":"","title":"Event Viewer"},{"location":"Digital%20forensic/OS%20Forensic/Windows/Powershell%20and%20Terminal/","text":"Powershell and Terminal The aim of this page is to give tips and tricks regarding windows investigation by using the powershell or terminal console of the compromised machine. User accounts Get last login information for all local accounts PowerShell Get-LocalUser | Select Name , Lastlogon or PowerShell $( [ADSI] \"WinNT://$env:COMPUTERNAME\" ). Children | where { $_ . SchemaClassName -eq 'user' } | Select Name , Lastlogin or PowerShell net user USERNAME Processes and scheduled tasks Get list of scheduled tasks PowerShell Get-ScheduledTask or Text Only schtasks /query schtasks /query /v /fo LIST schtasks /query /v /fo LIST /TN \"name of the task\" Get list of C2 servers PowerShell Get-Content C :\\ Windows \\ System32 \\ drivers \\ etc \\ hosts #Useful to check for DNS Poisoning","title":"Powershell and Terminal"},{"location":"Digital%20forensic/OS%20Forensic/Windows/Powershell%20and%20Terminal/#powershell-and-terminal","text":"The aim of this page is to give tips and tricks regarding windows investigation by using the powershell or terminal console of the compromised machine.","title":"Powershell and Terminal"},{"location":"Digital%20forensic/OS%20Forensic/Windows/Powershell%20and%20Terminal/#user-accounts","text":"","title":"User accounts"},{"location":"Digital%20forensic/OS%20Forensic/Windows/Powershell%20and%20Terminal/#get-last-login-information-for-all-local-accounts","text":"PowerShell Get-LocalUser | Select Name , Lastlogon or PowerShell $( [ADSI] \"WinNT://$env:COMPUTERNAME\" ). Children | where { $_ . SchemaClassName -eq 'user' } | Select Name , Lastlogin or PowerShell net user USERNAME","title":"Get last login information for all local accounts"},{"location":"Digital%20forensic/OS%20Forensic/Windows/Powershell%20and%20Terminal/#processes-and-scheduled-tasks","text":"","title":"Processes and scheduled tasks"},{"location":"Digital%20forensic/OS%20Forensic/Windows/Powershell%20and%20Terminal/#get-list-of-scheduled-tasks","text":"PowerShell Get-ScheduledTask or Text Only schtasks /query schtasks /query /v /fo LIST schtasks /query /v /fo LIST /TN \"name of the task\"","title":"Get list of scheduled tasks"},{"location":"Digital%20forensic/OS%20Forensic/Windows/Powershell%20and%20Terminal/#get-list-of-c2-servers","text":"PowerShell Get-Content C :\\ Windows \\ System32 \\ drivers \\ etc \\ hosts #Useful to check for DNS Poisoning","title":"Get list of C2 servers"},{"location":"Digital%20forensic/OS%20Forensic/Windows/Filesystem%20analysis/Filesystem/","text":"","title":"Filesystem"},{"location":"Digital%20forensic/OS%20Forensic/Windows/Filesystem%20analysis/Registry/","text":"The windows registry The aim of this page is to conduct investigation within the windows registry. What is the windows registry ? The Windows Registry is a collection of databases that contains the system's configuration data. This configuration data can be about the hardware, the software, or the user's information. It also includes data about the recently used files, programs used, or devices connected to the system. As you can understand, this data is beneficial from a forensics standpoint. Throughout this room, we will learn ways to read this data to identify the required information about the system. You can view the registry using regedit.exe, a built-in Windows utility to view and edit the registry. We'll explore other tools to learn about the registry in the upcoming tasks. The Windows registry consists of Keys and Values. When you open the regedit.exe utility to view the registry, the folders you see are Registry Keys. Registry Values are the data stored in these Registry Keys. A Registry Hive is a group of Keys, subkeys, and values stored in a single file on the disk. The registry on any Windows system contains the following five root keys: Five root keys HKEY_CURRENT_USER HKEY_USERS HKEY_LOCAL_MACHINE HKEY_CLASSES_ROOT HKEY_CURRENT_CONFIG Contains the root of the configuration information for the user who is currently logged on. The user's folders, screen colors, and Control Panel settings are stored here. This information is associated with the user's profile. This key is sometimes abbreviated as HKCU. Contains all the actively loaded user profiles on the computer. HKEY_CURRENT_USER is a subkey of HKEY_USERS. HKEY_USERS is sometimes abbreviated as HKU. Contains configuration information particular to the computer (for any user). This key is sometimes abbreviated as HKLM. This is a subkey of HKEY_LOCAL_MACHINE\\Software . The information that is stored here makes sure that the correct program opens when you open a file by using Windows Explorer. This key is sometimes abbreviated as HKCR. Starting with Windows 2000, this information is stored under both the HKEY_LOCAL_MACHINE and HKEY_CURRENT_USER keys. The HKEY_LOCAL_MACHINE\\Software\\Classes key contains default settings that can apply to all users on the local computer. The HKEY_CURRENT_USER\\Software\\Classes key has settings that override the default settings and apply only to the interactive user. The HKEY_CLASSES_ROOT key provides a view of the registry that merges the information from these two sources. HKEY_CLASSES_ROOT also provides this merged view for programs that are designed for earlier versions of Windows. To change the settings for the interactive user, changes must be made under HKEY_CURRENT_USER\\Software\\Classes instead of under HKEY_CLASSES_ROOT. To change the default settings, changes must be made under HKEY_LOCAL_MACHINE\\Software\\Classes . If you write keys to a key under HKEY_CLASSES_ROOT, the system stores the information under HKEY_LOCAL_MACHINE\\Software\\Classes . If you write values to a key under HKEY_CLASSES_ROOT, and the key already exists under HKEY_CURRENT_USER\\Software\\Classes , the system will store the information there instead of under HKEY_LOCAL_MACHINE\\Software\\Classes . Contains information about the hardware profile that is used by the local computer at system startup. Tools for the windows registry Acquire the windows registry Name Description Link KAPE Tool to acquire the windows registry KAPE Autopsy Tool to acquire the windows registry, hard drive and conduct investigations on these elements Autopsy FTK Imager Tool to acquire, extract files from hard drive FTK Imager Explore the windows registry Name Description Link Registry viewer Tool to acquire the windows registry Registry Viewer Zimmerman's registry explorer Tool to explore the windows registry Zimmerman's blog RegRipper Tool to explore the windows registry RegRipper System informations and system accounts OS version SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion Current control set The last good known configuration is stored here : SYSTEM\\ControlSet001 - SYSTEM\\ControlSet002 - SYSTEM\\Select\\Current - SYSTEM\\Select\\LastKnownGood Computer Name SYSTEM\\CurrentControlSet\\Control\\ComputerName\\ComputerName Time zone information SYSTEM\\CurrentControlSet\\Control\\TimeZoneInformation Network interfaces and past networks SYSTEM\\CurrentControlSet\\Services\\Tcpip\\Parameters\\Interfaces SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\NetworkList\\Signatures\\Unmanaged SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\NetworkList\\Signatures\\Managed Autostart programs NTUSER.DAT\\Software\\Microsoft\\Windows\\CurrentVersion\\Run NTUSER.DAT\\Software\\Microsoft\\Windows\\CurrentVersion\\RunOnce SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\RunOnce SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\policies\\Explorer\\Run SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run SAM Hive and user information SAM\\Domains\\Account\\Users Usage or knowledge of files/folders Recent files NTUSER.DAT\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\RecentDocs NTUSER.DAT\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\RecentDocs\\.ext Office recent files NTUSER.DAT\\Software\\Microsoft\\Office\\VERSION NTUSER.DAT\\Software\\Microsoft\\Office\\15.0\\Word NTUSER.DAT\\Software\\Microsoft\\Office\\VERSION\\UserMRU\\LiveID_####\\FileMRU Shellbags USRCLASS.DAT\\Local Settings\\Software\\Microsoft\\Windows\\Shell\\Bags USRCLASS.DAT\\Local Settings\\Software\\Microsoft\\Windows\\Shell\\BagMRU NTUSER.DAT\\Software\\Microsoft\\Windows\\Shell\\BagMRU NTUSER.DAT\\Software\\Microsoft\\Windows\\Shell\\Bags Open/Save and LastVisited dialog MRUs NTUSER.DAT\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\ComDlg32\\OpenSavePIDlMRU NTUSER.DAT\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\ComDlg32\\LastVisitedPidlMRU Windows explorer address/search bars NTUSER.DAT\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\TypedPaths NTUSER.DAT\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\WordWheelQuery Executed programs UserAssist NTUSER.DAT\\Software\\Microsoft\\Windows\\Currentversion\\Explorer\\UserAssist\\{GUID}\\Count ShimCache SYSTEM\\CurrentControlSet\\Control\\Session Manager\\AppCompatCache AppCompatCacheParser.exe --csv <path to save output> -f <path to SYSTEM hive for data parsing> -c <control set to parse> AmCache C:\\Windows\\appcompat\\Programs\\Amcache.hve Amcache.hve\\Root\\File\\{Volume GUID}\\ BAM/DAM SYSTEM\\CurrentControlSet\\Services\\bam\\UserSettings\\{SID} SYSTEM\\CurrentControlSet\\Services\\dam\\UserSettings\\{SID} External devices Device identification SYSTEM\\CurrentControlSet\\Enum\\USBSTOR SYSTEM\\CurrentControlSet\\Enum\\USB First/Last Times SYSTEM\\CurrentControlSet\\Enum\\USBSTOR\\Ven_Prod_Version\\USBSerial#\\Properties\\{83da6326-97a6-4088-9453-a19231573b29}\\#### USB devices volume name SOFTWARE\\Microsoft\\Windows Portable Devices\\Devices Resources https://tryhackme.com/room/windowsforensics1","title":"The windows registry"},{"location":"Digital%20forensic/OS%20Forensic/Windows/Filesystem%20analysis/Registry/#the-windows-registry","text":"The aim of this page is to conduct investigation within the windows registry.","title":"The windows registry"},{"location":"Digital%20forensic/OS%20Forensic/Windows/Filesystem%20analysis/Registry/#what-is-the-windows-registry","text":"The Windows Registry is a collection of databases that contains the system's configuration data. This configuration data can be about the hardware, the software, or the user's information. It also includes data about the recently used files, programs used, or devices connected to the system. As you can understand, this data is beneficial from a forensics standpoint. Throughout this room, we will learn ways to read this data to identify the required information about the system. You can view the registry using regedit.exe, a built-in Windows utility to view and edit the registry. We'll explore other tools to learn about the registry in the upcoming tasks. The Windows registry consists of Keys and Values. When you open the regedit.exe utility to view the registry, the folders you see are Registry Keys. Registry Values are the data stored in these Registry Keys. A Registry Hive is a group of Keys, subkeys, and values stored in a single file on the disk. The registry on any Windows system contains the following five root keys: Five root keys HKEY_CURRENT_USER HKEY_USERS HKEY_LOCAL_MACHINE HKEY_CLASSES_ROOT HKEY_CURRENT_CONFIG Contains the root of the configuration information for the user who is currently logged on. The user's folders, screen colors, and Control Panel settings are stored here. This information is associated with the user's profile. This key is sometimes abbreviated as HKCU. Contains all the actively loaded user profiles on the computer. HKEY_CURRENT_USER is a subkey of HKEY_USERS. HKEY_USERS is sometimes abbreviated as HKU. Contains configuration information particular to the computer (for any user). This key is sometimes abbreviated as HKLM. This is a subkey of HKEY_LOCAL_MACHINE\\Software . The information that is stored here makes sure that the correct program opens when you open a file by using Windows Explorer. This key is sometimes abbreviated as HKCR. Starting with Windows 2000, this information is stored under both the HKEY_LOCAL_MACHINE and HKEY_CURRENT_USER keys. The HKEY_LOCAL_MACHINE\\Software\\Classes key contains default settings that can apply to all users on the local computer. The HKEY_CURRENT_USER\\Software\\Classes key has settings that override the default settings and apply only to the interactive user. The HKEY_CLASSES_ROOT key provides a view of the registry that merges the information from these two sources. HKEY_CLASSES_ROOT also provides this merged view for programs that are designed for earlier versions of Windows. To change the settings for the interactive user, changes must be made under HKEY_CURRENT_USER\\Software\\Classes instead of under HKEY_CLASSES_ROOT. To change the default settings, changes must be made under HKEY_LOCAL_MACHINE\\Software\\Classes . If you write keys to a key under HKEY_CLASSES_ROOT, the system stores the information under HKEY_LOCAL_MACHINE\\Software\\Classes . If you write values to a key under HKEY_CLASSES_ROOT, and the key already exists under HKEY_CURRENT_USER\\Software\\Classes , the system will store the information there instead of under HKEY_LOCAL_MACHINE\\Software\\Classes . Contains information about the hardware profile that is used by the local computer at system startup.","title":"What is the windows registry ?"},{"location":"Digital%20forensic/OS%20Forensic/Windows/Filesystem%20analysis/Registry/#tools-for-the-windows-registry","text":"","title":"Tools for the windows registry"},{"location":"Digital%20forensic/OS%20Forensic/Windows/Filesystem%20analysis/Registry/#acquire-the-windows-registry","text":"Name Description Link KAPE Tool to acquire the windows registry KAPE Autopsy Tool to acquire the windows registry, hard drive and conduct investigations on these elements Autopsy FTK Imager Tool to acquire, extract files from hard drive FTK Imager","title":"Acquire the windows registry"},{"location":"Digital%20forensic/OS%20Forensic/Windows/Filesystem%20analysis/Registry/#explore-the-windows-registry","text":"Name Description Link Registry viewer Tool to acquire the windows registry Registry Viewer Zimmerman's registry explorer Tool to explore the windows registry Zimmerman's blog RegRipper Tool to explore the windows registry RegRipper","title":"Explore the windows registry"},{"location":"Digital%20forensic/OS%20Forensic/Windows/Filesystem%20analysis/Registry/#system-informations-and-system-accounts","text":"","title":"System informations and system accounts"},{"location":"Digital%20forensic/OS%20Forensic/Windows/Filesystem%20analysis/Registry/#os-version","text":"SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion","title":"OS version"},{"location":"Digital%20forensic/OS%20Forensic/Windows/Filesystem%20analysis/Registry/#current-control-set","text":"The last good known configuration is stored here : SYSTEM\\ControlSet001 - SYSTEM\\ControlSet002 - SYSTEM\\Select\\Current - SYSTEM\\Select\\LastKnownGood","title":"Current control set"},{"location":"Digital%20forensic/OS%20Forensic/Windows/Filesystem%20analysis/Registry/#computer-name","text":"SYSTEM\\CurrentControlSet\\Control\\ComputerName\\ComputerName","title":"Computer Name"},{"location":"Digital%20forensic/OS%20Forensic/Windows/Filesystem%20analysis/Registry/#time-zone-information","text":"SYSTEM\\CurrentControlSet\\Control\\TimeZoneInformation","title":"Time zone information"},{"location":"Digital%20forensic/OS%20Forensic/Windows/Filesystem%20analysis/Registry/#network-interfaces-and-past-networks","text":"SYSTEM\\CurrentControlSet\\Services\\Tcpip\\Parameters\\Interfaces SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\NetworkList\\Signatures\\Unmanaged SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\NetworkList\\Signatures\\Managed","title":"Network interfaces and past networks"},{"location":"Digital%20forensic/OS%20Forensic/Windows/Filesystem%20analysis/Registry/#autostart-programs","text":"NTUSER.DAT\\Software\\Microsoft\\Windows\\CurrentVersion\\Run NTUSER.DAT\\Software\\Microsoft\\Windows\\CurrentVersion\\RunOnce SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\RunOnce SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\policies\\Explorer\\Run SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run","title":"Autostart programs"},{"location":"Digital%20forensic/OS%20Forensic/Windows/Filesystem%20analysis/Registry/#sam-hive-and-user-information","text":"SAM\\Domains\\Account\\Users","title":"SAM Hive and user information"},{"location":"Digital%20forensic/OS%20Forensic/Windows/Filesystem%20analysis/Registry/#usage-or-knowledge-of-filesfolders","text":"","title":"Usage or knowledge of files/folders"},{"location":"Digital%20forensic/OS%20Forensic/Windows/Filesystem%20analysis/Registry/#recent-files","text":"NTUSER.DAT\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\RecentDocs NTUSER.DAT\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\RecentDocs\\.ext","title":"Recent files"},{"location":"Digital%20forensic/OS%20Forensic/Windows/Filesystem%20analysis/Registry/#office-recent-files","text":"NTUSER.DAT\\Software\\Microsoft\\Office\\VERSION NTUSER.DAT\\Software\\Microsoft\\Office\\15.0\\Word NTUSER.DAT\\Software\\Microsoft\\Office\\VERSION\\UserMRU\\LiveID_####\\FileMRU","title":"Office recent files"},{"location":"Digital%20forensic/OS%20Forensic/Windows/Filesystem%20analysis/Registry/#shellbags","text":"USRCLASS.DAT\\Local Settings\\Software\\Microsoft\\Windows\\Shell\\Bags USRCLASS.DAT\\Local Settings\\Software\\Microsoft\\Windows\\Shell\\BagMRU NTUSER.DAT\\Software\\Microsoft\\Windows\\Shell\\BagMRU NTUSER.DAT\\Software\\Microsoft\\Windows\\Shell\\Bags","title":"Shellbags"},{"location":"Digital%20forensic/OS%20Forensic/Windows/Filesystem%20analysis/Registry/#opensave-and-lastvisited-dialog-mrus","text":"NTUSER.DAT\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\ComDlg32\\OpenSavePIDlMRU NTUSER.DAT\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\ComDlg32\\LastVisitedPidlMRU","title":"Open/Save and LastVisited dialog MRUs"},{"location":"Digital%20forensic/OS%20Forensic/Windows/Filesystem%20analysis/Registry/#windows-explorer-addresssearch-bars","text":"NTUSER.DAT\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\TypedPaths NTUSER.DAT\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\WordWheelQuery","title":"Windows explorer address/search bars"},{"location":"Digital%20forensic/OS%20Forensic/Windows/Filesystem%20analysis/Registry/#executed-programs","text":"","title":"Executed programs"},{"location":"Digital%20forensic/OS%20Forensic/Windows/Filesystem%20analysis/Registry/#userassist","text":"NTUSER.DAT\\Software\\Microsoft\\Windows\\Currentversion\\Explorer\\UserAssist\\{GUID}\\Count","title":"UserAssist"},{"location":"Digital%20forensic/OS%20Forensic/Windows/Filesystem%20analysis/Registry/#shimcache","text":"SYSTEM\\CurrentControlSet\\Control\\Session Manager\\AppCompatCache AppCompatCacheParser.exe --csv <path to save output> -f <path to SYSTEM hive for data parsing> -c <control set to parse>","title":"ShimCache"},{"location":"Digital%20forensic/OS%20Forensic/Windows/Filesystem%20analysis/Registry/#amcache","text":"C:\\Windows\\appcompat\\Programs\\Amcache.hve Amcache.hve\\Root\\File\\{Volume GUID}\\","title":"AmCache"},{"location":"Digital%20forensic/OS%20Forensic/Windows/Filesystem%20analysis/Registry/#bamdam","text":"SYSTEM\\CurrentControlSet\\Services\\bam\\UserSettings\\{SID} SYSTEM\\CurrentControlSet\\Services\\dam\\UserSettings\\{SID}","title":"BAM/DAM"},{"location":"Digital%20forensic/OS%20Forensic/Windows/Filesystem%20analysis/Registry/#external-devices","text":"","title":"External devices"},{"location":"Digital%20forensic/OS%20Forensic/Windows/Filesystem%20analysis/Registry/#device-identification","text":"SYSTEM\\CurrentControlSet\\Enum\\USBSTOR SYSTEM\\CurrentControlSet\\Enum\\USB","title":"Device identification"},{"location":"Digital%20forensic/OS%20Forensic/Windows/Filesystem%20analysis/Registry/#firstlast-times","text":"SYSTEM\\CurrentControlSet\\Enum\\USBSTOR\\Ven_Prod_Version\\USBSerial#\\Properties\\{83da6326-97a6-4088-9453-a19231573b29}\\####","title":"First/Last Times"},{"location":"Digital%20forensic/OS%20Forensic/Windows/Filesystem%20analysis/Registry/#usb-devices-volume-name","text":"SOFTWARE\\Microsoft\\Windows Portable Devices\\Devices","title":"USB devices volume name"},{"location":"Digital%20forensic/OS%20Forensic/Windows/Filesystem%20analysis/Registry/#resources","text":"https://tryhackme.com/room/windowsforensics1","title":"Resources"},{"location":"Digital%20forensic/OS%20Forensic/Windows/Memory%20analysis/Windows%20memory/","text":"Windows memory analysis This page aims to give tricks regarding the analysis of Windows memory by using Volatility Get a memory dump Dumping tools To retrieve a memory dump from a windows machine, you can use the following tools : Name Description Link FTK-Imager FTK-Imager Redline Redline DumpIt.exe DumpIt.exe WinDD32.exe / WinDD64.exe WinDD.exe Artifacts files Physical machine Also, you can try to retrieve specifics files if you don't want to dump the memory with the tool. You should search for the following file Name Description Path hiberfil.sys Hibernation File generated by the Windows OS to speed up the boot process %SystemDrive%/hiberfil.sys Virtual machine In case you have to lead investigations on a virtual machine, you simply need to copy these file without having to interact with the virtual machine : Name Description Link VMware - .vmem file Hyper-V - .bin file Parallels - .mem file VirtualBox - .sav file For this type of hypervisor, you will need to dump the memory like a normal bare-metal system Investigation Volatility2 Identify the OS system Before starting the investigation, you will need to determine the OS used on the machine. So, you need to run one of the following commands Text Only volatility -f file.dmp imageinfo volatility -f file.dmp kdbgscan Once you have identified the OS used on the machine, save the found profile nearby, you're going to need it for the rest of your investigation when running volatility commands. General informations on the memory dump Get hostname of computer First way Text Only volatility --profile=PROFILE -f file.dmp printkey -K \"Software\\Microsoft\\Windows Media\\WMSDK\\General\" Second way Text Only volatility --profile=PROFILE -f file.dmp printkey -K \"ControlSet001\\Control\\ComputerName\\ActiveComputerName\" Third way Text Only volatility --profile=PROFILE -f file.dmp hivelist # Retrieve virtual address of \\REGISTRY\\MACHINE\\SYSTEM volatility --profile=PROFILE -f file.dmp `printkey -o virtual_address -K \"ControlSet001\\services\\Tcpip\\Parameters\"` Get the environment variables Text Only volatility --profile=PROFILE -f file.dmp envars Get the file cached in the memory dump Text Only photorec path/to/mem/dump #Get All Files with photorec volatility --profile=PROFILE -f file.dmp filesystem Get the list of running processes Get list of process Text Only volatility --profile=PROFILE -f file.dmp pslist Get hidden processes Text Only volatility --profile=PROFILE -f file.dmp psxview Get list of loaded modules Text Only volatility --profile=PROFILE -f file.dmp ldrmodules Once you ran this command, lookup for processes with have the 'False' value in one of the following column : Inload, InInit or InMem. Identifying potential suspect process can be useful to speed up the research. Get list of loaded DLL files Text Only volatility --profile=PROFILE -f file.dmp dlllist #For all the loaded DLL volatility --profile=PROFILE -f file.dmp dlllist Get list of unexcepted patches on the system Text Only volatility --profile=PROFILE -f file.dmp apihooks Dump a process Dump any process Text Only volatility --profile=PROFILE -f path/to/mem/dump memdump -p your_pid --dump-dir . strings your_pid.dmp > your_pid.txt #Retrieve only strings char from process dump Dump malicious process Text Only volatility --profile=PROFILE -f file.dmp malfind -D path/to/destination You can then proceed to get a hash from the file and submit it to Virustotal and Hybrid Analysis to know more about the malware you found Dump DLL files used by a process Text Only volatility --profile=PROFILE -f file.dmp dlldump --pid=PID -D path/to/destination Get command list Text Only volatility --profile=PROFILE -f path/to/mem/dump cmdlist Informations on network connections Dump current network connections Text Only volatility --profile=PROFILE -f path/to/mem/dump netscan #Does not support WindowsXP profile Volatility3 Identify the OS system Text Only vol -f path/to/file banners.Banners #Get banners of memory dump vol -f path/to/file imageinfo #Get information regarding vol -f path/to/file windows.info NTBuildLab : Build version of the OS SystemTime : Time at which the memory dump was done Get the environment variables Text Only vol -f path/to/file windows.envars Get the file cached in the memory dump Text Only vol -f path/to/file windows.filescan Processes Get the list of running processes Text Only vol -f path/to/file windows.pslist vol -f path/to/file windows.psscan vol -f path/to/file windows.pstree Dump a process Text Only vol -f path/to/file -o /path/to/dump/dir windows.memmap.Memmap --pid=pid_proc --dump Search valuables informations within process dump In case you want to analyze a process dump, please check this page. Get DLL imported by process Text Only vol -f path/to/file windows.dlllist | grep pid Get command list Text Only vol -f path/to/file windows.cmdlist Informations on network connections Text Only vol -f path/to/file windows.netstat Resources SANS Institute memory forensic cheat sheet v1.2","title":"Windows memory analysis"},{"location":"Digital%20forensic/OS%20Forensic/Windows/Memory%20analysis/Windows%20memory/#windows-memory-analysis","text":"This page aims to give tricks regarding the analysis of Windows memory by using Volatility","title":"Windows memory analysis"},{"location":"Digital%20forensic/OS%20Forensic/Windows/Memory%20analysis/Windows%20memory/#get-a-memory-dump","text":"","title":"Get a memory dump"},{"location":"Digital%20forensic/OS%20Forensic/Windows/Memory%20analysis/Windows%20memory/#dumping-tools","text":"To retrieve a memory dump from a windows machine, you can use the following tools : Name Description Link FTK-Imager FTK-Imager Redline Redline DumpIt.exe DumpIt.exe WinDD32.exe / WinDD64.exe WinDD.exe","title":"Dumping tools"},{"location":"Digital%20forensic/OS%20Forensic/Windows/Memory%20analysis/Windows%20memory/#artifacts-files","text":"","title":"Artifacts files"},{"location":"Digital%20forensic/OS%20Forensic/Windows/Memory%20analysis/Windows%20memory/#physical-machine","text":"Also, you can try to retrieve specifics files if you don't want to dump the memory with the tool. You should search for the following file Name Description Path hiberfil.sys Hibernation File generated by the Windows OS to speed up the boot process %SystemDrive%/hiberfil.sys","title":"Physical machine"},{"location":"Digital%20forensic/OS%20Forensic/Windows/Memory%20analysis/Windows%20memory/#virtual-machine","text":"In case you have to lead investigations on a virtual machine, you simply need to copy these file without having to interact with the virtual machine : Name Description Link VMware - .vmem file Hyper-V - .bin file Parallels - .mem file VirtualBox - .sav file For this type of hypervisor, you will need to dump the memory like a normal bare-metal system","title":"Virtual machine"},{"location":"Digital%20forensic/OS%20Forensic/Windows/Memory%20analysis/Windows%20memory/#investigation","text":"","title":"Investigation"},{"location":"Digital%20forensic/OS%20Forensic/Windows/Memory%20analysis/Windows%20memory/#volatility2","text":"","title":"Volatility2"},{"location":"Digital%20forensic/OS%20Forensic/Windows/Memory%20analysis/Windows%20memory/#identify-the-os-system","text":"Before starting the investigation, you will need to determine the OS used on the machine. So, you need to run one of the following commands Text Only volatility -f file.dmp imageinfo volatility -f file.dmp kdbgscan Once you have identified the OS used on the machine, save the found profile nearby, you're going to need it for the rest of your investigation when running volatility commands.","title":"Identify the OS system"},{"location":"Digital%20forensic/OS%20Forensic/Windows/Memory%20analysis/Windows%20memory/#general-informations-on-the-memory-dump","text":"","title":"General informations on the memory dump"},{"location":"Digital%20forensic/OS%20Forensic/Windows/Memory%20analysis/Windows%20memory/#get-hostname-of-computer","text":"","title":"Get hostname of computer"},{"location":"Digital%20forensic/OS%20Forensic/Windows/Memory%20analysis/Windows%20memory/#first-way","text":"Text Only volatility --profile=PROFILE -f file.dmp printkey -K \"Software\\Microsoft\\Windows Media\\WMSDK\\General\"","title":"First way"},{"location":"Digital%20forensic/OS%20Forensic/Windows/Memory%20analysis/Windows%20memory/#second-way","text":"Text Only volatility --profile=PROFILE -f file.dmp printkey -K \"ControlSet001\\Control\\ComputerName\\ActiveComputerName\"","title":"Second way"},{"location":"Digital%20forensic/OS%20Forensic/Windows/Memory%20analysis/Windows%20memory/#third-way","text":"Text Only volatility --profile=PROFILE -f file.dmp hivelist # Retrieve virtual address of \\REGISTRY\\MACHINE\\SYSTEM volatility --profile=PROFILE -f file.dmp `printkey -o virtual_address -K \"ControlSet001\\services\\Tcpip\\Parameters\"`","title":"Third way"},{"location":"Digital%20forensic/OS%20Forensic/Windows/Memory%20analysis/Windows%20memory/#get-the-environment-variables","text":"Text Only volatility --profile=PROFILE -f file.dmp envars","title":"Get the environment variables"},{"location":"Digital%20forensic/OS%20Forensic/Windows/Memory%20analysis/Windows%20memory/#get-the-file-cached-in-the-memory-dump","text":"Text Only photorec path/to/mem/dump #Get All Files with photorec volatility --profile=PROFILE -f file.dmp filesystem","title":"Get the file cached in the memory dump"},{"location":"Digital%20forensic/OS%20Forensic/Windows/Memory%20analysis/Windows%20memory/#get-the-list-of-running-processes","text":"","title":"Get the list of running processes"},{"location":"Digital%20forensic/OS%20Forensic/Windows/Memory%20analysis/Windows%20memory/#get-list-of-process","text":"Text Only volatility --profile=PROFILE -f file.dmp pslist","title":"Get list of process"},{"location":"Digital%20forensic/OS%20Forensic/Windows/Memory%20analysis/Windows%20memory/#get-hidden-processes","text":"Text Only volatility --profile=PROFILE -f file.dmp psxview","title":"Get hidden processes"},{"location":"Digital%20forensic/OS%20Forensic/Windows/Memory%20analysis/Windows%20memory/#get-list-of-loaded-modules","text":"Text Only volatility --profile=PROFILE -f file.dmp ldrmodules Once you ran this command, lookup for processes with have the 'False' value in one of the following column : Inload, InInit or InMem. Identifying potential suspect process can be useful to speed up the research.","title":"Get list of loaded modules"},{"location":"Digital%20forensic/OS%20Forensic/Windows/Memory%20analysis/Windows%20memory/#get-list-of-loaded-dll-files","text":"Text Only volatility --profile=PROFILE -f file.dmp dlllist #For all the loaded DLL volatility --profile=PROFILE -f file.dmp dlllist","title":"Get list of loaded DLL files"},{"location":"Digital%20forensic/OS%20Forensic/Windows/Memory%20analysis/Windows%20memory/#get-list-of-unexcepted-patches-on-the-system","text":"Text Only volatility --profile=PROFILE -f file.dmp apihooks","title":"Get list of unexcepted patches on the system"},{"location":"Digital%20forensic/OS%20Forensic/Windows/Memory%20analysis/Windows%20memory/#dump-a-process","text":"","title":"Dump a process"},{"location":"Digital%20forensic/OS%20Forensic/Windows/Memory%20analysis/Windows%20memory/#dump-any-process","text":"Text Only volatility --profile=PROFILE -f path/to/mem/dump memdump -p your_pid --dump-dir . strings your_pid.dmp > your_pid.txt #Retrieve only strings char from process dump","title":"Dump any process"},{"location":"Digital%20forensic/OS%20Forensic/Windows/Memory%20analysis/Windows%20memory/#dump-malicious-process","text":"Text Only volatility --profile=PROFILE -f file.dmp malfind -D path/to/destination You can then proceed to get a hash from the file and submit it to Virustotal and Hybrid Analysis to know more about the malware you found","title":"Dump malicious process"},{"location":"Digital%20forensic/OS%20Forensic/Windows/Memory%20analysis/Windows%20memory/#dump-dll-files-used-by-a-process","text":"Text Only volatility --profile=PROFILE -f file.dmp dlldump --pid=PID -D path/to/destination","title":"Dump DLL files used by a process"},{"location":"Digital%20forensic/OS%20Forensic/Windows/Memory%20analysis/Windows%20memory/#get-command-list","text":"Text Only volatility --profile=PROFILE -f path/to/mem/dump cmdlist","title":"Get command list"},{"location":"Digital%20forensic/OS%20Forensic/Windows/Memory%20analysis/Windows%20memory/#informations-on-network-connections","text":"","title":"Informations on network connections"},{"location":"Digital%20forensic/OS%20Forensic/Windows/Memory%20analysis/Windows%20memory/#dump-current-network-connections","text":"Text Only volatility --profile=PROFILE -f path/to/mem/dump netscan #Does not support WindowsXP profile","title":"Dump current network connections"},{"location":"Digital%20forensic/OS%20Forensic/Windows/Memory%20analysis/Windows%20memory/#volatility3","text":"","title":"Volatility3"},{"location":"Digital%20forensic/OS%20Forensic/Windows/Memory%20analysis/Windows%20memory/#identify-the-os-system_1","text":"Text Only vol -f path/to/file banners.Banners #Get banners of memory dump vol -f path/to/file imageinfo #Get information regarding vol -f path/to/file windows.info NTBuildLab : Build version of the OS SystemTime : Time at which the memory dump was done","title":"Identify the OS system"},{"location":"Digital%20forensic/OS%20Forensic/Windows/Memory%20analysis/Windows%20memory/#get-the-environment-variables_1","text":"Text Only vol -f path/to/file windows.envars","title":"Get the environment variables"},{"location":"Digital%20forensic/OS%20Forensic/Windows/Memory%20analysis/Windows%20memory/#get-the-file-cached-in-the-memory-dump_1","text":"Text Only vol -f path/to/file windows.filescan","title":"Get the file cached in the memory dump"},{"location":"Digital%20forensic/OS%20Forensic/Windows/Memory%20analysis/Windows%20memory/#processes","text":"","title":"Processes"},{"location":"Digital%20forensic/OS%20Forensic/Windows/Memory%20analysis/Windows%20memory/#get-the-list-of-running-processes_1","text":"Text Only vol -f path/to/file windows.pslist vol -f path/to/file windows.psscan vol -f path/to/file windows.pstree","title":"Get the list of running processes"},{"location":"Digital%20forensic/OS%20Forensic/Windows/Memory%20analysis/Windows%20memory/#dump-a-process_1","text":"Text Only vol -f path/to/file -o /path/to/dump/dir windows.memmap.Memmap --pid=pid_proc --dump","title":"Dump a process"},{"location":"Digital%20forensic/OS%20Forensic/Windows/Memory%20analysis/Windows%20memory/#search-valuables-informations-within-process-dump","text":"In case you want to analyze a process dump, please check this page.","title":"Search valuables informations within process dump"},{"location":"Digital%20forensic/OS%20Forensic/Windows/Memory%20analysis/Windows%20memory/#get-dll-imported-by-process","text":"Text Only vol -f path/to/file windows.dlllist | grep pid","title":"Get DLL imported by process"},{"location":"Digital%20forensic/OS%20Forensic/Windows/Memory%20analysis/Windows%20memory/#get-command-list_1","text":"Text Only vol -f path/to/file windows.cmdlist","title":"Get command list"},{"location":"Digital%20forensic/OS%20Forensic/Windows/Memory%20analysis/Windows%20memory/#informations-on-network-connections_1","text":"Text Only vol -f path/to/file windows.netstat","title":"Informations on network connections"},{"location":"Digital%20forensic/OS%20Forensic/Windows/Memory%20analysis/Windows%20memory/#resources","text":"SANS Institute memory forensic cheat sheet v1.2","title":"Resources"},{"location":"Digital%20forensic/OS%20Forensic/iOS/Filesystem%20analysis/iOS%20filesystem/","text":"iOS filesystem This page aims to give tricks regarding the iOS filesystem such as the interesting files for example. WARNING ! *Conducting investigation directly on the compromised machine will alter the forensic integrity of the evidences and the compromised machine, You must proceed with extreme caution ! Before going further, make sure that you have made a copy of the compromised device. * Automated analysis If you want to speed up investigation on an android device, you can use this tool : Name of the tool Description Link ALEAPP iOS log parser ILEAPP Autopsy General log parser Autopsy Manual analysis In case you need to search specific informations regarding the device, you can check the following path : General informations Path Notes Storage informations Path Notes Bluetooth informations Path Notes Clipboard informations Path Notes","title":"iOS filesystem"},{"location":"Digital%20forensic/OS%20Forensic/iOS/Filesystem%20analysis/iOS%20filesystem/#ios-filesystem","text":"This page aims to give tricks regarding the iOS filesystem such as the interesting files for example. WARNING ! *Conducting investigation directly on the compromised machine will alter the forensic integrity of the evidences and the compromised machine, You must proceed with extreme caution ! Before going further, make sure that you have made a copy of the compromised device. *","title":"iOS filesystem"},{"location":"Digital%20forensic/OS%20Forensic/iOS/Filesystem%20analysis/iOS%20filesystem/#automated-analysis","text":"If you want to speed up investigation on an android device, you can use this tool : Name of the tool Description Link ALEAPP iOS log parser ILEAPP Autopsy General log parser Autopsy","title":"Automated analysis"},{"location":"Digital%20forensic/OS%20Forensic/iOS/Filesystem%20analysis/iOS%20filesystem/#manual-analysis","text":"In case you need to search specific informations regarding the device, you can check the following path :","title":"Manual analysis"},{"location":"Digital%20forensic/OS%20Forensic/iOS/Filesystem%20analysis/iOS%20filesystem/#general-informations","text":"Path Notes","title":"General informations"},{"location":"Digital%20forensic/OS%20Forensic/iOS/Filesystem%20analysis/iOS%20filesystem/#storage-informations","text":"Path Notes","title":"Storage informations"},{"location":"Digital%20forensic/OS%20Forensic/iOS/Filesystem%20analysis/iOS%20filesystem/#bluetooth-informations","text":"Path Notes","title":"Bluetooth informations"},{"location":"Digital%20forensic/OS%20Forensic/iOS/Filesystem%20analysis/iOS%20filesystem/#clipboard-informations","text":"Path Notes","title":"Clipboard informations"},{"location":"Digital%20forensic/Storage%20device%20forensic/Flash%20memory%20forensic/","text":"Flash memory forensic This page aims to give specifics tricks regarding the analysis of flash storage media (USB keys, any memory cards..) Running performance test Testing I/O performance These commands will compromise the evidence integrity ! Please proceed with caution. f3write and f3read commands Write large files to the card Text Only ./f3write /media/username/AAAA-HHHH/ Check if the card contains the written files Text Only ./f3read /media/username/AAAA-HHHH/ Testing capacity size This command will compromise the evidence integrity ! Please proceed with caution. f3probe command Text Only sudo f3probe --destructive --time-ops /dev/mmcblkX Repair flash memory card Fixing the flash memory card This command will compromise the evidence integrity ! Please proceed with caution. f3fix command Text Only ./f3fix --last-sec=any_value /dev/mmcblkX Resources https://fight-flash-fraud.readthedocs.io/en/latest/introduction.html#testing-performance-with-f3read-f3write","title":"Flash memory forensic"},{"location":"Digital%20forensic/Storage%20device%20forensic/Flash%20memory%20forensic/#flash-memory-forensic","text":"This page aims to give specifics tricks regarding the analysis of flash storage media (USB keys, any memory cards..)","title":"Flash memory forensic"},{"location":"Digital%20forensic/Storage%20device%20forensic/Flash%20memory%20forensic/#running-performance-test","text":"Testing I/O performance These commands will compromise the evidence integrity ! Please proceed with caution. f3write and f3read commands Write large files to the card Text Only ./f3write /media/username/AAAA-HHHH/ Check if the card contains the written files Text Only ./f3read /media/username/AAAA-HHHH/ Testing capacity size This command will compromise the evidence integrity ! Please proceed with caution. f3probe command Text Only sudo f3probe --destructive --time-ops /dev/mmcblkX","title":"Running performance test"},{"location":"Digital%20forensic/Storage%20device%20forensic/Flash%20memory%20forensic/#repair-flash-memory-card","text":"Fixing the flash memory card This command will compromise the evidence integrity ! Please proceed with caution. f3fix command Text Only ./f3fix --last-sec=any_value /dev/mmcblkX","title":"Repair flash memory card"},{"location":"Digital%20forensic/Storage%20device%20forensic/Flash%20memory%20forensic/#resources","text":"https://fight-flash-fraud.readthedocs.io/en/latest/introduction.html#testing-performance-with-f3read-f3write","title":"Resources"},{"location":"Digital%20forensic/Storage%20device%20forensic/Hard%20drive%20forensic/","text":"Hard drive forensic This section aims to give specifics tricks regarding the analysis of hard drive. Checking hard drive health smartctl command Install package smartmontools before issuing the command Text Only smartctl -i /dev/sdX Get informations on the hard drive hdparm command This command can compromise the evidence integrity ! Please proceed with caution. Text Only sudo hdparm -I /dev/sdX Convert hard drive image between format VMDK -> RAW RAM -> QCOW2 VMDK -> QCOW2 OVA -> QCOW2 Text Only qemu-img convert path/to/file.vmdk path/to/new/file.raw Text Only qemu-img convert path/to/file.raw path/to/new/file.qcow2 Text Only qemu-img convert -f vmdk path/to/file.vmdk path/to/new/file.qcow2 First step : Get the vmdk file Text Only tar xf path/to/file.ova -C . Second step : Convert the VMDK file to QCOW2 file Text Only qemu-img convert -f vmdk path/to/file.vmdk path/to/new/file.qcow2 Third step (optionnal) : Reduce the size of the generated file Text Only qemu-img convert -O qcow2 path/to/new/file.qcow2 path/to/new/file-shrunk.qcow2 Resources","title":"Hard drive forensic"},{"location":"Digital%20forensic/Storage%20device%20forensic/Hard%20drive%20forensic/#hard-drive-forensic","text":"This section aims to give specifics tricks regarding the analysis of hard drive. Checking hard drive health smartctl command Install package smartmontools before issuing the command Text Only smartctl -i /dev/sdX Get informations on the hard drive hdparm command This command can compromise the evidence integrity ! Please proceed with caution. Text Only sudo hdparm -I /dev/sdX Convert hard drive image between format VMDK -> RAW RAM -> QCOW2 VMDK -> QCOW2 OVA -> QCOW2 Text Only qemu-img convert path/to/file.vmdk path/to/new/file.raw Text Only qemu-img convert path/to/file.raw path/to/new/file.qcow2 Text Only qemu-img convert -f vmdk path/to/file.vmdk path/to/new/file.qcow2 First step : Get the vmdk file Text Only tar xf path/to/file.ova -C . Second step : Convert the VMDK file to QCOW2 file Text Only qemu-img convert -f vmdk path/to/file.vmdk path/to/new/file.qcow2 Third step (optionnal) : Reduce the size of the generated file Text Only qemu-img convert -O qcow2 path/to/new/file.qcow2 path/to/new/file-shrunk.qcow2","title":"Hard drive forensic"},{"location":"Digital%20forensic/Storage%20device%20forensic/Hard%20drive%20forensic/#resources","text":"","title":"Resources"},{"location":"Digital%20forensic/Storage%20device%20forensic/Storage%20media%20forensic/","text":"Storage media forensic This sections aims to give generals tricks regarding the investigation of any storage media. Acquire a storage media image from device Cloning a storage media DDRescue tool Install DDRescue tool Clone a storage media locally Clone a storage media through network For Debian and Ubuntu Text Only sudo apt install gddrescue # Debian and Ubuntu Text Only ddrescue -d -r3 /dev/sda test.img test.logfile Text Only ddrescue -d -r3 /dev/sda test.img test.logfile DD tool Clone a storage media locally Clone a storage media through network Text Only dd if=path/to/disk of=path/to/output Text Only ddrescue -d -r3 /dev/sda test.img test.logfile EWF tools Install EWF tools Clone a storage media locally Get metadata from EWF file For Debian and Ubuntu Text Only dd if=path/to/disk of=path/to/output For Arch, EndeavourOS and Manjaro Text Only sudo pacman -S libewf #Arch and Manjaro Text Only ewfacquire /dev/sdX Text Only ewfinfo /path/to/file Mount a storage media image / device Mount a storage media without encryption Storage media with single partition Storage media with multiple partition Unmount a storage media Text Only mount /path/to/storage/media /mnt/where/you/want First step : Retrieve the first sector number of the needed partition (a) and the sector size (b) Text Only fdisk -l /path/to/file Second step : Mount the needed partition by specifying the values found during the previous step Text Only mount -o offset=$((a*b)) /path/to/file.img /mnt First way : Unmount the folder on which the storage media is mounted Text Only umount /mnt/folder Second way : Unmount the disk itself Text Only umount /dev/sdX Mount a storage media with encryption Bitlocker (Windows) LUKS (Linux) Filevault (Mac OS X) Passphrase Key file Text Only TO DO Text Only TO DO Passphrase Key file First step : Decrypt the partition. the command will ask you a password. Text Only sudo cryptsetup luksOpen /path/to/encrypted/partition your_volume_name Second step : Mount the decrypted volume on your filesystem Text Only sudo mount /dev/mapper/your_volume_name /mnt/path/ Third step : Don't forget to close the volume after ! Text Only sudo cryptsetup luksClose your_volume_name First step : Decrypt the partition with the key file path. Text Only sudo cryptsetup luksOpen --key-file yourkeyfile.key /path/to/encrypted/partition your_volume_name Second step : Mount the decrypted volume on your filesystem Text Only sudo mount /dev/mapper/your_volume_name /mnt/path/ Third step : Don't forget to close the volume after ! Text Only sudo cryptsetup luksClose your_volume_name Tool installation Encryption key in hex format Clone the libfvde github repository. For further details regarding the installation and building of libfvde, go check this link ! Text Only git clone https://github.com/libyal/libfvde/ && cd libfvde && ./synclibs.sh Install the required packages Text Only sudo apt-get update && sudo apt-get upgrade && udo apt install git autoconf automake autopoint libtool pkg-config flex bison In the root folder of the github repository, issue the following commands : Text Only ./autogen.sh ./configure make If eveything went all, you will be able to mount filevault encrypted partition. First step : Retrieve the first sector number of the needed partition (a) and the sector size (b) Text Only fdisk -l /path/to/file Second step : Decrypt the volume by specifying the offset computed during the previous step Text Only sudo ./libfvde/fvdetools/fvdemount -k the_hex_encoded_encryption_key -o $((a*b)) your_encrypted_volume /tmp/volume Third step : Mount the decrypted volume on your filesystem Text Only sudo mount /tmp/volume /mnt/path/ Analyze a storage media image / device Analyze the storage media to gather informations Get the file system Text Only parted -m /path/to/file print | tail -n +3 | awk -F \":\" '{print $(NF-2)}' Analyze the storage media to gather files Getting the current files Getting the deleted files Text Only testdisk path/to/disk/image Text Only photorec path/to/disk/image Fixing a storage media image / device Fix the filesystem NTFS Others Text Only ntfsfix /dev/sdX Text Only sudo fsck -p /path/to/file Resources https://wiki.evolix.org/HowtoLUKS","title":"Storage media forensic"},{"location":"Digital%20forensic/Storage%20device%20forensic/Storage%20media%20forensic/#storage-media-forensic","text":"This sections aims to give generals tricks regarding the investigation of any storage media.","title":"Storage media forensic"},{"location":"Digital%20forensic/Storage%20device%20forensic/Storage%20media%20forensic/#acquire-a-storage-media-image-from-device","text":"","title":"Acquire a storage media image from device"},{"location":"Digital%20forensic/Storage%20device%20forensic/Storage%20media%20forensic/#cloning-a-storage-media","text":"DDRescue tool Install DDRescue tool Clone a storage media locally Clone a storage media through network For Debian and Ubuntu Text Only sudo apt install gddrescue # Debian and Ubuntu Text Only ddrescue -d -r3 /dev/sda test.img test.logfile Text Only ddrescue -d -r3 /dev/sda test.img test.logfile DD tool Clone a storage media locally Clone a storage media through network Text Only dd if=path/to/disk of=path/to/output Text Only ddrescue -d -r3 /dev/sda test.img test.logfile EWF tools Install EWF tools Clone a storage media locally Get metadata from EWF file For Debian and Ubuntu Text Only dd if=path/to/disk of=path/to/output For Arch, EndeavourOS and Manjaro Text Only sudo pacman -S libewf #Arch and Manjaro Text Only ewfacquire /dev/sdX Text Only ewfinfo /path/to/file","title":"Cloning a storage media"},{"location":"Digital%20forensic/Storage%20device%20forensic/Storage%20media%20forensic/#mount-a-storage-media-image-device","text":"Mount a storage media without encryption Storage media with single partition Storage media with multiple partition Unmount a storage media Text Only mount /path/to/storage/media /mnt/where/you/want First step : Retrieve the first sector number of the needed partition (a) and the sector size (b) Text Only fdisk -l /path/to/file Second step : Mount the needed partition by specifying the values found during the previous step Text Only mount -o offset=$((a*b)) /path/to/file.img /mnt First way : Unmount the folder on which the storage media is mounted Text Only umount /mnt/folder Second way : Unmount the disk itself Text Only umount /dev/sdX Mount a storage media with encryption Bitlocker (Windows) LUKS (Linux) Filevault (Mac OS X) Passphrase Key file Text Only TO DO Text Only TO DO Passphrase Key file First step : Decrypt the partition. the command will ask you a password. Text Only sudo cryptsetup luksOpen /path/to/encrypted/partition your_volume_name Second step : Mount the decrypted volume on your filesystem Text Only sudo mount /dev/mapper/your_volume_name /mnt/path/ Third step : Don't forget to close the volume after ! Text Only sudo cryptsetup luksClose your_volume_name First step : Decrypt the partition with the key file path. Text Only sudo cryptsetup luksOpen --key-file yourkeyfile.key /path/to/encrypted/partition your_volume_name Second step : Mount the decrypted volume on your filesystem Text Only sudo mount /dev/mapper/your_volume_name /mnt/path/ Third step : Don't forget to close the volume after ! Text Only sudo cryptsetup luksClose your_volume_name Tool installation Encryption key in hex format Clone the libfvde github repository. For further details regarding the installation and building of libfvde, go check this link ! Text Only git clone https://github.com/libyal/libfvde/ && cd libfvde && ./synclibs.sh Install the required packages Text Only sudo apt-get update && sudo apt-get upgrade && udo apt install git autoconf automake autopoint libtool pkg-config flex bison In the root folder of the github repository, issue the following commands : Text Only ./autogen.sh ./configure make If eveything went all, you will be able to mount filevault encrypted partition. First step : Retrieve the first sector number of the needed partition (a) and the sector size (b) Text Only fdisk -l /path/to/file Second step : Decrypt the volume by specifying the offset computed during the previous step Text Only sudo ./libfvde/fvdetools/fvdemount -k the_hex_encoded_encryption_key -o $((a*b)) your_encrypted_volume /tmp/volume Third step : Mount the decrypted volume on your filesystem Text Only sudo mount /tmp/volume /mnt/path/","title":"Mount a storage media image / device"},{"location":"Digital%20forensic/Storage%20device%20forensic/Storage%20media%20forensic/#analyze-a-storage-media-image-device","text":"Analyze the storage media to gather informations Get the file system Text Only parted -m /path/to/file print | tail -n +3 | awk -F \":\" '{print $(NF-2)}' Analyze the storage media to gather files Getting the current files Getting the deleted files Text Only testdisk path/to/disk/image Text Only photorec path/to/disk/image","title":"Analyze a storage media image / device"},{"location":"Digital%20forensic/Storage%20device%20forensic/Storage%20media%20forensic/#fixing-a-storage-media-image-device","text":"Fix the filesystem NTFS Others Text Only ntfsfix /dev/sdX Text Only sudo fsck -p /path/to/file","title":"Fixing a storage media image / device"},{"location":"Digital%20forensic/Storage%20device%20forensic/Storage%20media%20forensic/#resources","text":"https://wiki.evolix.org/HowtoLUKS","title":"Resources"},{"location":"Environment%20setup/Local%20lab%20setup/","text":"Local lab setup The aim of this page is to help you configure your own local forensic lab for forensic purposes. For security reasons, this local lab should only be accessible from your host and virtual machines. WARNING ! Please note that the configuration explained here is unsafe for the studies of malware programs ! Use this configuration at your own risk, I am not responsible for any misuses and damage done to your computer. This page will help you configure your computer to get the following functionalities for your host and virtual machines : Local website which hosts severals services and resources such as Cyberchef, PDF documents... Local FTP server which allow you to easily transfer files between virtual machines Installation First, update your system with these commands : Text Only sudo apt update && sudo apt upgrade # For ubuntu and debian sudo pacman -Syu # For arch based system Then, install the following softwares on your pc : Text Only sudo apt install vsftpd nginx dnsmasq #Ubuntu and Debian system yay -S vsftpd nginx dnsmasq #For arch based systems sudo pacman -S vsftd nginx dnsmasq #Alternative for arch based system Now that you have installed the required software, we can now configure them Configuration DNSmasq The aim of this section is to configure the DNS server so you can access your own offline lab without using an IP address. The first step is to get the IP address of the host machine. Use the following command and spot the virtual network interface : Text Only ifconfig #First command ip addr show #Second command Note the IP address you found, you will use it later. Now that we have our own IP address, we can configure the dnsmasq service. Open the configuration file /etc/dnsmasq.conf and add the following line to the end : Text Only bind-interfaces # Put here the DNS server of your choice server=1.1.1.1 log-queries # does not go upstream to resolve addresses ending in 'your-domain.lab' local=/your-domain.lab/ Then change the configuration of the file /etc/resolv.conf to use dnsmasq to resolve address by changing this line : Text Only nameserver 127.0.0.1 And don't forget to add your domain name in the /etc/hosts file : Text Only your_libvirt_ip_address your_domain.lab You should now be able to access your own local lab by using the domain name you choose. WEB server Home page The first step we're going to do is to configure the WEB server so it can host our services. The default public location of nginx is /usr/share/nginx/html . You can use the following source code to replace the default file index.html : HTML <!DOCTYPE html> < html > < head > < title > Home lab </ title > < link rel = \"stylesheet\" href = \"style.css\" > </ head > < body > < h1 > Welcome ! </ h1 > < p > Choose the service you want to access </ p > < table > < thead > < tr > < th colspan = \"2\" > Resources link </ th > </ tr > </ thead > < tbody > < tr > < td >< a href = \"http://localhost/\" > Home </ a ></ td > < td > Repertoire de base </ td > </ tr > < tr > < td >< a href = \"http://localhost/\" > Resource N\u00b0 1 </ a ></ td > < td > Lorem Ipsum </ td > </ tr > < tr > < td >< a href = \"http://localhost/\" > Resource N\u00b0 2 </ a ></ td > < td > Lorem Ipsum </ td > </ tr > < tr > < td >< a href = \"http://localhost/\" > Resource N\u00b0 2 </ a ></ td > < td > Lorem Ipsum </ td > </ tr > </ tbody > </ table > < br > < p >< em > Created by YOUR_NAME, local usage only. </ em ></ p > </ body > </ html > Feel free to add rows to the table to add your own resources. Enable directory listing To enable directory listing in nginx, you need to configure the configuration file /etc/nginx/nginx.conf and add these lines within the 'server' location. Text Only location / { root /usr/share/nginx/html; index index.html index.htm; } Don't forget to restart nginx with this command : Text Only sudo systemctl restart nginx And you should be able to brose the directory within the web server. Add services Now that your web server is configured, you can add the services of your choice. Personally, I choose to install cyberchef on my own lab. Cyberchef To install Cyberchef on your local web server, create a new directory called cyberchef in /usr/share/nginx/html . Once it's done, you can download the latest release of cyberchef and unzip the file content within the cyberchef directory. Don't forget to rename the html file to index.html and you should be able to use cyberchef on your own PC offline through the web server. Add whatever you want From now on, you should have a fully functionnal web server. Based on your needs and occupations, why not install on the web server, services you think are essential to you ? The choice is yours ! FTP server The aim of this section is to help you deploy a FTP server to easily transfer files between your virtual and host machine. Locate the root folder of your service The first step is to locate the folder of the FTP server. In my case, it is /var/ftp/pub . Create an user for the FTPuser Text Only sudo useradd -md /var/ftp/pub ftpuser #Create a user called ftpuser and set its home directory in /var/ftp/pub sudo passwd ftpuser #Add a password to the account sudo mkdir /var/ftp/pub/home #Create a folder called home in the path /var/ftp/pub Now that the user is created, we can now configure the FTP server : Configure the vsftpd service Locate and modify the file /etc/vsftpd.conf . Make sure that the following lines are configured in the same fashion on your side : Text Only #Disable anonymous login anonymous_enable=NO #Allow local user to connect to the servers local_enable=YES # Uncomment this to enable any form of FTP write command. write_enable=YES #Enable writing in the folders # Activate directory messages - messages given to remote users when they # go into a certain directory. #messages given to remote users when they go into a certain directory. dirmessage_enable=YES # Activate logging of uploads/downloads. xferlog_enable=YES # Make sure PORT transfer connections originate from port 20 (ftp-data). connect_from_port_20=YES # Add a banner when a user connects on the FTP server: banner_file=/var/ftp/banner #Force local user to stay within the folder they connected in chroot_local_user=YES # Listen for IPv4 sockets listen=YES # Set own PAM service name to detect authentication settings specified # for vsftpd by the system package. pam_service_name=vsftpd # Make sure that the folder designated in 'local_root' directive is not writable local_root=/var/ftp/pub #Minimum port for creating passive connections pasv_min_port=40000 #Maximum port for creating passive connections pasv_max_port=50000 # Create a whitelist of users which can access the ftp server userlist_enable=YES #Don't forget to create the file mentionned in the directive 'userlist_file' #and to add the user created earlier in it ! userlist_file=/etc/vsftpd.userlist userlist_deny=NO #Disable SELinux for vsftpd to avoid bugs seccomp_sandbox=NO # Permissions applicated to any files and folder uploaded on the server. file_open_mode=0777 # Remove executions rights from the uploaded folders and files local_umask=0011 Create the banner Use the following commands to create the banner which will be used by the server Text Only sudo touch /var/ftp/banner sudo nano /var/ftp/banner #Write whatever you want in this file Create the userlist Use the following commands to create the userlist which will be used by the server Text Only sudo touch /etc/vsftpd.userlist echo /etc/vsftpd.userlist Configure the permissions Text Only sudo chown ftpuser:ftpuser -R /var/ftp/pub/home sudo chmod 777 -R /var/ftp/pub/home sudo chmod 555 /var/ftp/pub #Disable write access for anyone in the path /var/ftp/pub Launching the service Text Only sudo systemctl enable vsftpd #Allow the service vsftp to start on the machine startup sudo systemctl disable vsftpd #Allow the service vsftp to start on the machine startup sudo systemctl restart vsftpd #Restart the vsftpd service after you change its configuration If everything went well, you should have access to a fully functional FTP service on which you can upload anything you want ! Accessing your local FTP server Personnaly, I decided to use the FTP client called Filezilla . It is free, under GNU/GPL license and can be installed on any platforms such as Windows, Linux... Just download the software from the official website, install it on your virtual machines and you're good to go ! Firewall Configuration of the firewall Before you can access your services, make sure that the firewall installed on your PC allows any connections from the virtual machines to your host machine. You just need to open the ports 80,20,21 and the range 40000-50000 on your host machine and you should be fine. Troubleshooting Network I can't access any of my services ! Please verify the following points : - Make sure that the service you want to access is running - Make sure that the firewall doesn't block incoming and outgoing connections on the host machine - Make sure that the firewall configuration is persistent, even after the restart of the host machine FTP server I don't have access to the uploaded files and folder from my host machine with my main account ! Run this command to add your main account in the same group as the user used for the ftp server : Text Only sudo usermod -a -G ftpuser $(whoami) From now on, you should have access to all files and folder which will be created in the path /var/ftp/pub/home directory.","title":"Local lab setup"},{"location":"Environment%20setup/Local%20lab%20setup/#local-lab-setup","text":"The aim of this page is to help you configure your own local forensic lab for forensic purposes. For security reasons, this local lab should only be accessible from your host and virtual machines. WARNING ! Please note that the configuration explained here is unsafe for the studies of malware programs ! Use this configuration at your own risk, I am not responsible for any misuses and damage done to your computer. This page will help you configure your computer to get the following functionalities for your host and virtual machines : Local website which hosts severals services and resources such as Cyberchef, PDF documents... Local FTP server which allow you to easily transfer files between virtual machines","title":"Local lab setup"},{"location":"Environment%20setup/Local%20lab%20setup/#installation","text":"First, update your system with these commands : Text Only sudo apt update && sudo apt upgrade # For ubuntu and debian sudo pacman -Syu # For arch based system Then, install the following softwares on your pc : Text Only sudo apt install vsftpd nginx dnsmasq #Ubuntu and Debian system yay -S vsftpd nginx dnsmasq #For arch based systems sudo pacman -S vsftd nginx dnsmasq #Alternative for arch based system Now that you have installed the required software, we can now configure them","title":"Installation"},{"location":"Environment%20setup/Local%20lab%20setup/#configuration","text":"","title":"Configuration"},{"location":"Environment%20setup/Local%20lab%20setup/#dnsmasq","text":"The aim of this section is to configure the DNS server so you can access your own offline lab without using an IP address. The first step is to get the IP address of the host machine. Use the following command and spot the virtual network interface : Text Only ifconfig #First command ip addr show #Second command Note the IP address you found, you will use it later. Now that we have our own IP address, we can configure the dnsmasq service. Open the configuration file /etc/dnsmasq.conf and add the following line to the end : Text Only bind-interfaces # Put here the DNS server of your choice server=1.1.1.1 log-queries # does not go upstream to resolve addresses ending in 'your-domain.lab' local=/your-domain.lab/ Then change the configuration of the file /etc/resolv.conf to use dnsmasq to resolve address by changing this line : Text Only nameserver 127.0.0.1 And don't forget to add your domain name in the /etc/hosts file : Text Only your_libvirt_ip_address your_domain.lab You should now be able to access your own local lab by using the domain name you choose.","title":"DNSmasq"},{"location":"Environment%20setup/Local%20lab%20setup/#web-server","text":"","title":"WEB server"},{"location":"Environment%20setup/Local%20lab%20setup/#home-page","text":"The first step we're going to do is to configure the WEB server so it can host our services. The default public location of nginx is /usr/share/nginx/html . You can use the following source code to replace the default file index.html : HTML <!DOCTYPE html> < html > < head > < title > Home lab </ title > < link rel = \"stylesheet\" href = \"style.css\" > </ head > < body > < h1 > Welcome ! </ h1 > < p > Choose the service you want to access </ p > < table > < thead > < tr > < th colspan = \"2\" > Resources link </ th > </ tr > </ thead > < tbody > < tr > < td >< a href = \"http://localhost/\" > Home </ a ></ td > < td > Repertoire de base </ td > </ tr > < tr > < td >< a href = \"http://localhost/\" > Resource N\u00b0 1 </ a ></ td > < td > Lorem Ipsum </ td > </ tr > < tr > < td >< a href = \"http://localhost/\" > Resource N\u00b0 2 </ a ></ td > < td > Lorem Ipsum </ td > </ tr > < tr > < td >< a href = \"http://localhost/\" > Resource N\u00b0 2 </ a ></ td > < td > Lorem Ipsum </ td > </ tr > </ tbody > </ table > < br > < p >< em > Created by YOUR_NAME, local usage only. </ em ></ p > </ body > </ html > Feel free to add rows to the table to add your own resources.","title":"Home page"},{"location":"Environment%20setup/Local%20lab%20setup/#enable-directory-listing","text":"To enable directory listing in nginx, you need to configure the configuration file /etc/nginx/nginx.conf and add these lines within the 'server' location. Text Only location / { root /usr/share/nginx/html; index index.html index.htm; } Don't forget to restart nginx with this command : Text Only sudo systemctl restart nginx And you should be able to brose the directory within the web server.","title":"Enable directory listing"},{"location":"Environment%20setup/Local%20lab%20setup/#add-services","text":"Now that your web server is configured, you can add the services of your choice. Personally, I choose to install cyberchef on my own lab.","title":"Add services"},{"location":"Environment%20setup/Local%20lab%20setup/#cyberchef","text":"To install Cyberchef on your local web server, create a new directory called cyberchef in /usr/share/nginx/html . Once it's done, you can download the latest release of cyberchef and unzip the file content within the cyberchef directory. Don't forget to rename the html file to index.html and you should be able to use cyberchef on your own PC offline through the web server.","title":"Cyberchef"},{"location":"Environment%20setup/Local%20lab%20setup/#add-whatever-you-want","text":"From now on, you should have a fully functionnal web server. Based on your needs and occupations, why not install on the web server, services you think are essential to you ? The choice is yours !","title":"Add whatever you want"},{"location":"Environment%20setup/Local%20lab%20setup/#ftp-server","text":"The aim of this section is to help you deploy a FTP server to easily transfer files between your virtual and host machine.","title":"FTP server"},{"location":"Environment%20setup/Local%20lab%20setup/#locate-the-root-folder-of-your-service","text":"The first step is to locate the folder of the FTP server. In my case, it is /var/ftp/pub .","title":"Locate the root folder of your service"},{"location":"Environment%20setup/Local%20lab%20setup/#create-an-user-for-the-ftpuser","text":"Text Only sudo useradd -md /var/ftp/pub ftpuser #Create a user called ftpuser and set its home directory in /var/ftp/pub sudo passwd ftpuser #Add a password to the account sudo mkdir /var/ftp/pub/home #Create a folder called home in the path /var/ftp/pub Now that the user is created, we can now configure the FTP server :","title":"Create an user for the FTPuser"},{"location":"Environment%20setup/Local%20lab%20setup/#configure-the-vsftpd-service","text":"Locate and modify the file /etc/vsftpd.conf . Make sure that the following lines are configured in the same fashion on your side : Text Only #Disable anonymous login anonymous_enable=NO #Allow local user to connect to the servers local_enable=YES # Uncomment this to enable any form of FTP write command. write_enable=YES #Enable writing in the folders # Activate directory messages - messages given to remote users when they # go into a certain directory. #messages given to remote users when they go into a certain directory. dirmessage_enable=YES # Activate logging of uploads/downloads. xferlog_enable=YES # Make sure PORT transfer connections originate from port 20 (ftp-data). connect_from_port_20=YES # Add a banner when a user connects on the FTP server: banner_file=/var/ftp/banner #Force local user to stay within the folder they connected in chroot_local_user=YES # Listen for IPv4 sockets listen=YES # Set own PAM service name to detect authentication settings specified # for vsftpd by the system package. pam_service_name=vsftpd # Make sure that the folder designated in 'local_root' directive is not writable local_root=/var/ftp/pub #Minimum port for creating passive connections pasv_min_port=40000 #Maximum port for creating passive connections pasv_max_port=50000 # Create a whitelist of users which can access the ftp server userlist_enable=YES #Don't forget to create the file mentionned in the directive 'userlist_file' #and to add the user created earlier in it ! userlist_file=/etc/vsftpd.userlist userlist_deny=NO #Disable SELinux for vsftpd to avoid bugs seccomp_sandbox=NO # Permissions applicated to any files and folder uploaded on the server. file_open_mode=0777 # Remove executions rights from the uploaded folders and files local_umask=0011","title":"Configure the vsftpd service"},{"location":"Environment%20setup/Local%20lab%20setup/#create-the-banner","text":"Use the following commands to create the banner which will be used by the server Text Only sudo touch /var/ftp/banner sudo nano /var/ftp/banner #Write whatever you want in this file","title":"Create the banner"},{"location":"Environment%20setup/Local%20lab%20setup/#create-the-userlist","text":"Use the following commands to create the userlist which will be used by the server Text Only sudo touch /etc/vsftpd.userlist echo /etc/vsftpd.userlist","title":"Create the userlist"},{"location":"Environment%20setup/Local%20lab%20setup/#configure-the-permissions","text":"Text Only sudo chown ftpuser:ftpuser -R /var/ftp/pub/home sudo chmod 777 -R /var/ftp/pub/home sudo chmod 555 /var/ftp/pub #Disable write access for anyone in the path /var/ftp/pub","title":"Configure the permissions"},{"location":"Environment%20setup/Local%20lab%20setup/#launching-the-service","text":"Text Only sudo systemctl enable vsftpd #Allow the service vsftp to start on the machine startup sudo systemctl disable vsftpd #Allow the service vsftp to start on the machine startup sudo systemctl restart vsftpd #Restart the vsftpd service after you change its configuration If everything went well, you should have access to a fully functional FTP service on which you can upload anything you want !","title":"Launching the service"},{"location":"Environment%20setup/Local%20lab%20setup/#accessing-your-local-ftp-server","text":"Personnaly, I decided to use the FTP client called Filezilla . It is free, under GNU/GPL license and can be installed on any platforms such as Windows, Linux... Just download the software from the official website, install it on your virtual machines and you're good to go !","title":"Accessing your local FTP server"},{"location":"Environment%20setup/Local%20lab%20setup/#firewall","text":"","title":"Firewall"},{"location":"Environment%20setup/Local%20lab%20setup/#configuration-of-the-firewall","text":"Before you can access your services, make sure that the firewall installed on your PC allows any connections from the virtual machines to your host machine. You just need to open the ports 80,20,21 and the range 40000-50000 on your host machine and you should be fine.","title":"Configuration of the firewall"},{"location":"Environment%20setup/Local%20lab%20setup/#troubleshooting","text":"","title":"Troubleshooting"},{"location":"Environment%20setup/Local%20lab%20setup/#network","text":"","title":"Network"},{"location":"Environment%20setup/Local%20lab%20setup/#i-cant-access-any-of-my-services","text":"Please verify the following points : - Make sure that the service you want to access is running - Make sure that the firewall doesn't block incoming and outgoing connections on the host machine - Make sure that the firewall configuration is persistent, even after the restart of the host machine","title":"I can't access any of my services !"},{"location":"Environment%20setup/Local%20lab%20setup/#ftp-server_1","text":"","title":"FTP server"},{"location":"Environment%20setup/Local%20lab%20setup/#i-dont-have-access-to-the-uploaded-files-and-folder-from-my-host-machine-with-my-main-account","text":"Run this command to add your main account in the same group as the user used for the ftp server : Text Only sudo usermod -a -G ftpuser $(whoami) From now on, you should have access to all files and folder which will be created in the path /var/ftp/pub/home directory.","title":"I don't have access to the uploaded files and folder from my host machine with my main account !"},{"location":"Environment%20setup/Toolbag%20setup/","text":"Toolbag setup This page aims to give tricks regarding the physical equipment you might need to buy if you want to realize forensic investigation. Please note that I'm not affiliated to any trademarks, this reflects only my own choices and opinions. Choosing the right tools Miscellaneous tools Tools for storage media Tools for flash memory media Here's the different flash memory media you might encounter during your investigation : Tools for hard drive media What is the size of your hard drive ? Here's the list of possible size you might encounter during your investigation. 3.5 inches (Need additionnal power) 2.5 inches (Don't need additionnal power) Here's an example of two hard drives. What is the connection of your hard drive ? Here's the list of possible connection you might encounter during your investigation. SATA connection 3.5 IDE connection with molex-DP4 connection for power 2.5 IDE connection Here's an example of the differents connection. How to read the hard drive Tools for any electronic devices Tools for any other storage media Tools for data acquisition My recommendation is that you have an hard drive with a very large capacity to be able to retrieve data properly from hard drive and RAM memory. At least 4TB hard drive are recommended for this purpose. Memory acquisition Storage media cloning Tools for booting up on another distro Choosing the right bag Take-away list Personnally, here is the full content of my toolbag : Miscellaneous Latex gloves Pen and pencil Notebook Paper tag Multitool Light torch Charger cable with multiple output (USB-C, Lightning, Micro-USB) pliers Storage media Flash memory Adapter 20 in 1 for memory cards SD, Mini SD and micro sd to USB-A adapter Hard drive Adapter for hard drive (From 2.5, 3.5 SATA and IDE Hard drive to USB-A male) 3.5 inches Hard drive case with a 4TB hard drive Any electronic devices USB-C cable Lightning cable Micro-USB cable USB cable extender A set of adapter : USB-A \u2192 USB-C Lightning \u2192 USB-C USB-C \u2192 Lightning USB-C \u2192 USB-A Any other storage media Blu-ray, DVD, CD-Rom writer and reader to USB-A adapter Appendix Flash memory format USB-A storage key USB-C storage key Lightning storage key Micro-USB storage key Memory stick card Memory Stick PRO-HG Duo Memory Stick PRO Duo Memory Stick PRO-HG Memory Stick PRO Memory Stick Duo Memory Stick Micro (M2) Memory Stick Pro CompactFlash (CF) micro memory card Secure digital (SD) memory card Secure Digital High Capacity (SDHC) memory card Secure Digital Extended Capacity (SDXC) memory card Mini-SD memory card MiniSDHC memory card Micro-SD memory card Micro-SD High Capacity (MicroSDHC) memory card Micro-SD Extended Capacity (MicroSDXC) memory card Extreme Digital (xD) Picture Card memory card Compact Flash CompactFlash I CompactFlash II Reduced-Size MultiMediaCard (RS-MMC) Olympus DC card M2 memory card","title":"Toolbag setup"},{"location":"Environment%20setup/Toolbag%20setup/#toolbag-setup","text":"This page aims to give tricks regarding the physical equipment you might need to buy if you want to realize forensic investigation. Please note that I'm not affiliated to any trademarks, this reflects only my own choices and opinions.","title":"Toolbag setup"},{"location":"Environment%20setup/Toolbag%20setup/#choosing-the-right-tools","text":"","title":"Choosing the right tools"},{"location":"Environment%20setup/Toolbag%20setup/#miscellaneous-tools","text":"","title":"Miscellaneous tools"},{"location":"Environment%20setup/Toolbag%20setup/#tools-for-storage-media","text":"","title":"Tools for storage media"},{"location":"Environment%20setup/Toolbag%20setup/#tools-for-flash-memory-media","text":"Here's the different flash memory media you might encounter during your investigation :","title":"Tools for flash memory media"},{"location":"Environment%20setup/Toolbag%20setup/#tools-for-hard-drive-media","text":"","title":"Tools for hard drive media"},{"location":"Environment%20setup/Toolbag%20setup/#what-is-the-size-of-your-hard-drive","text":"Here's the list of possible size you might encounter during your investigation. 3.5 inches (Need additionnal power) 2.5 inches (Don't need additionnal power) Here's an example of two hard drives.","title":"What is the size of your hard drive ?"},{"location":"Environment%20setup/Toolbag%20setup/#what-is-the-connection-of-your-hard-drive","text":"Here's the list of possible connection you might encounter during your investigation. SATA connection 3.5 IDE connection with molex-DP4 connection for power 2.5 IDE connection Here's an example of the differents connection.","title":"What is the connection of your hard drive ?"},{"location":"Environment%20setup/Toolbag%20setup/#how-to-read-the-hard-drive","text":"","title":"How to read the hard drive"},{"location":"Environment%20setup/Toolbag%20setup/#tools-for-any-electronic-devices","text":"","title":"Tools for any electronic devices"},{"location":"Environment%20setup/Toolbag%20setup/#tools-for-any-other-storage-media","text":"","title":"Tools for any other storage media"},{"location":"Environment%20setup/Toolbag%20setup/#tools-for-data-acquisition","text":"My recommendation is that you have an hard drive with a very large capacity to be able to retrieve data properly from hard drive and RAM memory. At least 4TB hard drive are recommended for this purpose.","title":"Tools for data acquisition"},{"location":"Environment%20setup/Toolbag%20setup/#memory-acquisition","text":"","title":"Memory acquisition"},{"location":"Environment%20setup/Toolbag%20setup/#storage-media-cloning","text":"","title":"Storage media cloning"},{"location":"Environment%20setup/Toolbag%20setup/#tools-for-booting-up-on-another-distro","text":"","title":"Tools for booting up on another distro"},{"location":"Environment%20setup/Toolbag%20setup/#choosing-the-right-bag","text":"","title":"Choosing the right bag"},{"location":"Environment%20setup/Toolbag%20setup/#take-away-list","text":"Personnally, here is the full content of my toolbag :","title":"Take-away list"},{"location":"Environment%20setup/Toolbag%20setup/#miscellaneous","text":"Latex gloves Pen and pencil Notebook Paper tag Multitool Light torch Charger cable with multiple output (USB-C, Lightning, Micro-USB) pliers","title":"Miscellaneous"},{"location":"Environment%20setup/Toolbag%20setup/#storage-media","text":"","title":"Storage media"},{"location":"Environment%20setup/Toolbag%20setup/#flash-memory","text":"Adapter 20 in 1 for memory cards SD, Mini SD and micro sd to USB-A adapter","title":"Flash memory"},{"location":"Environment%20setup/Toolbag%20setup/#hard-drive","text":"Adapter for hard drive (From 2.5, 3.5 SATA and IDE Hard drive to USB-A male) 3.5 inches Hard drive case with a 4TB hard drive","title":"Hard drive"},{"location":"Environment%20setup/Toolbag%20setup/#any-electronic-devices","text":"USB-C cable Lightning cable Micro-USB cable USB cable extender A set of adapter : USB-A \u2192 USB-C Lightning \u2192 USB-C USB-C \u2192 Lightning USB-C \u2192 USB-A","title":"Any electronic devices"},{"location":"Environment%20setup/Toolbag%20setup/#any-other-storage-media","text":"Blu-ray, DVD, CD-Rom writer and reader to USB-A adapter","title":"Any other storage media"},{"location":"Environment%20setup/Toolbag%20setup/#appendix","text":"","title":"Appendix"},{"location":"Environment%20setup/Toolbag%20setup/#flash-memory-format","text":"USB-A storage key USB-C storage key Lightning storage key Micro-USB storage key Memory stick card Memory Stick PRO-HG Duo Memory Stick PRO Duo Memory Stick PRO-HG Memory Stick PRO Memory Stick Duo Memory Stick Micro (M2) Memory Stick Pro CompactFlash (CF) micro memory card Secure digital (SD) memory card Secure Digital High Capacity (SDHC) memory card Secure Digital Extended Capacity (SDXC) memory card Mini-SD memory card MiniSDHC memory card Micro-SD memory card Micro-SD High Capacity (MicroSDHC) memory card Micro-SD Extended Capacity (MicroSDXC) memory card Extreme Digital (xD) Picture Card memory card Compact Flash CompactFlash I CompactFlash II Reduced-Size MultiMediaCard (RS-MMC) Olympus DC card M2 memory card","title":"Flash memory format"},{"location":"Environment%20setup/Volatility%20setup/","text":"Volatility 2 and 3 setup The aim of this pages is to give tips and tricks regarding the installation and setup of Volatility 2 and 3. Install Volatility Volatility 2 Volatility 3 Get custom existing volatility profile and symbols Precompiled memory profile and symbols Volatility 2 Here's a list of repo on which you can find precompiled memory profile for volatility2 |Description|Link| |-|-| |Volatility2 symbols from Podalirius| Link | |Volatlity2 Compilation of volatility2 profiles by volatility foundation| Link | Volatility 3 Here's a list of repo on which you can find precompiled symbols for volatility3 |Description|Link| |-|-| |Volatility3 symbols from Podalirius| Link | |Isf server from techanarchy| Link | |Volatility 3 symboles tables| Link | Creating you own memory profile and symbols Windows Volatility2 and 3 comes with a lot of prebuilts profiles and symbols for Windows Mac OS X Volatility2 You can find pre-builts volatility profile on this link : https://github.com/volatilityfoundation/profiles Volatility3 Linux Volatility2 Create a virtual machine to build symbols or a memory profile Text Only gunzip QEMU_EFI.img.gz qemu-img create -f qcow2 debian.img 128G qemu-img create -f qcow2 varstore.img 64M qemu-system-aarch64 \\ -cpu cortex-a53 -M virt -m 4096 \\ -drive if=pflash,format=raw,file=QEMU_EFI.img \\ -drive if=pflash,file=varstore.img \\ -drive if=virtio,file=debian.img \\ -drive if=virtio,format=raw,file=ubuntu-18.04.6-server-arm64.iso qemu-system-aarch64 \\ -cpu host -M virt,accel=kvm -m 4096 -nographic \\ -kernel arch/arm64/boot/Image -append root=/dev/vda2 \\ -drive if=virtio,file=debian.img Android https://github.com/SorCelien/CTF-WRITEUPS/blob/main/FCSC-2021/forensics/ordiphone-1.md Bash mkdir ~/android-kernel && cd ~/android-kernel repo init -u https://android.googlesource.com/kernel/manifest - kernel_version repo sync -c -j8 BUILD_CONFIG = common/build.config.gki.x86_64 build/build.sh Troubleshooting Stuck on \"LTO vmlinux.o\" during kernel compile There is not enough memory allocated to the compiler during link of vmlinux.o file. Create a swapfile to allocate more memory by using these commands Text Only sudo -i #Become root dd if=/dev/zero of=/path/swapfile bs=1G count=size_of_swapfile status=progress #Create swap file chmod 600 /path/swapfile #Modify permissions so only root can use it mkswap /path/swapfile #Make the file a swap file swapon /path/swapfile #Enable the swap file cat /proc/swaps # Check that the swapfile is indeed used by system echo \"/path/swapfile none swap sw 0 0\" >> /etc/fstab Configure volatility 2 and 3 to use them Adding a custom memory profile or symbols Volatility 2 Once you found the appropriate memory profile for your investigation, you need to setup Volatility2 in order to use it. Here's the following steps to do this. 1) Volatility 3 Once you found the appropriate symbols for your memory dump, you need to setup Volatility3 in order to use it. Here's the following steps to do this. 1) Resources https://source.android.com/docs/setup/build/building-kernels https://github.com/volatilityfoundation/volatility/wiki/Androiddir https://unix.stackexchange.com/questions/238783/how-can-i-create-a-swap-file","title":"Volatility 2 and 3 setup"},{"location":"Environment%20setup/Volatility%20setup/#volatility-2-and-3-setup","text":"The aim of this pages is to give tips and tricks regarding the installation and setup of Volatility 2 and 3.","title":"Volatility 2 and 3 setup"},{"location":"Environment%20setup/Volatility%20setup/#install-volatility","text":"","title":"Install Volatility"},{"location":"Environment%20setup/Volatility%20setup/#volatility-2","text":"","title":"Volatility 2"},{"location":"Environment%20setup/Volatility%20setup/#volatility-3","text":"","title":"Volatility 3"},{"location":"Environment%20setup/Volatility%20setup/#get-custom-existing-volatility-profile-and-symbols","text":"","title":"Get custom existing volatility profile and symbols"},{"location":"Environment%20setup/Volatility%20setup/#precompiled-memory-profile-and-symbols","text":"","title":"Precompiled memory profile and symbols"},{"location":"Environment%20setup/Volatility%20setup/#volatility-2_1","text":"Here's a list of repo on which you can find precompiled memory profile for volatility2 |Description|Link| |-|-| |Volatility2 symbols from Podalirius| Link | |Volatlity2 Compilation of volatility2 profiles by volatility foundation| Link |","title":"Volatility 2"},{"location":"Environment%20setup/Volatility%20setup/#volatility-3_1","text":"Here's a list of repo on which you can find precompiled symbols for volatility3 |Description|Link| |-|-| |Volatility3 symbols from Podalirius| Link | |Isf server from techanarchy| Link | |Volatility 3 symboles tables| Link |","title":"Volatility 3"},{"location":"Environment%20setup/Volatility%20setup/#creating-you-own-memory-profile-and-symbols","text":"","title":"Creating you own memory profile and symbols"},{"location":"Environment%20setup/Volatility%20setup/#windows","text":"Volatility2 and 3 comes with a lot of prebuilts profiles and symbols for Windows","title":"Windows"},{"location":"Environment%20setup/Volatility%20setup/#mac-os-x","text":"","title":"Mac OS X"},{"location":"Environment%20setup/Volatility%20setup/#volatility2","text":"You can find pre-builts volatility profile on this link : https://github.com/volatilityfoundation/profiles","title":"Volatility2"},{"location":"Environment%20setup/Volatility%20setup/#volatility3","text":"","title":"Volatility3"},{"location":"Environment%20setup/Volatility%20setup/#linux","text":"","title":"Linux"},{"location":"Environment%20setup/Volatility%20setup/#volatility2_1","text":"","title":"Volatility2"},{"location":"Environment%20setup/Volatility%20setup/#create-a-virtual-machine-to-build-symbols-or-a-memory-profile","text":"Text Only gunzip QEMU_EFI.img.gz qemu-img create -f qcow2 debian.img 128G qemu-img create -f qcow2 varstore.img 64M qemu-system-aarch64 \\ -cpu cortex-a53 -M virt -m 4096 \\ -drive if=pflash,format=raw,file=QEMU_EFI.img \\ -drive if=pflash,file=varstore.img \\ -drive if=virtio,file=debian.img \\ -drive if=virtio,format=raw,file=ubuntu-18.04.6-server-arm64.iso qemu-system-aarch64 \\ -cpu host -M virt,accel=kvm -m 4096 -nographic \\ -kernel arch/arm64/boot/Image -append root=/dev/vda2 \\ -drive if=virtio,file=debian.img","title":"Create a virtual machine to build symbols or a memory profile"},{"location":"Environment%20setup/Volatility%20setup/#android","text":"https://github.com/SorCelien/CTF-WRITEUPS/blob/main/FCSC-2021/forensics/ordiphone-1.md Bash mkdir ~/android-kernel && cd ~/android-kernel repo init -u https://android.googlesource.com/kernel/manifest - kernel_version repo sync -c -j8 BUILD_CONFIG = common/build.config.gki.x86_64 build/build.sh","title":"Android"},{"location":"Environment%20setup/Volatility%20setup/#troubleshooting","text":"","title":"Troubleshooting"},{"location":"Environment%20setup/Volatility%20setup/#stuck-on-lto-vmlinuxo-during-kernel-compile","text":"There is not enough memory allocated to the compiler during link of vmlinux.o file. Create a swapfile to allocate more memory by using these commands Text Only sudo -i #Become root dd if=/dev/zero of=/path/swapfile bs=1G count=size_of_swapfile status=progress #Create swap file chmod 600 /path/swapfile #Modify permissions so only root can use it mkswap /path/swapfile #Make the file a swap file swapon /path/swapfile #Enable the swap file cat /proc/swaps # Check that the swapfile is indeed used by system echo \"/path/swapfile none swap sw 0 0\" >> /etc/fstab","title":"Stuck on \"LTO vmlinux.o\" during kernel compile"},{"location":"Environment%20setup/Volatility%20setup/#configure-volatility-2-and-3-to-use-them","text":"","title":"Configure volatility 2 and 3 to use them"},{"location":"Environment%20setup/Volatility%20setup/#adding-a-custom-memory-profile-or-symbols","text":"","title":"Adding a custom memory profile or symbols"},{"location":"Environment%20setup/Volatility%20setup/#volatility-2_2","text":"Once you found the appropriate memory profile for your investigation, you need to setup Volatility2 in order to use it. Here's the following steps to do this. 1)","title":"Volatility 2"},{"location":"Environment%20setup/Volatility%20setup/#volatility-3_2","text":"Once you found the appropriate symbols for your memory dump, you need to setup Volatility3 in order to use it. Here's the following steps to do this. 1)","title":"Volatility 3"},{"location":"Environment%20setup/Volatility%20setup/#resources","text":"https://source.android.com/docs/setup/build/building-kernels https://github.com/volatilityfoundation/volatility/wiki/Androiddir https://unix.stackexchange.com/questions/238783/how-can-i-create-a-swap-file","title":"Resources"},{"location":"Environment%20setup/Workstation%20setup/","text":"Workstation setup This page aims to give instructions to help you setup a forensic workstation. Regarding the configuration of your forensic workstation, you have two choices. The first one is using an existant distro tuned from Vanilla Debian, Ubuntu OS or create your own distro from scratch. Please consult the right section based on your needs. Using an existant distro Using an existant distro can be very useful if you want to setup a forensic workstation as a VM. You can find on the following table, the existing distro for the forensic world. Linux Here is a list of distros based on Linux to meet forensic needs. Linux OS for forensic and reverse engineering purposes Name Description OS Link Tsuguri Forensic distro which includes popular forensic and OSINT tools. Best run as an installed OS Based on Ubuntu Tsuguri-linux PALADIN Forensic distro which aims to provide tools for disk imaging and data viewer. Best run as a live session. Based on Ubuntu Sumuri CAINE Forensic distro which aims to provide basic forensic tools like Autopsy, testdisk, phororec... Both ways are fine with this OS. Based on Ubuntu CAINE GRML Forensic distro which aims to provide basic forensic tools for disk imaging. Best run as a live session Based on Grml Linux live which is itself based on Debian GRML Forensic Renmux Linux distro dedicated to reverse-engineering. Best run as an installed OS. Base on Ubuntu Renmux Challenger OS Data recovery distro which aims to provide rescue tools to save data from disk. Best run as an installed OS. Based on slackware ChallengerOS DEFT Zero Forensic distro which aims to provide basic forensic tools like Autopsy, testdisk, photorec... Both ways are fine with this OS REDACTED Discontinued Trace Labs VM Kali Linux OS tuned to suit OSINT purposes Based on Kali Linux TRACE Labs VM Paladin, GRML are distro which are best run as a live session whereas Renmux, Tsuguri is best run as an installed OS. CAINE and DEFT Zero are fine in either way. Please note that all of these OS have built-in write blocking protection for any storage media plugged on the computer. Windows Here is a list of distros based on Windows to meet forensic needs. Windows OS for forensic and reverse engineering purposes Name Description OS Link FLARE VM Reverse engineering distributions for windows malware analysis Based on Microsoft Windows FLARE VM Personally, I have this setup : My setup A raspberry PI 3 with a modified kernel to clone hard drive for forensic purposes A laptop with the following virtual machines a VM with Parrot OS (Linux) installed for pentest and forensic purposes a VM with Flare VM (Windows) for the reverse engineering of windows malwares a VM with Flare VM (Windows) for forensic purposes a VM with Remnux install for the reverse engineering of linux malwares a VM with a distro from Trace Labs VM for OSINT purposes. Please keep in mind that the best setup you can have is the one which suit you the best. Don't hesitate to experiment several distros to see the ones you like the most. Setting your workstation from scratch Step N\u00b0 1 : Choose the right distro The first step is to choose the right linux distro. The key here is to choose a Linux OS you're comfortable with. If you have no idea of which one to use, you can try Debian, Ubuntu or Slackware Step N\u00b0 2 : Install the distro Step N\u00b0 3 : Configuring your workstation To avoid unwanted actions on digital evidence such as storage media, we want to make sure that any storage media plugged to our workstation will be marked as \"Read-only\". Even though a storage media can have the flag \"Read-only\", it will be still possible for the linux kernel to do write I/O on the storage media. To avoid this issue, you have two ways : Buy/Install a hardware write blocker These device are placed between the workstation and the evidence you want to analyze. Their primary goal is to block any attempt from the workstation to realize write operation on the evidence. The massive cons of this technology is that it can be very expensive to buy one of this devices for the benefits. Buy/Install a software write blocker A software write blocker works in the same fashion as a hardware write blocker except that it is a software which is running on your workstation. It can be a third parties software or a even a patch on the Linux kernel. As long as the software configuration is correctly done, its reliability will be the same as an hardware write blocker. How to patch and recompile our own linux kernel In this section, I'm going to explain how to patch your own kernel to \"truly\" mark a storage-media as \"Read-only\" and avoid unwanted write I/O on digital evidences. The first step you need to do is to open a terminal and type this command : Text Only uname -r Based on the output, please refer to the tailored section to your needs to configure your kernel. Version superior to 3.15.1, 4.14, 5.4 First, you need to install the following packages : Debian, Ubuntu Text Only sudo apt-get update && sudo apt-get upgrade && sudo apt-get install Once it's done, go to /usr/src to find the kernel source. You will need to find the kernel version you want to install. Consult this link to download the right kernel https://kernel.org/pub/linux/kernel/ Then, download the kernel file on your PC : Text Only wget https://link/to/kernel/file.com #Download the kernel wget https://link/to/kernel/signature.com #Download the kernel signature Uncompress the archive and check the signature Text Only tar -xvzf archive.tar.gz | gpg --verify linux-5.10.62.tar.sign - #If archive is a tar.gz file unxz -c linux-5.10.62.tar.xz | gpg --verify linux-5.10.62.tar.sign - #If archive is a tar.xz file Once you have the archive, launch the following command Text Only cp /boot/config-5.10.0-8-amd64 ~/kernel/linux-source-5.10/.config #Keep the new configuration as close as possible to the previous kernel version Before we go compile the kernel, we need to several files to activate the write blocking ability of the kernel. Text Only any_text_editor_software ~/kernel/config-version/block/blk-core.c Go to the line N\u00b0 708 or to the function bio_check_ro(struct bio *bio, struct hd_struct *part) and change this line : Text Only return false to Text Only return true Once it's done, you can save and close the file. Now that we have patched the source code of the downloaded kernel, we can begin to compile the kernel. Please consult the \"Credits\" section if you want to have additionnal informations regarding this patch from Maxim Suhanov. Step N\u00b0 4 : Install the needed packages Now that we have the right foundation to create our forensic workstation, we need to downloads the software which will be needed for forensic purposes. Step N\u00b0 5 : Post-installation If you have successfully accomplished all the previous steps, then congralutations ! Enjoy your tuned workstation and don't forget to create a snapshot if it is a virtual machine. This will allow you to go back to a functionnal version of your VM in case you have broken it. Credits Original linux kernel patch for software write blocker : Link N\u00b0 1 Forked linux kernel patch for software write blocker : Link N\u00b0 2","title":"Workstation setup"},{"location":"Environment%20setup/Workstation%20setup/#workstation-setup","text":"This page aims to give instructions to help you setup a forensic workstation. Regarding the configuration of your forensic workstation, you have two choices. The first one is using an existant distro tuned from Vanilla Debian, Ubuntu OS or create your own distro from scratch. Please consult the right section based on your needs.","title":"Workstation setup"},{"location":"Environment%20setup/Workstation%20setup/#using-an-existant-distro","text":"Using an existant distro can be very useful if you want to setup a forensic workstation as a VM. You can find on the following table, the existing distro for the forensic world.","title":"Using an existant distro"},{"location":"Environment%20setup/Workstation%20setup/#linux","text":"Here is a list of distros based on Linux to meet forensic needs. Linux OS for forensic and reverse engineering purposes Name Description OS Link Tsuguri Forensic distro which includes popular forensic and OSINT tools. Best run as an installed OS Based on Ubuntu Tsuguri-linux PALADIN Forensic distro which aims to provide tools for disk imaging and data viewer. Best run as a live session. Based on Ubuntu Sumuri CAINE Forensic distro which aims to provide basic forensic tools like Autopsy, testdisk, phororec... Both ways are fine with this OS. Based on Ubuntu CAINE GRML Forensic distro which aims to provide basic forensic tools for disk imaging. Best run as a live session Based on Grml Linux live which is itself based on Debian GRML Forensic Renmux Linux distro dedicated to reverse-engineering. Best run as an installed OS. Base on Ubuntu Renmux Challenger OS Data recovery distro which aims to provide rescue tools to save data from disk. Best run as an installed OS. Based on slackware ChallengerOS DEFT Zero Forensic distro which aims to provide basic forensic tools like Autopsy, testdisk, photorec... Both ways are fine with this OS REDACTED Discontinued Trace Labs VM Kali Linux OS tuned to suit OSINT purposes Based on Kali Linux TRACE Labs VM Paladin, GRML are distro which are best run as a live session whereas Renmux, Tsuguri is best run as an installed OS. CAINE and DEFT Zero are fine in either way. Please note that all of these OS have built-in write blocking protection for any storage media plugged on the computer.","title":"Linux"},{"location":"Environment%20setup/Workstation%20setup/#windows","text":"Here is a list of distros based on Windows to meet forensic needs. Windows OS for forensic and reverse engineering purposes Name Description OS Link FLARE VM Reverse engineering distributions for windows malware analysis Based on Microsoft Windows FLARE VM Personally, I have this setup : My setup A raspberry PI 3 with a modified kernel to clone hard drive for forensic purposes A laptop with the following virtual machines a VM with Parrot OS (Linux) installed for pentest and forensic purposes a VM with Flare VM (Windows) for the reverse engineering of windows malwares a VM with Flare VM (Windows) for forensic purposes a VM with Remnux install for the reverse engineering of linux malwares a VM with a distro from Trace Labs VM for OSINT purposes. Please keep in mind that the best setup you can have is the one which suit you the best. Don't hesitate to experiment several distros to see the ones you like the most.","title":"Windows"},{"location":"Environment%20setup/Workstation%20setup/#setting-your-workstation-from-scratch","text":"","title":"Setting your workstation from scratch"},{"location":"Environment%20setup/Workstation%20setup/#step-n-1-choose-the-right-distro","text":"The first step is to choose the right linux distro. The key here is to choose a Linux OS you're comfortable with. If you have no idea of which one to use, you can try Debian, Ubuntu or Slackware","title":"Step N\u00b0 1 : Choose the right distro"},{"location":"Environment%20setup/Workstation%20setup/#step-n-2-install-the-distro","text":"","title":"Step N\u00b0 2 : Install the distro"},{"location":"Environment%20setup/Workstation%20setup/#step-n-3-configuring-your-workstation","text":"To avoid unwanted actions on digital evidence such as storage media, we want to make sure that any storage media plugged to our workstation will be marked as \"Read-only\". Even though a storage media can have the flag \"Read-only\", it will be still possible for the linux kernel to do write I/O on the storage media. To avoid this issue, you have two ways :","title":"Step N\u00b0 3 : Configuring your workstation"},{"location":"Environment%20setup/Workstation%20setup/#buyinstall-a-hardware-write-blocker","text":"These device are placed between the workstation and the evidence you want to analyze. Their primary goal is to block any attempt from the workstation to realize write operation on the evidence. The massive cons of this technology is that it can be very expensive to buy one of this devices for the benefits.","title":"Buy/Install a hardware write blocker"},{"location":"Environment%20setup/Workstation%20setup/#buyinstall-a-software-write-blocker","text":"A software write blocker works in the same fashion as a hardware write blocker except that it is a software which is running on your workstation. It can be a third parties software or a even a patch on the Linux kernel. As long as the software configuration is correctly done, its reliability will be the same as an hardware write blocker.","title":"Buy/Install a software write blocker"},{"location":"Environment%20setup/Workstation%20setup/#how-to-patch-and-recompile-our-own-linux-kernel","text":"In this section, I'm going to explain how to patch your own kernel to \"truly\" mark a storage-media as \"Read-only\" and avoid unwanted write I/O on digital evidences. The first step you need to do is to open a terminal and type this command : Text Only uname -r Based on the output, please refer to the tailored section to your needs to configure your kernel.","title":"How to patch and recompile our own linux kernel"},{"location":"Environment%20setup/Workstation%20setup/#version-superior-to-3151-414-54","text":"First, you need to install the following packages :","title":"Version superior to 3.15.1, 4.14, 5.4"},{"location":"Environment%20setup/Workstation%20setup/#debian-ubuntu","text":"Text Only sudo apt-get update && sudo apt-get upgrade && sudo apt-get install Once it's done, go to /usr/src to find the kernel source. You will need to find the kernel version you want to install. Consult this link to download the right kernel https://kernel.org/pub/linux/kernel/ Then, download the kernel file on your PC : Text Only wget https://link/to/kernel/file.com #Download the kernel wget https://link/to/kernel/signature.com #Download the kernel signature Uncompress the archive and check the signature Text Only tar -xvzf archive.tar.gz | gpg --verify linux-5.10.62.tar.sign - #If archive is a tar.gz file unxz -c linux-5.10.62.tar.xz | gpg --verify linux-5.10.62.tar.sign - #If archive is a tar.xz file Once you have the archive, launch the following command Text Only cp /boot/config-5.10.0-8-amd64 ~/kernel/linux-source-5.10/.config #Keep the new configuration as close as possible to the previous kernel version Before we go compile the kernel, we need to several files to activate the write blocking ability of the kernel. Text Only any_text_editor_software ~/kernel/config-version/block/blk-core.c Go to the line N\u00b0 708 or to the function bio_check_ro(struct bio *bio, struct hd_struct *part) and change this line : Text Only return false to Text Only return true Once it's done, you can save and close the file. Now that we have patched the source code of the downloaded kernel, we can begin to compile the kernel. Please consult the \"Credits\" section if you want to have additionnal informations regarding this patch from Maxim Suhanov.","title":"Debian, Ubuntu"},{"location":"Environment%20setup/Workstation%20setup/#step-n-4-install-the-needed-packages","text":"Now that we have the right foundation to create our forensic workstation, we need to downloads the software which will be needed for forensic purposes.","title":"Step N\u00b0 4 : Install the needed packages"},{"location":"Environment%20setup/Workstation%20setup/#step-n-5-post-installation","text":"If you have successfully accomplished all the previous steps, then congralutations ! Enjoy your tuned workstation and don't forget to create a snapshot if it is a virtual machine. This will allow you to go back to a functionnal version of your VM in case you have broken it.","title":"Step N\u00b0 5 : Post-installation"},{"location":"Environment%20setup/Workstation%20setup/#credits","text":"Original linux kernel patch for software write blocker : Link N\u00b0 1 Forked linux kernel patch for software write blocker : Link N\u00b0 2","title":"Credits"}]}